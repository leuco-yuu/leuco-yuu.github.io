+++
title= "【Kali Toolkit】Nmap（Network Mapper）"
date= "2025-12-30T16:27:59+08:00"
lastmod= "2025-12-30T16:27:59+08:00"
draft=false
author= "leuco"
description= "【1】Namp是Kali Linux中最强大的网络探测和安全审计工具之一。待续"
keywords= ["Kali", "Nmap", "TCP", "Namp"]
categories= ["网络空间安全", "工具集", "Kali Toolkit"]
tags= ["Kali", "Nmap", "TCP", "Namp"]
math=true

+++

# Nmap：网络扫描工具

## 主机发现

### `-sn`

- **功能**：探测主机是否在线，不扫描端口
- **示例**：`nmap -sn 192.168.1.0/24`

### `-Pn`

- **功能**：跳过主机发现，将所有主机视为在线状态
- **示例**：`nmap -Pn 192.168.1.100`

## 端口扫描

### `-sS`

- **功能**：TCP SYN半开扫描，相对隐蔽
- **示例**：`nmap -Pn 192.168.1.100`

### `-sT`

- **功能**：TCP全开扫描，建立完整的TCP链接，更容易被发现
- **示例**：`nmap -sT -p- 192.168.1.100`

### `-sU`

- **功能**：UDP端口扫描
- **示例**：`nmap -sU 192.168.1.100`

### `-p`

- **功能**：指定端口号
- **示例**：`nmap -p 1-80 192.168.1.100`、`nmap -p 80,443 192.168.1.100`

### `-p-`

- **功能**：扫描所有端口
- **示例**：`nmap -p- 192.168.1.100`

### `--top-ports`

- **功能**：扫描最常用的前指定数量的端口
- **示例**：`nmap --top-ports 100 192.168.1.100`

### `-F`

- **功能**：快速扫描，减少扫描的端口数量
- **示例**：`nmap -F 192.168.1.100`

## 服务/版本探测

### `-sV`

- **功能**：识别服务类型（HTTP、FTP等）和服务版本号，获取详细服务信息
- **示例**：`nmap -sV 192.168.1.100`

### `--version-intensity`

- **功能**：指定版本探测强度（0-9）
- **示例**：`nmap -sV --version-intensity 9 192.168.1.100`

## 操作系统探测

### `-O`

- **功能**：探测目标主机的操作系统类型
- **示例**：`nmap -O 192.168.1.100`

## NSE脚本引擎

### `-sC` /`--script=default`

- **功能**：使用默认脚本进行扫描
- **示例**：`nmap -sC 192.168.1.100`

### `-script=<Lua scripts>`

- **功能**：<Lua scripts>使用某个或某类脚本进行扫描，支持通配符描述
- **示例**：`nmap -script=vuln 192.168.1.100`
- **脚本分类**：
  - **auth**: 负责处理鉴权证书（绕开鉴权）的脚本
  - **broadcast**: 在局域网内探查更多服务开启状况，如dhcp/dns/sqlserver等服务
  - **brute**: 提供暴力破解方式，针对常见的应用如http/snmp等 
  - **default**: 使用-sC或-A选项扫描时候默认的脚本，提供基本脚本扫描能力 
  - **discovery**: 对网络进行更多的信息，如SMB枚举、SNMP查询等 
  - **dos**: 用于进行拒绝服务攻击 
  - **exploit**: 利用已知的漏洞入侵系统 
  - **external**: 利用第三方的数据库或资源，例如进行whois解析 
  - **fuzzer**: 模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞  
  - **intrusive**: 入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽 
  - **malware**: 探测目标机是否感染了病毒、开启了后门等信息 
  - **safe**: 此类与intrusive相反，属于安全性脚本 
  - **version**: 负责增强服务与版本扫描（Version Detection）功能的脚本 
  - **vuln**: 负责检查目标机是否有常见的漏洞（Vulnerability），如是否有MS08_067 

### `-script-args=<n1=v1,[n2=v2,...]>`

- **功能**：为脚本提供默认参数，使用指定类别或脚本进行扫描

### `–script-args-file=filename`

- **功能**：使用文件来为脚本提供参数

### `–script-trace`

- **功能**：显示脚本执行过程中发送与接收的数据
- **示例**：`nmap -O -script-trace 192.168.1.100`

### `–script-updatedb`

- **功能**：更新脚本数据库（root）
- **示例**：`nmap –script-updatedb`

### `–script-help=<scripts>`

- **功能**：显示脚本的帮助信息，其中<scripts>部分可以逗号分隔的文件或脚本类别
- **示例**：`nmap -script-help=voln`

## 输出选项

### `-oN`

- **功能**：输出至普通文本文件
- **示例**：`nmap -oN result.txt 192.168.1.100`

### `-oX`

- **功能**：输出至XML文件，便于工具处理
- **示例**：`nmap -oX result.xml 192.168.1.100`

### `-oA`

- **功能**：一次性输出所有主要格式
- **示例**：`nmap -oA result 192.168.1.100`

## 性能与防火墙规避

### `-T<0-5>`

- **功能**：时序模板，数字越大越快,也越易被发现
- **示例**：`nmap -T4 192.168.1.100`

### `-f`

- **功能**：使用小数据包分片
- **示例**：`nmap -f 192.168.1.100`

### `-D`

- **功能**：使用诱饵IP进行隐藏
- **示例**：`nmap -D RND:10 192.168.1.100`
