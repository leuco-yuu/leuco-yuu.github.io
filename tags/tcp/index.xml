<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>TCP on Lecuo's Blog</title><link>http://localhost:1313/tags/tcp/</link><description>Recent content in TCP on Lecuo's Blog</description><generator>Hugo -- gohugo.io</generator><language>zh_CN</language><copyright>Leuco(leucoyuu@163.com)</copyright><lastBuildDate>Tue, 30 Dec 2025 16:27:59 +0800</lastBuildDate><atom:link href="http://localhost:1313/tags/tcp/index.xml" rel="self" type="application/rss+xml"/><item><title>【Kali Toolkit】Nmap（Network Mapper）</title><link>http://localhost:1313/p/kali-toolkitnmapnetwork-mapper/</link><pubDate>Tue, 30 Dec 2025 16:27:59 +0800</pubDate><guid>http://localhost:1313/p/kali-toolkitnmapnetwork-mapper/</guid><description>&lt;h1 id="nmap网络扫描工具"&gt;Nmap：网络扫描工具
&lt;/h1&gt;&lt;h2 id="主机发现"&gt;主机发现
&lt;/h2&gt;&lt;h3 id="-sn"&gt;&lt;code&gt;-sn&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：探测主机是否在线，不扫描端口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sn 192.168.1.0/24&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-pn"&gt;&lt;code&gt;-Pn&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：跳过主机发现，将所有主机视为在线状态&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -Pn 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="端口扫描"&gt;端口扫描
&lt;/h2&gt;&lt;h3 id="-ss"&gt;&lt;code&gt;-sS&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：TCP SYN半开扫描，相对隐蔽&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -Pn 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-st"&gt;&lt;code&gt;-sT&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：TCP全开扫描，建立完整的TCP链接，更容易被发现&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sT -p- 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-su"&gt;&lt;code&gt;-sU&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：UDP端口扫描&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sU 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-p"&gt;&lt;code&gt;-p&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定端口号&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -p 1-80 192.168.1.100&lt;/code&gt;、&lt;code&gt;nmap -p 80,443 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-p-"&gt;&lt;code&gt;-p-&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：扫描所有端口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -p- 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--top-ports"&gt;&lt;code&gt;--top-ports&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：扫描最常用的前指定数量的端口&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap --top-ports 100 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-f"&gt;&lt;code&gt;-F&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：快速扫描，减少扫描的端口数量&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -F 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="服务版本探测"&gt;服务/版本探测
&lt;/h2&gt;&lt;h3 id="-sv"&gt;&lt;code&gt;-sV&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：识别服务类型（HTTP、FTP等）和服务版本号，获取详细服务信息&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sV 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="--version-intensity"&gt;&lt;code&gt;--version-intensity&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：指定版本探测强度（0-9）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sV --version-intensity 9 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="操作系统探测"&gt;操作系统探测
&lt;/h2&gt;&lt;h3 id="-o"&gt;&lt;code&gt;-O&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：探测目标主机的操作系统类型&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -O 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="nse脚本引擎"&gt;NSE脚本引擎
&lt;/h2&gt;&lt;h3 id="-sc---scriptdefault"&gt;&lt;code&gt;-sC&lt;/code&gt; /&lt;code&gt;--script=default&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用默认脚本进行扫描&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -sC 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-scriptlua-scripts"&gt;&lt;code&gt;-script=&amp;lt;Lua scripts&amp;gt;&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：&lt;Lua scripts&gt;使用某个或某类脚本进行扫描，支持通配符描述&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -script=vuln 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;脚本分类&lt;/strong&gt;：
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;auth&lt;/strong&gt;: 负责处理鉴权证书（绕开鉴权）的脚本&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;broadcast&lt;/strong&gt;: 在局域网内探查更多服务开启状况，如dhcp/dns/sqlserver等服务&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;brute&lt;/strong&gt;: 提供暴力破解方式，针对常见的应用如http/snmp等&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;default&lt;/strong&gt;: 使用-sC或-A选项扫描时候默认的脚本，提供基本脚本扫描能力&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;discovery&lt;/strong&gt;: 对网络进行更多的信息，如SMB枚举、SNMP查询等&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;dos&lt;/strong&gt;: 用于进行拒绝服务攻击&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;exploit&lt;/strong&gt;: 利用已知的漏洞入侵系统&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;external&lt;/strong&gt;: 利用第三方的数据库或资源，例如进行whois解析&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;fuzzer&lt;/strong&gt;: 模糊测试的脚本，发送异常的包到目标机，探测出潜在漏洞&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;intrusive&lt;/strong&gt;: 入侵性的脚本，此类脚本可能引发对方的IDS/IPS的记录或屏蔽&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;malware&lt;/strong&gt;: 探测目标机是否感染了病毒、开启了后门等信息&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;safe&lt;/strong&gt;: 此类与intrusive相反，属于安全性脚本&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;version&lt;/strong&gt;: 负责增强服务与版本扫描（Version Detection）功能的脚本&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;vuln&lt;/strong&gt;: 负责检查目标机是否有常见的漏洞（Vulnerability），如是否有MS08_067&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-script-argsn1v1n2v2"&gt;&lt;code&gt;-script-args=&amp;lt;n1=v1,[n2=v2,...]&amp;gt;&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：为脚本提供默认参数，使用指定类别或脚本进行扫描&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="script-args-filefilename"&gt;&lt;code&gt;–script-args-file=filename&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用文件来为脚本提供参数&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="script-trace"&gt;&lt;code&gt;–script-trace&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：显示脚本执行过程中发送与接收的数据&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -O -script-trace 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="script-updatedb"&gt;&lt;code&gt;–script-updatedb&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：更新脚本数据库（root）&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap –script-updatedb&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="script-helpscripts"&gt;&lt;code&gt;–script-help=&amp;lt;scripts&amp;gt;&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：显示脚本的帮助信息，其中&lt;scripts&gt;部分可以逗号分隔的文件或脚本类别&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -script-help=voln&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="输出选项"&gt;输出选项
&lt;/h2&gt;&lt;h3 id="-on"&gt;&lt;code&gt;-oN&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：输出至普通文本文件&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -oN result.txt 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-ox"&gt;&lt;code&gt;-oX&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：输出至XML文件，便于工具处理&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -oX result.xml 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-oa"&gt;&lt;code&gt;-oA&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：一次性输出所有主要格式&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -oA result 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="性能与防火墙规避"&gt;性能与防火墙规避
&lt;/h2&gt;&lt;h3 id="-t0-5"&gt;&lt;code&gt;-T&amp;lt;0-5&amp;gt;&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：时序模板，数字越大越快,也越易被发现&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -T4 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-f-1"&gt;&lt;code&gt;-f&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用小数据包分片&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -f 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="-d"&gt;&lt;code&gt;-D&lt;/code&gt;
&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;功能&lt;/strong&gt;：使用诱饵IP进行隐藏&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;示例&lt;/strong&gt;：&lt;code&gt;nmap -D RND:10 192.168.1.100&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;</description></item></channel></rss>